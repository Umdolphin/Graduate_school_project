<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="202140191 엄태훈" />


<title>통계방법론1 실습코드 정리</title>

<script src="202140191_엄태훈_기말고사-CSS포함-_files/header-attrs-2.7/header-attrs.js"></script>
<script src="202140191_엄태훈_기말고사-CSS포함-_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="202140191_엄태훈_기말고사-CSS포함-_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="202140191_엄태훈_기말고사-CSS포함-_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="202140191_엄태훈_기말고사-CSS포함-_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="202140191_엄태훈_기말고사-CSS포함-_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="202140191_엄태훈_기말고사-CSS포함-_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="202140191_엄태훈_기말고사-CSS포함-_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="202140191_엄태훈_기말고사-CSS포함-_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="202140191_엄태훈_기말고사-CSS포함-_files/navigation-1.1/tabsets.js"></script>
<script src="202140191_엄태훈_기말고사-CSS포함-_files/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">통계방법론1 실습코드 정리</h1>
<h4 class="author">202140191 엄태훈</h4>
<h4 class="date">2021-06-12(SAT)</h4>

</div>


<body style="background-color:#FFFFE6">
<style type="text/css">
  body{
     font-size: 16px;
     font-family: 맑은 고딕
  }
  td{
     font-size: 16px;
     font-family: 맑은 고딕
  }
  code.r{
    font-size: 16px;
    font-weight: bold;
    font-family: 맑은 고딕
  }
  pre {
    font-size: 14px
    font-family: 맑은 고딕
  }
  h1,h2,h3,h4,h5,h6{
    font-family: 맑은 고딕;
  }
  h1{
    font-size: 22pt;
  }
  h2{
    font-size: 20pt;
  }
  h3{
    font-size: 18pt;
  }
</style>
<p><br></p>
<p>본 Markdwon은 가천대학교 일반대학원 응용통계학과 고승곤 교수님의 통계방법론1 수업(2021.03.06 ~ 2021.06.05)내용을 정리한 것이다.</p>
<p>설명하고자 하는 내뇽과 본 Markdown의 목차는 다음과 같다.</p>
<table>
<colgroup>
<col width="26%" />
<col width="31%" />
<col width="41%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">챕터</th>
<th align="right">제목</th>
<th align="right">수업날짜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chapter2</td>
<td align="right">Data and Statistics</td>
<td align="right">2021.03.13</td>
</tr>
<tr class="even">
<td align="left">Chapter3</td>
<td align="right">Statistics Concepts</td>
<td align="right">2021.03.13</td>
</tr>
<tr class="odd">
<td align="left">Chapter4</td>
<td align="right">Graphs</td>
<td align="right">2021.03.20</td>
</tr>
<tr class="even">
<td align="left">Chapter5</td>
<td align="right">Introductory Inference</td>
<td align="right">2021.03.27~2021.04.03</td>
</tr>
<tr class="odd">
<td align="left">Chapter15</td>
<td align="right">Bivariate Statistics—Discrete Data</td>
<td align="right">2021.04.10</td>
</tr>
<tr class="even">
<td align="left">Chapter6</td>
<td align="right">One-Way Analysis of Variance</td>
<td align="right">2021.04.17</td>
</tr>
<tr class="odd">
<td align="left">Chapter7</td>
<td align="right">Multiple Comparisons</td>
<td align="right">2021.05.01</td>
</tr>
<tr class="even">
<td align="left">Chapter12</td>
<td align="right">Two-Way Analysis of Variance</td>
<td align="right">2021.05.08</td>
</tr>
<tr class="odd">
<td align="left">Chapter13</td>
<td align="right">Design of Experiments - Factorial Desings</td>
<td align="right">2021.05.15</td>
</tr>
<tr class="even">
<td align="left">Chapter8</td>
<td align="right">Linear Regression by Least Squares</td>
<td align="right">2021.05.22</td>
</tr>
<tr class="odd">
<td align="left">Chapter9</td>
<td align="right">Multiple Regression - More than One Predictor</td>
<td align="right">2021.05.22</td>
</tr>
<tr class="even">
<td align="left">Chapter10</td>
<td align="right">Multiple Regression - Dummy Variables,Contrasts,and Analysis of Covariacne</td>
<td align="right">2021.06.05</td>
</tr>
</tbody>
</table>
<hr />
<div id="chap2-data-and-statistics" class="section level1">
<h1>Chap2 Data and Statistics</h1>
<p>통계의 역사는 꽤나 오래된 역사를 가지고 있지만, 본격적으로 통계학이라는 분야가 생겨난 것은 약 100~200년이라고 할 수 있다.<br />
과거에 통계학 분야는 따로 하나의 분야로 분류되지 않고, 통계는 대부분 수학의 일종으로 생각되었다.</p>
<p>이러한 통계학은 현대사회에서 가장 핫한 주제 중 하나인 빅데이터와 연관되어 중요한 학문 중 하나로 활발히 연구되고 있다.</p>
<p>한 정의에 따르면, 통계는 데이터로부터 결론을 모으고 분석하고 그리기 위한 기술이라고 설명되고 있다.</p>
<p>통계 연구는 실험, 설문조사, 과거부터 쌓여온 데이터들 등의 관측치들을 모으고 요약하는 데에 크게 관련이 있다. 이러한 요약을 통해서 조사자는 폭넓은 타당성을 가지는 결과를 그릴 수 있다.</p>
<div id="types-of-data" class="section level2">
<h2>2.1 Types of Data</h2>
<ul>
<li><p>Count data: 관측치가 음이 아닌 정수 값만 취할 수 있는 데이터이다. 예를 들어, 동전 던지기에서 앞면의 개수 = {0,1,2,3…} 같은 데이터를 말한다.</p></li>
<li><p>Categorical data: 각각의 데이터가 뚜렷하여 범주로 나눌 수 있는 데이터이다.<br />
명목형 변수, 클래스 변수, 팩터라고도 불리며, 다양한 범주 또는 범주형 변수의 클래스를 수준이라고 부른다.<br />
Ex) 사람의 성별, 혈액형</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>bloodtype <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(bloodtype)</span></code></pre></div>
<pre><code>##   bloodtype
## 1         A
## 2         B
## 3        AB
## 4         O
## 5        AB
## 6         B</code></pre>
<ul>
<li>Ordered data: 데이터를 순위, 순서로 나열할 수 있는 데이터를 말한다.<br />
Ex) 대학교의 학점, 올림픽 순위</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>country <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;KOREA&quot;</span>,<span class="st">&quot;USA&quot;</span>,<span class="st">&quot;UK&quot;</span>,<span class="st">&quot;RUSSIA&quot;</span>,<span class="st">&quot;JAPAN&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>rank <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(country,rank)</span></code></pre></div>
<pre><code>##   country rank
## 1   KOREA    1
## 2     USA    3
## 3      UK    5
## 4  RUSSIA    4
## 5   JAPAN    2</code></pre>
<ul>
<li>Interval Data: 데이터의 값이 그들 사이에 구간으로 나타낼 수 있지만 비율 관계는 없는 데이터를 말한다.<br />
EX) 온도</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">36.0</span>,<span class="fl">18.0</span>,<span class="fl">36.0</span>,<span class="fl">28.0</span>,<span class="fl">43.0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(temp)</span></code></pre></div>
<pre><code>##   temp
## 1   36
## 2   18
## 3   36
## 4   28
## 5   43</code></pre>
<ul>
<li>Ratio Data: 절대적 기준인 0이 존재하고 숫자 간의 비율이 산술적 의미를 가지는 데이터를 말한다.<br />
EX) 키, 몸무게</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Name <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;JAMES&quot;</span>,<span class="st">&quot;ALICE&quot;</span>,<span class="st">&quot;JOHN&quot;</span>,<span class="st">&quot;JANE&quot;</span>,<span class="st">&quot;ANNA&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Height <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">175</span>,<span class="dv">160</span>,<span class="dv">183</span>,<span class="dv">165</span>,<span class="dv">185</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Weight <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">67</span>,<span class="dv">45</span>,<span class="dv">70</span>,<span class="dv">50</span>,<span class="dv">74</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(Name,Height,Weight)</span></code></pre></div>
<pre><code>##    Name Height Weight
## 1 JAMES    175     67
## 2 ALICE    160     45
## 3  JOHN    183     70
## 4  JANE    165     50
## 5  ANNA    185     74</code></pre>
</div>
<div id="r-프로그램에서-데이터-사용하기" class="section level2">
<h2>2.2 R 프로그램에서 데이터 사용하기</h2>
<p>R에서는 기본적으로 프로그램들 안에 내장돼 있는 데이터들이 있다. 이러한 데이터들은 특정 패키지를 불러오지 않고도 사용할 수 있거나, 특정 패키지를 불러와야 사용가능하다.</p>
<p>기본적으로 R에 내장돼 있는 데이터들은 <code>data(데이터명)</code>을 입력하고 <em>데이터명</em>을 입력하면 불러올 수 있다.</p>
</div>
<div id="특정-패키지-없이-데이터-불러오기" class="section level2">
<h2>2.3 특정 패키지 없이 데이터 불러오기</h2>
<p><em>iris</em> 데이터는 특정 패키지를 불러오지 않아도 기본적으로 사용 가능한 꽃의 정보에 대한 데이터이다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1           5.1         3.5          1.4         0.2  setosa
## 2           4.9         3.0          1.4         0.2  setosa
## 3           4.7         3.2          1.3         0.2  setosa
## 4           4.6         3.1          1.5         0.2  setosa
## 5           5.0         3.6          1.4         0.2  setosa
## 6           5.4         3.9          1.7         0.4  setosa
## 7           4.6         3.4          1.4         0.3  setosa
## 8           5.0         3.4          1.5         0.2  setosa
## 9           4.4         2.9          1.4         0.2  setosa
## 10          4.9         3.1          1.5         0.1  setosa</code></pre>
</div>
<div id="특정-패키지의-데이터-불러오기" class="section level2">
<h2>2.4 특정 패키지의 데이터 불러오기</h2>
<p>특정 패키지의 데이터를 불러오고자 하는 경우, 먼저 패키지를 설치하고 로드하는 과정을 거쳐야한다.<br />
<code>install.packages("패키지명")</code>을 통해 패키지를 설치한다.<br />
! 이때, 반드시 <em>“패키지명”</em>으로 해야한다. 패키지명에 ""을 붙이지 않으면 패키지 이름을 글자로 인식을 못하기 때문이다.</p>
<p>패키지 설치를 완료하면, <code>library(패키지명)</code>을 통해 앞에서 설치한 패키지를 로드한다.<br />
-&gt; <em>library</em>의 경우 “패키지명”, 패키지명 두 방법 모두 인식한다.</p>
<p>R에서 HH패키지에 들어있는 crime데이터를 불러와보자.<br />
HH패키지의 crime데이터는 음주자와 비음주자의 범죄 빈도를 비교한 데이터이다.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;HH&quot;)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span></code></pre></div>
<pre><code>## Warning: package &#39;HH&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: latticeExtra</code></pre>
<pre><code>## Warning: package &#39;latticeExtra&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: multcomp</code></pre>
<pre><code>## Warning: package &#39;multcomp&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## Warning: package &#39;TH.data&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<pre><code>## Loading required package: gridExtra</code></pre>
<pre><code>## Warning: package &#39;gridExtra&#39; was built under R version 4.0.4</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crime)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>crime</span></code></pre></div>
<pre><code>##           perpetrator
## crime      drinker abstainer
##   arson         50        43
##   rape          88        62
##   violence     155       110
##   stealing     379       300
##   coining       18        14
##   fraud         63       144</code></pre>
</div>
<div id="reshape2-패키지의-활용" class="section level2">
<h2>2.5 reshape2 패키지의 활용</h2>
<p>분석을 진행함에 있어 가장 시간을 많이 할애해야 하는 부분이면서 어려운 부분 중 하나가 바로 데이터를 전처리하는 것이다.<br />
데이터 전처리는 분석 프로젝트의 80%를 차지할 정도로 매우 중요한 부분이다.<br />
<em>데이터 전처리(Preprocessing)</em>은 데이터를 모델이 이해할 수 있는 형태로 변환 즉, 특정 분석에 적합하게 데이터를 가공하는 작업이다.<br />
대부분의 데이터셋은 생각하는 것만큼 분석을 하기에 편리하게 정렬되어 있지않기 때문에, 이러한 데이터 전처리 과정은 필수적 확인사항이다.</p>
<p>R에서는 다양한 데이터 전처리 패키지를 제공하는데 그 중에서, <code>dplyr</code>, <code>reshpae2</code>패키지가 상당히 좋은 성능을 가지고 있다.</p>
<p><code>reshpae2</code>패키지는 데이터의 모양을 변환 할 때 유용하다.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape2 패키지를 설치하고 로드한다.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;reshape2&quot;)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Names=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">y=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>wide</span></code></pre></div>
<pre><code>##   Names x  y
## 1     A 1  6
## 2     B 2  7
## 3     C 3  8
## 4     D 4  9
## 5     E 5 10</code></pre>
<p><em>reshape2</em> 패키지에서는 <code>melt</code>와 <code>dcast</code>함수가 가장 많이 쓰인다.</p>
<p><code>melt</code>함수는 여러개의 칼럼을 한 컬럼에 세로로 정리할 때 사용된다.<br />
특정 변수를 식별자로 설정하고 나머지 변수들을 측정값의 칼럼으로 바꿀 수 있다.</p>
<p>melt(데이터,id.vars,measure.vars)<br />
- <em>데이터</em>: melt에 적용할 데이터를 넣는다.<br />
- <em>id.vars</em>: 식별 칼럼명을 넣는다. 즉, 여러개의 칼럼이 하나로 만들어 질때 빼고싶은 칼럼명을 넣는다.<br />
- <em>measure.vars</em>: 하나의 칼럼으로 만들 여러개의 칼럼을 넣는다. id.vars에 칼럼을 지정해주면, measure.vars를 지정하지 않아도 자동으로 남은 칼럼은 measure.vars에 들어가게 된다.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> <span class="fu">melt</span>(wide,<span class="at">id.vars=</span><span class="st">&quot;Names&quot;</span>) </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>long </span></code></pre></div>
<pre><code>##    Names variable value
## 1      A        x     1
## 2      B        x     2
## 3      C        x     3
## 4      D        x     4
## 5      E        x     5
## 6      A        y     6
## 7      B        y     7
## 8      C        y     8
## 9      D        y     9
## 10     E        y    10</code></pre>
<p><code>id.vars = "Names"</code>로 지정하여 Names를 식별자로 하고 나머지 <em>x</em>,<em>y</em>칼럼을 variable이라는 한 칼럼으로 정리를 하였다.<br />
<code>id.vars</code>를 입력하였기 때문에, <code>measure.vars</code>에 자동으로 <em>x</em>,<em>y</em>칼럼이 들어간것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(wide,<span class="at">id.vars=</span><span class="fu">c</span>(<span class="st">&quot;Names&quot;</span>,<span class="st">&quot;x&quot;</span>))</span></code></pre></div>
<pre><code>##   Names x variable value
## 1     A 1        y     6
## 2     B 2        y     7
## 3     C 3        y     8
## 4     D 4        y     9
## 5     E 5        y    10</code></pre>
<p>식별자를 2개로 설정하는 경우, c()를 이용하여 넣어줘어야 한다.<br />
식별자가 <em>Names</em>,<em>x</em> 두 개로 설정되어 <em>y</em> 칼럼에 대해서만 측정값을 나눈 것을 확인할 수 있다.</p>
<hr />
<p><code>melt</code>함수가 여러개의 칼럼을 하나의 칼럼으로 좁게 변환했다면, <code>dcast</code>함수는 하나의 칼럼을 여러개의 칼럼으로 넓게 변환할 수 있다.</p>
<p>dcast(데이터,Formula,value) - <em>데이터</em>: dcast 함수를 적용할 데이터를 넣는다.<br />
- <em>Formula</em>: <em>식별 칼럼명 ~ 하나로 뭉친 칼럼명</em>의 형태로 넣는다.<br />
- <em>value:</em> 데이터의 값을 가지고있는 칼럼을 넣는다.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>wideagain <span class="ot">&lt;-</span> <span class="fu">dcast</span>(<span class="at">data=</span>long,Names<span class="sc">~</span>variable,<span class="at">value=</span><span class="st">&quot;value&quot;</span>) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>wideagain</span></code></pre></div>
<pre><code>##   Names x  y
## 1     A 1  6
## 2     B 2  7
## 3     C 3  8
## 4     D 4  9
## 5     E 5 10</code></pre>
<p><code>dcast</code>함수를 통해 <em>Names</em> 변수를 식별자로 고정하고 <em>variable</em>변수를 여러개의 칼럼으로 구분되게 Formula를 설정하였다.<br />
데이터의 값을 가지고 있는 <em>value</em>를 value로 설정한 것을 확인할 수 있다.<br />
<code>melt</code>함수를 통해 하나의 칼럼으로 변환했던 데이터가 <code>dcast</code>함수를 통해 여러개의 칼럼으로 구분된 것을 확인할 수 있다.</p>
</div>
<div id="dplyr-패키지의-활용" class="section level2">
<h2>2.6 dplyr 패키지의 활용</h2>
<p><code>dplyr</code>패키지의 경우 데이터 전처리와 조작에서 최고의 성능을 가진다고 해도 과언이 아니다.<br />
많은 R 코드를 살펴보면 <em>%&gt;%</em>라는 표시를 심심치 않게 볼 수 있는데, 이는 dplyr 패키지에서 사용되는 것이다.<br />
%&gt;%를 통해 스텝을 정리해주기 때문에, 가독성 또한 높아지는 것을 확인할 수 있다.<br />
dplyr 패키지를 사용하기 위해서는 보통 원하는 데이터를 입력한 후, %&gt;%(파이프라인)을 해주고 전처리 작업을 진행한다.</p>
<p><code>dplyr</code>의 <em>select</em> 함수를 이용하면 데이터에서 원하는 칼럼만을 추출하여 가져올 수 있다.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:gridExtra&#39;:
## 
##     combine</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     select</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Width,Sepal.Length)</span></code></pre></div>
<pre><code>##     Sepal.Width Sepal.Length
## 1           3.5          5.1
## 2           3.0          4.9
## 3           3.2          4.7
## 4           3.1          4.6
## 5           3.6          5.0
## 6           3.9          5.4
## 7           3.4          4.6
## 8           3.4          5.0
## 9           2.9          4.4
## 10          3.1          4.9
## 11          3.7          5.4
## 12          3.4          4.8
## 13          3.0          4.8
## 14          3.0          4.3
## 15          4.0          5.8
## 16          4.4          5.7
## 17          3.9          5.4
## 18          3.5          5.1
## 19          3.8          5.7
## 20          3.8          5.1
## 21          3.4          5.4
## 22          3.7          5.1
## 23          3.6          4.6
## 24          3.3          5.1
## 25          3.4          4.8
## 26          3.0          5.0
## 27          3.4          5.0
## 28          3.5          5.2
## 29          3.4          5.2
## 30          3.2          4.7
## 31          3.1          4.8
## 32          3.4          5.4
## 33          4.1          5.2
## 34          4.2          5.5
## 35          3.1          4.9
## 36          3.2          5.0
## 37          3.5          5.5
## 38          3.6          4.9
## 39          3.0          4.4
## 40          3.4          5.1
## 41          3.5          5.0
## 42          2.3          4.5
## 43          3.2          4.4
## 44          3.5          5.0
## 45          3.8          5.1
## 46          3.0          4.8
## 47          3.8          5.1
## 48          3.2          4.6
## 49          3.7          5.3
## 50          3.3          5.0
## 51          3.2          7.0
## 52          3.2          6.4
## 53          3.1          6.9
## 54          2.3          5.5
## 55          2.8          6.5
## 56          2.8          5.7
## 57          3.3          6.3
## 58          2.4          4.9
## 59          2.9          6.6
## 60          2.7          5.2
## 61          2.0          5.0
## 62          3.0          5.9
## 63          2.2          6.0
## 64          2.9          6.1
## 65          2.9          5.6
## 66          3.1          6.7
## 67          3.0          5.6
## 68          2.7          5.8
## 69          2.2          6.2
## 70          2.5          5.6
## 71          3.2          5.9
## 72          2.8          6.1
## 73          2.5          6.3
## 74          2.8          6.1
## 75          2.9          6.4
## 76          3.0          6.6
## 77          2.8          6.8
## 78          3.0          6.7
## 79          2.9          6.0
## 80          2.6          5.7
## 81          2.4          5.5
## 82          2.4          5.5
## 83          2.7          5.8
## 84          2.7          6.0
## 85          3.0          5.4
## 86          3.4          6.0
## 87          3.1          6.7
## 88          2.3          6.3
## 89          3.0          5.6
## 90          2.5          5.5
## 91          2.6          5.5
## 92          3.0          6.1
## 93          2.6          5.8
## 94          2.3          5.0
## 95          2.7          5.6
## 96          3.0          5.7
## 97          2.9          5.7
## 98          2.9          6.2
## 99          2.5          5.1
## 100         2.8          5.7
## 101         3.3          6.3
## 102         2.7          5.8
## 103         3.0          7.1
## 104         2.9          6.3
## 105         3.0          6.5
## 106         3.0          7.6
## 107         2.5          4.9
## 108         2.9          7.3
## 109         2.5          6.7
## 110         3.6          7.2
## 111         3.2          6.5
## 112         2.7          6.4
## 113         3.0          6.8
## 114         2.5          5.7
## 115         2.8          5.8
## 116         3.2          6.4
## 117         3.0          6.5
## 118         3.8          7.7
## 119         2.6          7.7
## 120         2.2          6.0
## 121         3.2          6.9
## 122         2.8          5.6
## 123         2.8          7.7
## 124         2.7          6.3
## 125         3.3          6.7
## 126         3.2          7.2
## 127         2.8          6.2
## 128         3.0          6.1
## 129         2.8          6.4
## 130         3.0          7.2
## 131         2.8          7.4
## 132         3.8          7.9
## 133         2.8          6.4
## 134         2.8          6.3
## 135         2.6          6.1
## 136         3.0          7.7
## 137         3.4          6.3
## 138         3.1          6.4
## 139         3.0          6.0
## 140         3.1          6.9
## 141         3.1          6.7
## 142         3.1          6.9
## 143         2.7          5.8
## 144         3.2          6.8
## 145         3.3          6.7
## 146         3.0          6.7
## 147         2.5          6.3
## 148         3.0          6.5
## 149         3.4          6.2
## 150         3.0          5.9</code></pre>
<p><code>dplyr</code>의 <em>filter</em>함수를 이용하면 조건에 맞는 행만을 추출하여 가져올 수 있다.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sepal.Width <span class="sc">&gt;</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1           5.1         3.5          1.4         0.2     setosa
## 2           4.7         3.2          1.3         0.2     setosa
## 3           4.6         3.1          1.5         0.2     setosa
## 4           5.0         3.6          1.4         0.2     setosa
## 5           5.4         3.9          1.7         0.4     setosa
## 6           4.6         3.4          1.4         0.3     setosa
## 7           5.0         3.4          1.5         0.2     setosa
## 8           4.9         3.1          1.5         0.1     setosa
## 9           5.4         3.7          1.5         0.2     setosa
## 10          4.8         3.4          1.6         0.2     setosa
## 11          5.8         4.0          1.2         0.2     setosa
## 12          5.7         4.4          1.5         0.4     setosa
## 13          5.4         3.9          1.3         0.4     setosa
## 14          5.1         3.5          1.4         0.3     setosa
## 15          5.7         3.8          1.7         0.3     setosa
## 16          5.1         3.8          1.5         0.3     setosa
## 17          5.4         3.4          1.7         0.2     setosa
## 18          5.1         3.7          1.5         0.4     setosa
## 19          4.6         3.6          1.0         0.2     setosa
## 20          5.1         3.3          1.7         0.5     setosa
## 21          4.8         3.4          1.9         0.2     setosa
## 22          5.0         3.4          1.6         0.4     setosa
## 23          5.2         3.5          1.5         0.2     setosa
## 24          5.2         3.4          1.4         0.2     setosa
## 25          4.7         3.2          1.6         0.2     setosa
## 26          4.8         3.1          1.6         0.2     setosa
## 27          5.4         3.4          1.5         0.4     setosa
## 28          5.2         4.1          1.5         0.1     setosa
## 29          5.5         4.2          1.4         0.2     setosa
## 30          4.9         3.1          1.5         0.2     setosa
## 31          5.0         3.2          1.2         0.2     setosa
## 32          5.5         3.5          1.3         0.2     setosa
## 33          4.9         3.6          1.4         0.1     setosa
## 34          5.1         3.4          1.5         0.2     setosa
## 35          5.0         3.5          1.3         0.3     setosa
## 36          4.4         3.2          1.3         0.2     setosa
## 37          5.0         3.5          1.6         0.6     setosa
## 38          5.1         3.8          1.9         0.4     setosa
## 39          5.1         3.8          1.6         0.2     setosa
## 40          4.6         3.2          1.4         0.2     setosa
## 41          5.3         3.7          1.5         0.2     setosa
## 42          5.0         3.3          1.4         0.2     setosa
## 43          7.0         3.2          4.7         1.4 versicolor
## 44          6.4         3.2          4.5         1.5 versicolor
## 45          6.9         3.1          4.9         1.5 versicolor
## 46          6.3         3.3          4.7         1.6 versicolor
## 47          6.7         3.1          4.4         1.4 versicolor
## 48          5.9         3.2          4.8         1.8 versicolor
## 49          6.0         3.4          4.5         1.6 versicolor
## 50          6.7         3.1          4.7         1.5 versicolor
## 51          6.3         3.3          6.0         2.5  virginica
## 52          7.2         3.6          6.1         2.5  virginica
## 53          6.5         3.2          5.1         2.0  virginica
## 54          6.4         3.2          5.3         2.3  virginica
## 55          7.7         3.8          6.7         2.2  virginica
## 56          6.9         3.2          5.7         2.3  virginica
## 57          6.7         3.3          5.7         2.1  virginica
## 58          7.2         3.2          6.0         1.8  virginica
## 59          7.9         3.8          6.4         2.0  virginica
## 60          6.3         3.4          5.6         2.4  virginica
## 61          6.4         3.1          5.5         1.8  virginica
## 62          6.9         3.1          5.4         2.1  virginica
## 63          6.7         3.1          5.6         2.4  virginica
## 64          6.9         3.1          5.1         2.3  virginica
## 65          6.8         3.2          5.9         2.3  virginica
## 66          6.7         3.3          5.7         2.5  virginica
## 67          6.2         3.4          5.4         2.3  virginica</code></pre>
<p><code>dplyr</code>의 <em>group_by</em>함수는 원하는 그룹 변수에 따라 계산을 할 수 있게 해준다.<br />
그룹으로 묶은 후, <em>summarise</em> 함수를 통해, 그룹에 따른 원하는 통계량을 계산할 수 있다.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Width</span></code></pre></div>
<pre><code>##   [1] 3.5 3.0 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 3.7 3.4 3.0 3.0 4.0 4.4 3.9 3.5
##  [19] 3.8 3.8 3.4 3.7 3.6 3.3 3.4 3.0 3.4 3.5 3.4 3.2 3.1 3.4 4.1 4.2 3.1 3.2
##  [37] 3.5 3.6 3.0 3.4 3.5 2.3 3.2 3.5 3.8 3.0 3.8 3.2 3.7 3.3 3.2 3.2 3.1 2.3
##  [55] 2.8 2.8 3.3 2.4 2.9 2.7 2.0 3.0 2.2 2.9 2.9 3.1 3.0 2.7 2.2 2.5 3.2 2.8
##  [73] 2.5 2.8 2.9 3.0 2.8 3.0 2.9 2.6 2.4 2.4 2.7 2.7 3.0 3.4 3.1 2.3 3.0 2.5
##  [91] 2.6 3.0 2.6 2.3 2.7 3.0 2.9 2.9 2.5 2.8 3.3 2.7 3.0 2.9 3.0 3.0 2.5 2.9
## [109] 2.5 3.6 3.2 2.7 3.0 2.5 2.8 3.2 3.0 3.8 2.6 2.2 3.2 2.8 2.8 2.7 3.3 3.2
## [127] 2.8 3.0 2.8 3.0 2.8 3.8 2.8 2.8 2.6 3.0 3.4 3.1 3.0 3.1 3.1 3.1 2.7 3.2
## [145] 3.3 3.0 2.5 3.0 3.4 3.0</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sepal_Width_m =</span> <span class="fu">mean</span>(Sepal.Width),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Sepal_Length_m =</span> <span class="fu">mean</span>(Sepal.Length))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   Species    Sepal_Width_m Sepal_Length_m
## * &lt;fct&gt;              &lt;dbl&gt;          &lt;dbl&gt;
## 1 setosa              3.43           5.01
## 2 versicolor          2.77           5.94
## 3 virginica           2.97           6.59</code></pre>
<p><em>group_by</em>를 통해 iris 데어터의 꽃의 종류에 따라 데이터를 묶은 후, <em>summarise</em>를 통해 꽃의 종류별로 평균을 구한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   Species    count
## * &lt;fct&gt;      &lt;int&gt;
## 1 setosa        50
## 2 versicolor    50
## 3 virginica     50</code></pre>
<p><em>summarise(count=n())</em>을 지정해주면 그룹에 따른 빈도 수를 구할 수도 있다.</p>
<hr />
</div>
<div id="결측치의-처리" class="section level2">
<h2>2.7 결측치의 처리</h2>
<p>NA가 하나라도 데이터의 존재하면 수치적인 계산을 진행하지 못한다.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ab <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="cn">NA</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ab)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>이때,<code>na.rm =TRUE</code> 옵션을 통해 결측치를 제거하고 계산을 진행할 수 있다.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ab,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 3.5</code></pre>
<p><code>na.rm = TRUE</code> 옵션을 지정해준 결과, 결측치가 자동으로 제거되고 평균을 구하는 것을 알 수 있다.</p>
<hr />
<p>계산을 진행하기 전, NA값을 제거하고 싶은 경우, <code>na.omit()</code>함수를 이용하여 결측치를 제거할 수 있다.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cd <span class="ot">=</span> <span class="fu">na.omit</span>(ab)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cd</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6
## attr(,&quot;na.action&quot;)
## [1] 7
## attr(,&quot;class&quot;)
## [1] &quot;omit&quot;</code></pre>
<hr />
</div>
<div id="summary-of-chapter2" class="section level2">
<h2>Summary of Chapter2</h2>
<ul>
<li><p>현대는 과거보다 데이터가 셀 수 없이 늘어난 <strong>빅데이터의 시대</strong>라고 불리고 있다. 이러한 시대에서 이론적인 지식도 상당히 중요하게 여겨지고 있지만, 이론적 지식과 얻어진 데이터를 분석하고 정리하는 능력 또한 매우 중요한 능력 중 하나로 여겨진다. 따라서, 이론적인 지식과 <strong>R,Python,SPSS,SAS</strong>등과 같은 통계적인 분석 프로그램의 지식을 쌓는 것도 상당히 중요한 부분을 차지하고 있다.</p></li>
<li><p>일반적으로 통계에서 측정척도는 <strong>명목척도, 서열척도, 구간척도, 비율척도</strong> 4가지로 나뉜다.<br />
-&gt; <strong>명목척도</strong>: 측정대상을 고유한 특성에따라 분류한 것.<br />
-&gt; <strong>서열척도</strong>: 측정대상을 순서 혹은 순위에 따라 분류한 것.<br />
-&gt; <strong>구간척도</strong>: 측정대상이 가지고 있는 간격으로 수치를 부여한 것. 절대0점이 존재하지 않는다.<br />
-&gt; <strong>비율척도</strong>: 측정대상의 비율에 대한 수치를 부여한 것. 절대0점이 존재한다.</p></li>
<li><p>분석을 진행하고자 할때, 우리가 사용할 데이터의 형태가 분석을 진행하기에 적합하지 않은 경우가 종종 발생한다. 이러한 문제를 해결하는 방법이 바로 <strong>데이터 전처리(Preprocessing)</strong>이다. <strong>Preprocessing</strong>은 데이터를 분석에 적용할 수 있게 적합한 형태로 바꾸는 과정을 말한다.</p></li>
<li><p>데이터 전처리 과정은 분석 프로젝트 시간 중, 70~80%의 시간을 소비하는 작업이라고 할 정도로 가장 중요한 작업으로 여겨진다. 전처리를 어떻게 진행하는지에 따라서 분석 결과가 달라질수도 있다.</p></li>
<li><p>데이터 전처리 중 고려해야 하는 요소 중 하나이며, 분석을 방해하는 요소로 <strong>이상치, 결측치</strong>가 있다. <strong>이상치</strong>는 데이터가 있지만 평균값보다 훨씬 높은 값을 가지거나 낮은 값을 가지는 데이터를 말한다. 이상치는 극단적인 값을 갖기 때문에 분석의 결과에 아주 큰 영향을 주기도한다.</p></li>
<li><p><strong>결측치</strong>는 이상치와는 다르게 어떠한 이유로 데이터가 존재하지 않는 값을 말한다. 보통 R 혹은 python 언어에서 결측치가 있는 데이터를 불러올 경우, <strong>NA,NAN</strong>으로 표시된다.</p></li>
<li><p>결측치와 이상치의 경우 일반적으로 제거하는 것이 해결방법으로 여겨진다. 하지만, 데이터가 매우 적은 경우에는 데이터를 함부로 제거해서는 안 된다. 따라서 이러한 경우, 평균값 혹은 적절한 데이터로 대체하는 방법이 있다. R에서는 <code>mice</code>함수를 지원하는데, 이 함수는 시뮬레이션을 통해 결측치에 대해서 적절한 값을 채워 넣어준다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap3-statistics-concepts" class="section level1">
<h1>Chap3 Statistics Concepts</h1>
<p><em>평균(Mean)</em>은 모든 관측값을 더해서 관측값 개수로 나눈 것이다. 특히, 조사자들이 모평균을 추정하고자 할 때 가장 흔하게 사용된다.<br />
즉, 평균은 관심특성의 변수라고 할 수 있다.<br />
표본평균은 다음과 같은 식을 사용하여 구할 수 있다.</p>
<hr />
<p><span class="math display">\[
\overline{x} = \frac {\sum_{i=1}^n x_i}{n}
\]</span></p>
<p><em>분산(Variance)</em>은 편차를 제곱한 후 모두 더해서 전체 자료의 개수로 나눠준 값을 말한다. 즉, 편차의 제곱합의 평균이라고 말할 수 있다.</p>
<p>하지만, 편차의 제곱을 평균한 값이므로 자료의 단위가 제곱으로 바뀌어 기존의 자료와 단위가 달라지는 문제가 있다.<br />
표본분산은 다음과 같은 식을 사용하여 구할 수 있다.</p>
<hr />
<p><span class="math display">\[
s_x^2 = \frac {\sum_{i=1}^n (x_i - \mu)^2}{n-1}
\]</span></p>
<p><em>표준편차(Standard error)</em>는 자료의 산포도를 나타내는 수치로 분산에 제곱근을 취한 값이다. 측정값이 평균으로부터 멀리 떨어져 있을수록 표준편차는 커지게 된다.<br />
분산으로 인해 달라진 단위를 해결하기 위해 등장한 개념이 바로 표준편차이다.</p>
<p>표준편차는 분산에 제곱근을 취하기 때문에 제곱으로 인해 변했던 단위를 원래대로 바꿔준다.<br />
표본 표준편차는 다음과 같은 식을 사용하여 구할 수 있다.</p>
<hr />
<p><span class="math display">\[
s_x = \sqrt\frac {\sum_{i=1}^n (x_i - \mu)^2}{n-1}
\]</span></p>
<p><em>상관계수(Correlation)</em>란 두 변수 x,y 사이에 상관관계 정도를 나타내는 수치이다.<br />
x가 증가할 때, y가 증가하면 양의 상관관계이고 x가 감소할 때 y가 감소하면 음의 상관관계이다.</p>
<p><span class="math display">\[
r = \frac{S_{xy}}{\sqrt {S_{xx}}\sqrt{S_{yy}}}
\]</span></p>
<p>R에서는 <code>cor</code>함수를 통해 상관계수를 구할 수 있다.<br />
<code>corrplot</code>을 통해 상관계수의 그림을 그릴수도 있다.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(iris[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)])</span></code></pre></div>
<pre><code>##              Sepal.Length Sepal.Width Petal.Length Petal.Width
## Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
## Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
## Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
## Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</code></pre>
<p>Seapl.Length와 Petal.Length, Petal.Width는 양의 상관관계를 가지며, Sepal.Length와 Sepal.Width는 음의 상관관계를 가지는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code></pre></div>
<pre><code>## Warning: package &#39;corrplot&#39; was built under R version 4.0.5</code></pre>
<pre><code>## corrplot 0.84 loaded</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(iris[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]),<span class="at">method =</span> <span class="st">&quot;number&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-19-1.png" width="960" /></p>
<hr />
<div id="histogram" class="section level2">
<h2>3.1 Histogram</h2>
<p><em>히스토그램</em>은 도수분포표를 시각적으로 표현한 막대그래프이다.<br />
가로축에는 계급을, 세로축에 도수를 취한다.<br />
각 막대의 높이는 해당 계급에 포함되는 자료의 개수를 의미한다.</p>
<p>R에서는 <code>hist(연속형 데이터)</code>를 통해 히스토그램을 그릴 수 있다.<br />
- <em>xlab</em>: x축의 이름을 설정한다.<br />
- <em>ylab</em>: y축의 이름을 설정한다.<br />
- <em>main</em>: 그래프의 title을 설정한다.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">=</span> <span class="fu">sample</span>(b,<span class="dv">15</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(freq,<span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>,<span class="at">main=</span><span class="st">&quot;Histogram of Age&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-20-1.png" width="960" /></p>
</div>
<div id="boxplots" class="section level2">
<h2>3.2 Boxplots</h2>
<p><code>quantile</code>함수를 이용하면 데이터의 분위수를 확인할 수 있다.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tv)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(tv<span class="sc">$</span>male.life.exp) </span></code></pre></div>
<pre><code>##    0%   25%   50%   75%  100% 
## 50.00 59.75 66.00 69.50 76.00</code></pre>
<p><code>quantile</code>함수를 이용하고 <code>probs</code>옵션을 이용하면 원하는 위치의 사분위수를 확인할 수 있다.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 90% 사분위수를 찾는다.  </span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(tv<span class="sc">$</span>male.life.exp,<span class="at">probs=</span><span class="fl">0.9</span>) </span></code></pre></div>
<pre><code>##  90% 
## 73.1</code></pre>
<p><em>Boxplot</em>은 특정한 수치 값을 기반으로 그려진, 자료 특성이 요약된 그래프이다.<br />
Q1, 중앙값, Q3, 최댓값, 최솟값의 정보를 한 그림 안에 보여준다.<br />
박스안의 가운데 실선은 중앙값을 나타내며, 박스 위의 선과 아래 선은 각각 Q3, Q1을 나타낸다.<br />
위쪽 아래쪽 수염은 각각 최댓값 최솟값을 나타낸다.</p>
<p><code>Boxplot(연속형 데이터)</code>를 이용하여 그릴 수 있다.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-23-1.png" width="960" /></p>
<p><code>horizontal = T</code>옵션을 이용하면 Boxplot을 회전시켜 나타낼 수 있다.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length,<span class="at">horizontal =</span> T) </span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-24-1.png" width="960" /></p>
<p>또한, R에서는 다중 boxplot을 그릴수도 있다. 이러한 경우에는 <code>boxplot(그룹 데이터 ~ 연속형 데이터)</code>의 Formula 형태를 지정해주면 다중 boxplot이 그려진다.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(mtcars<span class="sc">$</span>mpg<span class="sc">~</span>mtcars<span class="sc">$</span>cyl)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-25-1.png" width="960" /></p>
<p>Formula의 형태로 지정해준 결과, cyl의 갯수에 따라서 mpg에 대한 boxplot을 그리는 것을 확인할 수 있다.</p>
<hr />
<p>col옵션을 이용하여 box의 색깔 또한 지정해줄 수 있다.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(mtcars<span class="sc">$</span>mpg<span class="sc">~</span>mtcars<span class="sc">$</span>cyl,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-26-1.png" width="960" /></p>
<hr />
</div>
<div id="the-binomial-distribution" class="section level2">
<h2>3.3 The Binomial Distribution</h2>
<p><em>베르누이</em> 시행은 결과가 두 가지 중 하나로만 나오는 실험이나 시행을 일컫는다.<br />
성공확률이 p인 베르누이 시행을 n번 반복하는 경우, 성공한 횟수를 확률 변수 X라고 해보자.<br />
이 확률변수 X의 확률변수를 모수가 (n,p)인 <em>이항분포</em>라고 한다.</p>
<p><span class="math display">\[
X \sim B(n,p)
\]</span></p>
<p><code>pbinom(size,prob,q)</code> 함수를 이용하면 이항분포의 누적확률 값을 계산할 수 있다.<br />
- <em>size</em>: n의 크기를 나타낸다.<br />
- <em>prob</em>: 성공 확률을 나타낸다.<br />
- <em>q</em>: 구하고 싶은 누적 성공 횟수</p>
<p><code>dbinom(size,prob,x)</code> 함수는 이항분포의 확률값을 계산한다.<br />
- <em>size</em>: n의 크기를 나타낸다.<br />
- <em>prob</em>: 성공 확률을 나타낸다.<br />
- <em>x</em>: 성공 횟수를 나타낸다.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">size=</span><span class="dv">15</span>,<span class="at">prob=</span>.<span class="dv">4</span>,<span class="at">q=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.6098132</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">size=</span><span class="dv">15</span>,<span class="at">prob=</span>.<span class="dv">4</span>,<span class="at">x=</span><span class="dv">6</span>) </span></code></pre></div>
<pre><code>## [1] 0.2065976</code></pre>
</div>
<div id="ntplot" class="section level2">
<h2>3.4 NTplot</h2>
<p><code>NTplot</code>함수는 정규분포 및 t분포에 대한 검정과 신뢰 구간을 나타내는 그림을 그린다.<br />
<code>shiny = TRUE</code>옵션을 지정하면 모델의 파라미터를 변경에 따른 검정과 신뢰구간의 변화를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">shiny=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-28-1.png" width="960" /></p>
<ul>
<li><em>mean0</em>: 모평균의 값을 지정한다.<br />
</li>
<li><em>xbar</em>: 표본평균의 값을 지정한다.<br />
</li>
<li><em>sd</em>: 모표준편차를 설정한다. (표본의 크기를 설정하면 자동으로 표준오차를 구해준다.)<br />
</li>
<li><em>n</em>: 표본의 크기를 설정한다.</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-29-1.png" width="960" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>,<span class="at">n=</span><span class="dv">30</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-30-1.png" width="960" /></p>
</div>
<div id="simple-random-sampling" class="section level2">
<h2>3.5 Simple Random Sampling</h2>
<p>단순 무작위 추출법은 유한모집단에서 n개의 추출단위로 구성된 모든 부분집합들이 표본으로 선택될 확률이 같도록 설계된 표본추출방법이다.<br />
R에서는 <code>sample</code> 함수를 통해 쉽게 단순 무작위 추출법을 진행할 수 있다.</p>
<p><code>sample(데이터, 원하는 표본 수, replace)</code> <code>replace=FALSE</code>를 지정하면 비복원 추출을 진행한다.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(a,<span class="dv">10</span>,<span class="at">replace=</span><span class="cn">FALSE</span>) </span></code></pre></div>
<pre><code>##  [1] 14  7 11  1 16 12 15 13 18  2</code></pre>
<p><code>replace=TRUE</code>를 지정하면 비복원 추출을 진행한다.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(a,<span class="dv">10</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1]  9 19 13 19 15  9 13  9  9 19</code></pre>
</div>
<div id="stratified-random-sampling" class="section level2">
<h2>3.6 Stratified Random Sampling</h2>
<p>모집단을 비슷한 성질을 갖는 2개 이상의 동질적인 층을 구분하고, 각 층으로부터 단순무작위추출방법을 적용하여 표본을 추출하는 방법이다.<br />
단순 무작위 추출법과 달리 층화추출을 위해서는 sampling 패키지를 설치해야 한다.<br />
<code>sampling</code> 패키지의 <code>strata</code> 함수를 통해 층화추출법을 할 수 있다.</p>
<p><code>strata(data,startnames,size,method)</code>의 형태이다.<br />
- <em>data</em>: 표본 추출을 원하는 데이터<br />
- <em>startnames</em>: 표본 추출을 위해 나누고자 하는 층<br />
- <em>size</em>: 각 층에서 뽑을 표본의 수<br />
- <em>method</em>: 층화 추출에 이욜할 방법</p>
<p><em>srswor</em>은 비복원 단순임의추출, <em>srswr</em>은 복원 단순임의 추출, <em>Poisson</em>은 포아송 추출, <em>Systematic</em>은 계통 추출방법을 의미한다.</p>
<p><code>getdata(데이터,strata를 저장한 객체)</code>를 이용하여 데이터 프레임으로부터 그 표본의 데이터를 가져온다.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span></code></pre></div>
<pre><code>## Warning: package &#39;sampling&#39; was built under R version 4.0.4</code></pre>
<pre><code>## 
## Attaching package: &#39;sampling&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:survival&#39;:
## 
##     cluster, strata</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>Sex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;F&quot;</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>Height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">177</span>,<span class="dv">160</span>,<span class="dv">180</span>,<span class="dv">182</span>,<span class="dv">183</span>,<span class="dv">170</span>,<span class="dv">165</span>,<span class="dv">172</span>,<span class="dv">186</span>,<span class="dv">181</span>,<span class="dv">167</span>,<span class="dv">159</span>,<span class="dv">155</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">24</span>,<span class="dv">20</span>,<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">23</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(Age,Height,Sex))</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>strat_sample<span class="ot">&lt;-</span><span class="fu">strata</span>(<span class="at">data=</span>dat,<span class="at">stratanames =</span> <span class="st">&quot;Sex&quot;</span>,<span class="at">size=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>),<span class="at">method=</span><span class="st">&quot;srswor&quot;</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>strat_data <span class="ot">&lt;-</span> <span class="fu">getdata</span>(dat,strat_sample) </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>strat_data</span></code></pre></div>
<pre><code>##   Age Height Sex ID_unit      Prob Stratum
## 1  20    177   M       1 0.4285714       1
## 4  21    182   M       4 0.4285714       1
## 5  22    183   M       5 0.4285714       1
## 6  24    170   F       6 0.5000000       2
## 7  20    165   F       7 0.5000000       2
## 9  24    186   F       9 0.5000000       2</code></pre>
<p>지정해준 옵션에 따라 층화추출이 적절하게 적용된 것을 확인할 수 있다.</p>
<p><em>Prob</em>는 각 층에서 뽑힐 확률을 의미하고 <em>Stratum</em>은 층번호를 의미한다. (여기서 “M”은 1, “F”은 2)</p>
</div>
<div id="cluster-random-sampling" class="section level2">
<h2>3.7 Cluster Random Sampling</h2>
<p>모집단을 조사단위 또는 집계단위를 모은 군집으로 나누고, 이들 군집들 중 일부의 군집을 추출한 후 추출된 군집에서 일부 또는 전부를 표본으로 추출하는 방법이다.<br />
R에서는 집락랜덤추출법에 대한 패키지를 제공하지 않아 간단한 예제를 통해 방법을 코드로 구현해 보았다.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AirPassengers 데이터는 1949~1960년대 까지의 월 별 비행기 탑승객 데이터이다.</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>AirPassengers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">as.numeric</span>(AirPassengers), <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(AirPassengers) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(AirPassengers) <span class="ot">&lt;-</span> <span class="dv">1949</span><span class="sc">:</span><span class="dv">1960</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 데이터를 데이터 프레임 형태로 바꾸어 주었다.</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>df_1950s <span class="ot">&lt;-</span> AirPassengers[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),]</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>df_1955s <span class="ot">&lt;-</span> AirPassengers[<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>),]</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>df_1960s <span class="ot">&lt;-</span> AirPassengers[<span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>),]</span></code></pre></div>
<p>집락추출법은 집단 내에서 이질적이고 집단 간 차이는 동질적이다.<br />
1950년대 초반, 1950년대 중반, 1950년대 후반으로 데이터를 나누어 집단내에 1~3월:봄, 4~6월:여름, 7~9월:가을, 10~12:월:겨울로 들어가게 하였다.</p>
<p>따라서, 집단 내에서는 계절 별로 데이터가 있으므로 이질적이고 다른 집단과는 동질적이다.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 나눠진 군집별로 각 2개의 데이터를 추출하였다.</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>cluster<span class="ot">&lt;-</span><span class="fu">sample</span>(df_1950s,<span class="dv">2</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>cluster1<span class="ot">&lt;-</span><span class="fu">sample</span>(df_1955s,<span class="dv">2</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>cluster2<span class="ot">&lt;-</span><span class="fu">sample</span>(df_1960s,<span class="dv">2</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="systematic-random-sampling" class="section level2">
<h2>3.8 Systematic Random Sampling</h2>
<p>첫 번째 요소는 무작위로 선정하고 목록의 매번 k번째 요소를 표본으로 선정하는 표본추출 방법이다.<br />
계통추출은 <code>doBy</code> 패키지의 <code>sampleBy</code> 함수를 이용한다.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span></code></pre></div>
<pre><code>## Warning: package &#39;doBy&#39; was built under R version 4.0.4</code></pre>
<pre><code>## 
## Attaching package: &#39;doBy&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     order_by</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sampleBy</span>(<span class="at">formula=</span><span class="sc">~</span>Species,<span class="at">frac=</span><span class="fl">0.2</span>,<span class="at">data=</span>iris,<span class="at">systematic =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##               Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## setosa.1               5.1         3.5          1.4         0.2     setosa
## setosa.6               5.4         3.9          1.7         0.4     setosa
## setosa.11              5.4         3.7          1.5         0.2     setosa
## setosa.16              5.7         4.4          1.5         0.4     setosa
## setosa.21              5.4         3.4          1.7         0.2     setosa
## setosa.26              5.0         3.0          1.6         0.2     setosa
## setosa.31              4.8         3.1          1.6         0.2     setosa
## setosa.36              5.0         3.2          1.2         0.2     setosa
## setosa.41              5.0         3.5          1.3         0.3     setosa
## setosa.46              4.8         3.0          1.4         0.3     setosa
## versicolor.51          7.0         3.2          4.7         1.4 versicolor
## versicolor.56          5.7         2.8          4.5         1.3 versicolor
## versicolor.61          5.0         2.0          3.5         1.0 versicolor
## versicolor.66          6.7         3.1          4.4         1.4 versicolor
## versicolor.71          5.9         3.2          4.8         1.8 versicolor
## versicolor.76          6.6         3.0          4.4         1.4 versicolor
## versicolor.81          5.5         2.4          3.8         1.1 versicolor
## versicolor.86          6.0         3.4          4.5         1.6 versicolor
## versicolor.91          5.5         2.6          4.4         1.2 versicolor
## versicolor.96          5.7         3.0          4.2         1.2 versicolor
## virginica.101          6.3         3.3          6.0         2.5  virginica
## virginica.106          7.6         3.0          6.6         2.1  virginica
## virginica.111          6.5         3.2          5.1         2.0  virginica
## virginica.116          6.4         3.2          5.3         2.3  virginica
## virginica.121          6.9         3.2          5.7         2.3  virginica
## virginica.126          7.2         3.2          6.0         1.8  virginica
## virginica.131          7.4         2.8          6.1         1.9  virginica
## virginica.136          7.7         3.0          6.1         2.3  virginica
## virginica.141          6.7         3.1          5.6         2.4  virginica
## virginica.146          6.7         3.0          5.2         2.3  virginica</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># formula를 통해 그룹 데이터를 지정한다.</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># frac을 통해 표본 추출의 비율을 정하고 systematic = TRUE를 통해 계통추출 여부를 결정한다.</span></span></code></pre></div>
</div>
<div id="density-plot" class="section level2">
<h2>3.9 density plot</h2>
<p>밀도함수의 그래프는 갖고 있는 데이터(x,y)를 이용해 plot을 그리면 쉽게 나타낼 수 있다.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-37-1.png" width="960" /></p>
<p>원하는 확률 구간을 색칠하고 싶은 경우 <em>xlim</em>,<em>ylim</em>에 대한 전처리를 진행한다.<br />
그 이후에, <code>polygon</code> 함수를 이용하여 다각형으로 채워 넣으면 된다.<br />
<em>polygon</em>함수의 <em>density</em>옵션은 색칠을 얼마나 진하게 할지의 정도를 나타낸다.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> x[x <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> <span class="dv">1</span>] </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> y[x <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> <span class="dv">1</span>]</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(xlim[<span class="dv">1</span>],xlim,<span class="fu">tail</span>(xlim,<span class="dv">1</span>))</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,ylim,<span class="dv">0</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(xlim,ylim,<span class="at">density=</span><span class="dv">25</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-38-1.png" width="960" /></p>
<p>이산형 확률변수의 density plot은 다음과 같이 그릴 수 있다.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>binom <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,<span class="at">size=</span><span class="dv">8</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(binom) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(binom,<span class="at">ylab=</span><span class="st">&quot;Probability&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;확률변수 X&quot;</span>,<span class="at">main=</span><span class="st">&quot;Binomial Dist density plot&quot;</span>,<span class="at">col=</span><span class="st">&quot;#FFA7A7&quot;</span>)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(binom)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-39-1.png" width="960" /></p>
<hr />
<p>이항분포에서 n의 크기가 커짐에 따라 어떻게 모양이 변하는지 살펴보자.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">20</span>,<span class="fl">0.2</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">30</span>,<span class="fl">0.2</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">40</span>,<span class="fl">0.2</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>b5 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">50</span>,<span class="fl">0.2</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>b6 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">60</span>,<span class="fl">0.2</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&#39;확률변수 X&#39;</span>,<span class="at">ylab=</span><span class="st">&quot;Probability&quot;</span>,<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b2,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b3,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b4,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b5,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">5</span>)</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b6,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">6</span>)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&#39;n=10&#39;</span>,<span class="st">&#39;n=20&#39;</span>,<span class="st">&#39;n=30&#39;</span>,<span class="st">&#39;n=40&#39;</span>,<span class="st">&#39;n=50&#39;</span>,<span class="st">&#39;n=60&#39;</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">pch=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-40-1.png" width="960" /></p>
<p>이항분포의 경우, 반복횟수가 커질수록 정규분포와 같은 종모형에 가까워지는 것을 확인할 수 있다.</p>
<hr />
</div>
<div id="summary-of-chapter3" class="section level2">
<h2>Summary of Chapter3</h2>
<ul>
<li><p>우리가 분석을 진행하는 경우, 분석하고자 하는 모든 데이터를 이용할 수는 없다. 따라서 전체 데이터 중, 대표성을 가지는 일부 데이터만 추출하여 분석을 진행하는 경우가 많다. 이렇게 전체 모집단으로 부터 추출한 임의의 데이터를 <strong>샘플</strong>이라고 한다.</p></li>
<li><p><strong>샘플</strong>의 경우 모집단의 데이터를 대표할 수 있는 데이터로 구성이 되어있어야 한다. 따라서, 이러한 샘플을 추출하는 과정이 매우 중요한데, 이러한 과정을 <strong>샘플링</strong>이라고 한다. 대부분 샘플링은 모집단으로 부터 임의로 랜덤하게 추출하는 <strong>단순무작위추출</strong>방법이 가장 많이 쓰인다. 그 외에 <strong>집락추출법</strong>,<strong>계층추출법</strong>,<strong>층화추출법</strong>이 있다.</p></li>
<li><p>데이터로 부터 <strong>샘플</strong>을 얻게 되면 샘플을 통해서 데이터의 특성을 알아보고 모수에 대한 추정이 필요하다. 이때, 많이 쓰이는 통계적 개념들이 바로 <strong>평균, 분산, 표준편차</strong>이다. <strong>평균</strong>은 관심변수의 특성으로 모든 관측값을 관측값의 갯수로 나눈것이며, <strong>분산, 표준편차</strong>는 데이터가 얼마만큼 퍼져있는지에 대한 산포를 나타낸다. <strong>표준편차</strong>는 산포의 단위를 동일하게 만들기 위해 제곱근을 해주는 것이 <strong>분산</strong>과 다른 점이다.</p></li>
<li><p><strong>히스토그램(Histogram)</strong>은 도수의 분포를 그래프로 나타낸 것이다. 보통 가로는 계급, 세로는 도수를 뜻한다. 히스토그램은 도수가 어느 계급값에 집중되어 있는지 확인하는데에 쓰이기도 하지만, 데이터의 정규성을 확인하고자 할 때 쓰이기도한다. 데이터가 정규성을 따르게 되면 종모양을 띄게 되는데, 히스토그램을 통해 이러한 정보를 확인해 볼 수 있다. **</p></li>
<li><p><strong>박스그림(Boxplot)</strong>은 연속형 자료로부터 최소값,Q1,Q2,Q3,최대값의 요약 수치를 표현하는 그래프이다. 또한, 이상치로 판단되는 점들에 대해서 출력해주기 때문에 연속형 데이터를 탐색함에 있어서 상당히 유용한 그래프 중 하나라고 할 수 있다.</p></li>
<li><p><strong>정규분포(Normal distribution)</strong>은 연속 확률 분포 중 하나로, <strong>가우시안 분포</strong>라고도 불리며, 통계학에서 가장 널리쓰이는 연속 확률 분포 중 하나이다. 정규분포는 수집된 자료의 분포를 근사하는데에 자주 사용되는데, 이는 <strong>중심극한정리</strong>에 의하여 표본의 평균은 정규분포에 가까워지는 성질에 의한 것이다. <strong>표준정규분포</strong>는 평균이 0이고 표준편차가 1인 정규분포를 일컫는다.</p></li>
<li><p>데이터의 표본의 수가 커질수록 평균쪽 데이터가 많아지기 때문에 가운데가 큰 종모양이되어 평균을 기준으로 대칭인 모양을 이루게 된다. 이렇게 종모양을 이루게 되면 데이터가 어느정도 한 쪽으로 쏠리지않고 대표성을 띄는 표본임을 알 수 있기 때문에 통계학에서 정규성을 중요하게 여기는 것이라고 할 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap4-graphs" class="section level1">
<h1>Chap4 Graphs</h1>
<p>본격적으로 데이터를 분석하고 모델링을 진행하기에 앞서 데이터의 전처리는 가장 중요한 작업이다.<br />
전처리와 더불어 중요한 작업이 바로 <em>EDA(Exploratory Data Analysis, 탐색적 자료 분석)</em>이다.</p>
<p>복잡한 데이터를 접했을 때 평균, 표준편차, 상관관계 같은 수치적인 값 보다는 항상 시각적인 요소를 통해 데이터를 살펴보는 것이 중요하다.</p>
<p>이번 Chapter4의 내용을 통해 다양한 시각화 기법을 알아보자.</p>
<div id="what-is-a-graph" class="section level2">
<h2>4.1 What Is a Graph?</h2>
<ul>
<li>pch: 포인트의 모양<br />
</li>
<li>col: 색깔 지정<br />
</li>
<li>legend: 범례 지정 (<em>범례로 쓰이는 변수의 범주의 수만큼 색깔, 포인트 모양을 지정해야 한다.</em>)<br />
legend의 경우 x,y축을 통해 위치를 지정할 수도 있지만, <code>bottom</code>,<code>topleft</code>,<code>corner</code>등의 명령어를 사용하여 간편하게 지정할 수도 있다.</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># type=&quot;n&quot;을 지정하면 비어있는 산점도를 그릴 수 있다.</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>mtcars<span class="sc">$</span>mpg,<span class="at">y=</span>mtcars<span class="sc">$</span>qsec,<span class="at">xlab=</span><span class="st">&quot;mpg&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;qsec&quot;</span>,<span class="at">main=</span><span class="st">&quot;Mtcars scatter plots&quot;</span>,<span class="at">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(mtcars<span class="sc">$</span>mpg[mtcars<span class="sc">$</span>mpg<span class="sc">&lt;</span><span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)],mtcars<span class="sc">$</span>qsec[mtcars<span class="sc">$</span>mpg<span class="sc">&lt;</span><span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)],<span class="at">pch=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(mtcars<span class="sc">$</span>mpg[mtcars<span class="sc">$</span>mpg<span class="sc">&gt;=</span><span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)],mtcars<span class="sc">$</span>qsec[mtcars<span class="sc">$</span>mpg<span class="sc">&gt;=</span><span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)],<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Under Avg&quot;</span>,<span class="st">&quot;Up Avg&quot;</span>),<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-41-1.png" width="960" /></p>
</div>
<div id="r의-pch-옵션-종류" class="section level2">
<h2>4.2 R의 pch 옵션 종류</h2>
<p>R은 다양한 pch 옵션을 제공하고 있는데 숫자별 옵션은 다음과 같다.<br />
<img src="https://t1.daumcdn.net/cfile/tistory/992957475DE7778C16" style="width:40.0%" alt="Pch option" /></p>
<p>출처: (<a href="https://rvisuall.tistory.com/18" class="uri">https://rvisuall.tistory.com/18</a>)<br />
makhimh R 시각화 블로그</p>
</div>
<div id="xyplot조건부-산점도-그래프-이용" class="section level2">
<h2>4.3 xyplot(조건부 산점도 그래프) 이용</h2>
<p>위에서는 plot을 이용하여 산점도를 그려보았다.<br />
R에서 제공하는 다양한 시각화 함수 중 xyplot을 이용해 그림을 그려보자.<br />
xyplot은 lattice 패키지의 내장된 함수로 lattice 패키지를 설치해야 사용이 가능하다. <code>install.pacakges("lattice")</code><br />
xyplot은 plot 함수와 다르게 더 많은 옵션을 가지고 있고 조금 더 세심하고 부드럽게 그릴 수 있다.</p>
<ul>
<li>groups: 지정한 변수를 기준으로 그룹을 나눈다.<br />
</li>
<li>auto.key: 범례의 위치를 알맞은 곳에 자동으로 생성한다. <em>(옵션을 TRUE로 지정할 경우)</em></li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice) </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 범례를 지정할 group 변수를 생성한다.</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>lable <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg<span class="sc">&gt;=</span><span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg),<span class="st">&quot;UP Avg&quot;</span>,<span class="st">&quot;Under Avg&quot;</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(mtcars<span class="sc">$</span>qsec<span class="sc">~</span>mtcars<span class="sc">$</span>mpg,<span class="at">main=</span><span class="st">&quot;Mtcars xyplots&quot;</span>,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;mpg&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;qsec&quot;</span>,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>),<span class="at">groups=</span>mtcars<span class="sc">$</span>lable,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-42-1.png" width="960" /></p>
<p>Auto.key를 사용하지 않고 Key를 통해 직접 범례를 만들 수 있다.<br />
<code>key=list((x,y,corner=(...),text=list(...),points=list(pch=...,col=...)))</code></p>
<ul>
<li>(x,y,corner): 범례의 위치를 직접 지정한다.<br />
</li>
<li>text=list(…): 범례에 들어갈 텍스트를 지정한다.<br />
</li>
<li>points: 범례를 표시할 포인트의 종류, 색깔을 지정한다.</li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(mtcars<span class="sc">$</span>qsec<span class="sc">~</span>mtcars<span class="sc">$</span>mpg,<span class="at">main=</span><span class="st">&quot;Mtcars xyplots&quot;</span>,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;mpg&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;qsec&quot;</span>,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>),<span class="at">groups=</span>mtcars<span class="sc">$</span>lable,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">key=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fl">0.95</span>,<span class="at">y=</span><span class="fl">1.05</span>,<span class="at">corner=</span><span class="fu">c</span>(<span class="fl">1.1</span>,<span class="dv">0</span>),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Under Avg&quot;</span>,<span class="st">&quot;Up Avg&quot;</span>)),</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-43-1.png" width="960" /></p>
<p>key를 통해 직접 지정한 위치에 범례가 표시된 것을 확인할 수 있다.</p>
<hr />
</div>
<div id="scatterplot-matrix" class="section level2">
<h2>4.4 Scatterplot Matrix</h2>
<p>xyplot(조건부 산점도 그래프)는 지정한 조건에 따라 plot을 분리하여 그릴 수 있다.<br />
<code>xyplot(formula | condition...)</code>에서 <code>condition</code>부분에 변수를 넣어주면 지정한 변수에 따라 plot을 분리한다.<br />
<code>layout</code>은 subplot들의 행과 열을 지정해준다.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(mtcars<span class="sc">$</span>qsec<span class="sc">~</span>mtcars<span class="sc">$</span>mpg<span class="sc">|</span>mtcars<span class="sc">$</span>cyl,<span class="at">main=</span><span class="st">&quot;Mtcars xyplots&quot;</span>,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;mpg&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;qsec&quot;</span>,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>),<span class="at">groups=</span>mtcars<span class="sc">$</span>lable,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-44-1.png" width="960" /></p>
<div class="line-block">조건부를 이용하여 실린더의 갯수에 따라 그래프를 그려주었다.</div>
<p>맨 왼쪽의 경우가 cyl=4, 가운데 패널이 cyl=6, 오른쪽 패널이 cyl = 8인 경우이다.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># factor 변수의 범주가 문자형인 경우</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(njgolf)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(lotsize<span class="sc">~</span>sprice<span class="sc">|</span>grid<span class="sc">*</span>basemtf,<span class="at">data=</span>njgolf)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-45-1.png" width="960" /></p>
<p>가능한 모든 조건에 대한 plot을 그려준다.</p>
<p>R에서 다차원 데이터의 산점도를 비교하는 경우 Pairs함수를 통해서도 그릴 수 있다.<br />
Pairs 함수는 내장함수이기 때문에 따로 패키지 설치가 필요하지 않다.<br />
아래와 같이 간단한 formula를 적어주면 그릴 수 있다.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="sc">~</span>mpg<span class="sc">+</span>hp<span class="sc">+</span>qsec<span class="sc">+</span>wt<span class="sc">+</span>disp,<span class="at">data=</span>mtcars)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-46-1.png" width="960" /></p>
<p>lattice 패키지의 <code>splom</code>함수를 이용하면 조건부 산점도 행렬 그래프를 그릴 수 있다.<br />
xyplot과 같이 조건에 따라 plot을 분리해주는 역할을 하기도한다.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Width,Sepal.Length,Petal.Length,Petal.Width)</span></code></pre></div>
<p><code>splom</code>의 경우 xyplot 함수와 사용이 거의 비슷하다.<br />
산점도 행렬을 그릴 formula를 지정해주고 그룹, 색깔 등 부가적인 옵션을 지정해주면 된다.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>df,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">6</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>,<span class="st">&quot;#A9D18E&quot;</span>),<span class="at">groups=</span>iris<span class="sc">$</span>Species,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">key=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Scatter plot matirx of iris&quot;</span>,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>)),</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">6</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>,<span class="st">&quot;#A9D18E&quot;</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-48-1.png" width="960" /></p>
<p>pairs 함수에 비해서 축이 더 세밀한 것을 알 수 있고 조금 더 부드럽게 그려지는 것을 확인할 수 있다.</p>
<hr />
</div>
<div id="split을-통한-subplot-그리기" class="section level2">
<h2>4.5 split을 통한 subplot 그리기</h2>
<p><code>gridExtra</code> 패키지를 이용하지 않고 print의 <code>split</code>,<code>more</code>을 통해 여러 개의 plot을 그릴 수 있다.<br />
<code>print(plot을 저장한 객체,split=c(a,b,c,d),more)</code> split을 통해 subplot을 나누고 more을 통해 subplot을 더 그릴 것인지 확인한다.<br />
- a,b: plot을 그릴 행,열을 지정한다.<br />
- c,d: subplot을 그릴 행,열(차원) 생성한다.<br />
more: subplot을 더 그려야하면 TRUE, 마지막 plot이면 FALSE로 지정한다.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tv)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">xyplot</span>(ppl.per.phys<span class="sc">~</span>male.life.exp,<span class="at">data=</span>tv,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;#7685C8&quot;</span>,</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&quot;physician&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Female&quot;</span>,<span class="at">main=</span><span class="st">&quot;# of physician &amp; Female lifespan&quot;</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">xyplot</span>(ppl.per.phys<span class="sc">~</span>fem.life.exp,<span class="at">data=</span>tv,</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">&quot;#F4B183&quot;</span>,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab=</span><span class="st">&quot;physician&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Female&quot;</span>,<span class="at">main=</span><span class="st">&quot;# of physician &amp; male lifespan&quot;</span>)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">more=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-49-1.png" width="960" /></p>
</div>
<div id="data-transformations" class="section level2">
<h2>4.6 Data Transformations</h2>
<p>종종 plot을 그리다 보면 특정 데이터들의 패턴이 비슷하거나 관찰이 어려운 경우가 있다.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> tv <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(life.exp,ppl.per.tv,ppl.per.phys)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>df2,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;#7685C8&quot;</span>,<span class="at">main=</span><span class="st">&quot;Televisions,Physicians,and Life Expectancy&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-50-1.png" width="960" /></p>
<p>tv 데이터의 경우 ppl.per.phys, ppl.per.tv 데이터의 산점도 행렬이 L자 형태로 상당히 비슷하고 패턴 관찰이 어려운 것을 확인할 수 있다.<br />
이러한 경우 log를 취하게 되면 관찰이 어려운 데이터를 조금 더 자세히 볼 수 있고 패턴이 비슷한 데이터 들의 문제를 해결할 수 있다.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span><span class="fu">log</span>(df2),<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;#7685C8&quot;</span>,<span class="at">main=</span><span class="st">&quot;log(Televisions,Physicians,and Life Expectancy)&quot;</span>)  </span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-51-1.png" width="960" /></p>
<p>log를 취하고 그래프를 그린 결과, 기존에 그린 산점도 행렬보다 조금 패턴을 보기 쉽게 변한 것을 확인할 수 있다.</p>
</div>
<div id="life-expectancy-example-continued" class="section level2">
<h2>4.7 Life Expectancy Example-Continued</h2>
<p>lattice 패캐지 안에는 boxplot을 그릴 수 있는 <code>bwplot</code> 함수가 포함돼 있다.<br />
<code>bwplot</code>은 기본 <code>boxplot</code>함수 보다 더 부드러운 <em>boxplot</em>을 그릴 수 있는 장점이 있다.<br />
<code>Formula</code>의 형태로 bwplot을 진행하면 범주형 변수에 따라 데이터를 나눠서 boxplot을 그려준다.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bwplot</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sepal.Length에 대한 boxplot을 출력해준다.</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(iris<span class="sc">$</span>Sepal.Length,<span class="at">xlab =</span> <span class="st">&quot;Sepal.Length&quot;</span> ,<span class="at">main =</span> <span class="st">&quot;Boxplot of iris&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-52-1.png" width="960" /></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(Sepal.Length<span class="sc">~</span>Species,<span class="at">data=</span>iris,<span class="at">main =</span> <span class="st">&quot;Boxplot of iris by using group&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-52-2.png" width="960" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris<span class="sc">$</span>Sepal.Length<span class="sc">&gt;</span><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length),<span class="st">&quot;High&quot;</span>,<span class="st">&quot;LOW&quot;</span>)</span></code></pre></div>
<p>Formula 뒤에 |을 이용하여 조건 변수를 넣어주면 조건 변수에 따라 boxplot을 구분하여 그릴 수 있다.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(Sepal.Length<span class="sc">~</span>Species<span class="sc">|</span>class,<span class="at">data=</span>iris,<span class="at">main =</span> <span class="st">&quot;Boxplot of iris by using condition&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-53-1.png" width="960" /></p>
<p><code>stripplot</code>은 1차원 산점도를 그리는 함수로, sample size가 작을 때 boxplot을 대신하기 좋다.<br />
lattice 패키지는 stripplot 또한 제공하며 함수의 구조는 앞선 xyplot, bwplot과 유사하다.<br />
<code>Formula</code>의 형태로 stripplot을 진행하면 범주형 변수에 따라 데이터를 나눠서 stripplot을 그려준다.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(iris<span class="sc">$</span>Petal.Length,<span class="at">xlab =</span> <span class="st">&quot;Petal.Length&quot;</span>,<span class="at">main =</span> <span class="st">&quot;stripplot of iris&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-54-1.png" width="960" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(Petal.Length<span class="sc">~</span>Species,<span class="at">data=</span>iris,<span class="at">main =</span> <span class="st">&quot;stripplot of iris by using group&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-54-2.png" width="960" /></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>class2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris<span class="sc">$</span>Petal.Length<span class="sc">&gt;</span><span class="fu">mean</span>(iris<span class="sc">$</span>Petal.Length),<span class="st">&quot;High&quot;</span>,<span class="st">&quot;LOW&quot;</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula 뒤에 조건 변수를 넣어주면 조건 변수에 따라 stripplot을 구분하여 그릴 수 있다.</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(Petal.Length<span class="sc">~</span>Species<span class="sc">|</span>class2,<span class="at">data=</span>iris,<span class="at">main =</span> <span class="st">&quot;stripplot of iris by using conditionr&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-54-3.png" width="960" /></p>
</div>
<div id="radar-chart" class="section level2">
<h2>4.8 Radar chart</h2>
<p>다변량 데이터를 사용하는 경우 시각화에 대한 어려움이 존재할 수 있다.<br />
특히, 우리가 배웠던 히스토그램, 산점도, 박스그림으로 나타내는데에는 한계가 존재한다.<br />
<em>Radar Chart</em>는 이러한 다변량 데이터를 효과적으로 시각화할 수 있는 방법 중 하나이다.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span></code></pre></div>
<pre><code>## Warning: package &#39;vcd&#39; was built under R version 4.0.4</code></pre>
<pre><code>## 
## Attaching package: &#39;vcd&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:HH&#39;:
## 
##     odds</code></pre>
<pre><code>## The following object is masked from &#39;package:latticeExtra&#39;:
## 
##     rootogram</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Hitters)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 내야수에 대한 Radar Chart를 그리기 위해 OF와 UT는 제거하였다.  </span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>Rader_dat <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Positions<span class="sc">!=</span><span class="st">&quot;OF&quot;</span> <span class="sc">&amp;</span> Positions<span class="sc">!=</span><span class="st">&quot;UT&quot;</span>)</span></code></pre></div>
<p><em>Radar Chart</em>에서는 데이터의 평균을 통한 그림을 그릴 것이므로 <em>doBy</em>패키지의 <em>summaryBy</em> 함수를 사용한다.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>position_mean <span class="ot">&lt;-</span> <span class="fu">summaryBy</span>(Putouts<span class="sc">+</span>Assists<span class="sc">+</span>Errors<span class="sc">~</span>Positions,<span class="at">data=</span>Rader_dat,<span class="at">FUN=</span><span class="fu">c</span>(mean))</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>position_mean</span></code></pre></div>
<pre><code>##   Positions Putouts.mean Assists.mean Errors.mean
## 1        1B   0.71975286    0.1858316   0.3464506
## 2        2B   0.18493489    0.7394621   0.4326132
## 3        3B   0.06216235    0.4482803   0.5604424
## 4         C   0.39465913    0.1020990   0.2826646
## 5        SS   0.14137337    0.7014459   0.6458333</code></pre>
<p><em>Radar chart</em>를 그리기 위해서는 1번째 행은 열에 대한 최대값, 2번째 행은 열에 대한 최솟값을 놓아야 한다.<br />
따라서, rader_df라는 함수를 통해 조건에 맞는 데이터 변환과정을 진행할 수 있도록 하였다.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)</span></code></pre></div>
<pre><code>## Warning: package &#39;fmsb&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;fmsb&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:vcd&#39;:
## 
##     oddsratio</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>rader_df <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  dfmax <span class="ot">&lt;-</span> <span class="fu">apply</span>(df,<span class="dv">2</span>,max)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  dfmin <span class="ot">&lt;-</span> <span class="fu">apply</span>(df,<span class="dv">2</span>,min)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(dfmax,dfmin,df))</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>Rader_dat <span class="ot">&lt;-</span> <span class="fu">rader_df</span>(position_mean[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)])</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>Rader_dat</span></code></pre></div>
<pre><code>##   Putouts.mean Assists.mean Errors.mean
## 1   0.71975286    0.7394621   0.6458333
## 2   0.06216235    0.1020990   0.2826646
## 3   0.71975286    0.1858316   0.3464506
## 4   0.18493489    0.7394621   0.4326132
## 5   0.06216235    0.4482803   0.5604424
## 6   0.39465913    0.1020990   0.2826646
## 7   0.14137337    0.7014459   0.6458333</code></pre>
<p>원하는대로 데이터 구조가 변환된 것을 확인할 수 있다.</p>
<hr />
<p><code>radarchart(데이터,seg,plty,title)</code>을 통해 radar chart를 그린다.<br />
- <em>데이터</em>: radar chart에 맞게 데이터 구조가 변환된 데이터를 넣어준다.<br />
- <em>seg</em>: 요약된 변수들의 갯수<br />
- <em>plty</em>: 선의 모양 - <em>title</em>: radarchart의 제목</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">radarchart</span>(Rader_dat,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">seg=</span><span class="dv">3</span>,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">plty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">title=</span><span class="fu">c</span>(<span class="st">&quot;Radar chart by Position&quot;</span>))</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend =</span> position_mean<span class="sc">$</span>Positions,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-58-1.png" width="960" /></p>
<p>radarchart를 위와 같이 그릴 수 있다.<br />
변수를 3가지만 요약해서 사용했기 때문에 오각형이 아닌 삼각형의 모양을 띄고있다.<br />
유격수의 경우 수비 부담이 큰 포지션이기 때문에 그에따라 에러의 평균이 높은 것을 살펴볼 수 있다.</p>
<div id="오각형의-radarchart" class="section level3">
<h3>4.8.1 오각형의 radarchart</h3>
<p>다음은, Cars93데이터를 이용해 오각형의 radarchart를 그리는 코드이다.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Cars93)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>Cars93_mean <span class="ot">&lt;-</span> <span class="fu">summaryBy</span>(Min.Price <span class="sc">+</span> Max.Price <span class="sc">+</span> RPM <span class="sc">+</span> Length <span class="sc">+</span> Width <span class="sc">~</span> Type,<span class="at">data=</span>Cars93,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="fu">c</span>(mean))</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>Rader_data_car <span class="ot">&lt;-</span> <span class="fu">rader_df</span>(<span class="fu">scale</span>(Cars93_mean[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)]))</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>Rader_data_car</span></code></pre></div>
<pre><code>##    Min.Price.mean Max.Price.mean   RPM.mean Length.mean Width.mean
## 1       1.1886786     1.34618516  1.1399576  1.53293142  1.3084428
## 2      -1.5767231    -1.67136671 -1.3321490 -1.31904165 -1.3429204
## 11     -0.2958143    -0.22556805  0.4429717 -0.18708691 -0.7913129
## 21      0.9811161     0.58545511 -1.3321490  1.53293142  1.3084428
## 3       1.1886786     1.34618516  0.3757101  0.60272622  0.1596403
## 4      -1.5767231    -1.67136671  1.1399576 -1.31904165 -1.3429204
## 5      -0.0906989    -0.02359726  0.5210954 -0.71088103 -0.2196469
## 6      -0.2065584    -0.01110825 -1.1475858  0.08135194  0.8857970</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">radarchart</span>(Rader_data_car,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">seg=</span><span class="dv">5</span>,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">plty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">title=</span><span class="fu">c</span>(<span class="st">&quot;Radar chart by Type&quot;</span>))</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="at">legend =</span> Cars93_mean<span class="sc">$</span>Type,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-59-1.png" width="960" /></p>
<p>Type이 Large인 경우 차의 폭과 너비의 평균이 제일 높은 것을 알 수 있다.</p>
</div>
</div>
<div id="lollipop-chart" class="section level2">
<h2>4.9 Lollipop chart</h2>
<p>Lollipop chart는 막대 그래프의 변형으로 보다 더 좋은 가독성을 가진다.<br />
막대그래프 대신 막대 사탕의 모양을 가지고 있어서 Lollipop chart라는 이름을 가지고 있다.</p>
<p><em>Lollipop chart</em>는 <code>ggplot2</code>의 <code>geom_segment</code>를 이용하여 그릴 수 있다.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ggplot2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:latticeExtra&#39;:
## 
##     layer</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars,<span class="fu">aes</span>(mpg,<span class="fu">rownames</span>(mtcars),<span class="at">col=</span>am))<span class="sc">+</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(hp,<span class="at">y=</span><span class="fu">rownames</span>(mtcars),<span class="at">xend=</span>mpg,<span class="at">yend=</span><span class="fu">rownames</span>(mtcars)))<span class="sc">+</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Car&quot;</span>)<span class="sc">+</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-60-1.png" width="960" /></p>
<p>위 그림의 point가 찍혀있는 곳은 각 자동차의 mpg 값을 나타낸다.<br />
그룹의 구분은 gear가 수동인지 자동인지에 따라 구분을 진행해주었다.</p>
</div>
<div id="parallel-coordinate-plot" class="section level2">
<h2>4.10 Parallel coordinate plot</h2>
<p>평행좌표그림은 선 그래프 형태로 다변량에 대한 시각화를 진행할 수 있는 그래프이다.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Hitters&quot;</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 내야수에 대한 Radar Chart를 그리기 위해 OF와 UT는 제거하였다.  </span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Hitters<span class="sc">$</span>Positions<span class="sc">!=</span><span class="st">&quot;OF&quot;</span> <span class="sc">&amp;</span> Hitters<span class="sc">$</span>Positions<span class="sc">!=</span><span class="st">&quot;UT&quot;</span>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(dat<span class="sc">$</span>Positions)</span></code></pre></div>
<pre><code>## [1] 1B 2B 3B C  SS
## Levels: 1B 2B 3B C OF SS UT</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Position_Type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>Positions<span class="sc">==</span><span class="st">&quot;1B&quot;</span>,<span class="dv">1</span>,</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(dat<span class="sc">$</span>Positions<span class="sc">==</span><span class="st">&quot;2B&quot;</span>,<span class="dv">2</span>,</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(dat<span class="sc">$</span>Positions<span class="sc">==</span><span class="st">&quot;3B&quot;</span>,<span class="dv">3</span>,</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">ifelse</span>(dat<span class="sc">$</span>Positions<span class="sc">==</span><span class="st">&quot;C&quot;</span>,<span class="dv">4</span>,<span class="dv">5</span>))))</span></code></pre></div>
<p>데이터는 <em>Hitters</em>데이터를 사용하였는데, 포지션별로 선 모양과 선 색깔을 다르게 하기 위해서 전처리를 진행하였다.</p>
<hr />
<p>평행좌표그림은 R의 <em>MASS</em> <code>parcoord</code>함수를 이용하여 그림을 그릴 수 있다.<br />
함수의 입력은 다음과 같다.<br />
<code>parcoord(data,lty,col,var.label,main)</code><br />
- <em>data</em>: 평행좌표그림을 그릴 데이터 - <em>lty</em>: 선의 모양<br />
- <em>col</em>: 선의 색깔<br />
- <em>var.label=TRUE</em>: 각 컬럼의 최댓값 최솟값을 표시한다.<br />
- <em>main</em>: 제목을 설정한다.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parcoord</span>(dat[,<span class="fu">c</span>(<span class="st">&quot;Putouts&quot;</span>,<span class="st">&quot;Assists&quot;</span>,<span class="st">&quot;Errors&quot;</span>)],</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty=</span>dat<span class="sc">$</span>Position_Type,</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>dat<span class="sc">$</span>Position_Type,</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">var.label=</span><span class="cn">TRUE</span>,</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Hitter&#39;s parallel coordinate plot &quot;</span>)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">1.4</span>,<span class="dv">1</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;1B&quot;</span>,<span class="st">&quot;2B&quot;</span>,<span class="st">&quot;3B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;SS&quot;</span>),</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-62-1.png" width="960" /></p>
<p>Hitters데이터의 평행좌표그림을 그린 결과는 위와 같다.<br />
포수와 1루수의 Errors는 낮은 반면, 2루수와 유격수의 Errors는 현저히 높은 것을 볼 수 있다.</p>
<hr />
</div>
<div id="차원-산점도-3-dimensional-scatter-plot" class="section level2">
<h2>4.11 3차원 산점도 (3 dimensional scatter plot)</h2>
<p>3차원 산점도는 2차원에서 차원을 더 넓혀 3차원에 표현할 수 있는 산점도이다.<br />
<code>scatterplot3d</code>패키지의 <code>scatteplot3d</code>함수를 이용하여 시각화를 할 수 있다.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot3d</span>(mtcars<span class="sc">$</span>mpg,mtcars<span class="sc">$</span>hp,mtcars<span class="sc">$</span>qsec,<span class="at">xlab=</span><span class="st">&quot;mpg&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;hp&quot;</span>,<span class="at">zlab=</span><span class="st">&quot;qsec&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-63-1.png" width="960" /></p>
<p>단순히 점이 나열돼있는 것만으로는 시각화가 약간은 부족해 보인다.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot3d</span>(mtcars<span class="sc">$</span>mpg,mtcars<span class="sc">$</span>hp,mtcars<span class="sc">$</span>qsec,<span class="at">type=</span><span class="st">&quot;h&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;mpg&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;hp&quot;</span>,<span class="at">zlab=</span><span class="st">&quot;qsec&quot;</span>,<span class="at">highlight.3d =</span> <span class="cn">TRUE</span>,</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>),<span class="at">main=</span><span class="st">&quot;3D scatterplot of mtcars&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-64-1.png" width="960" /></p>
<p>point만 놓여있는 것에 비해서 조금 더 상대적으로 크기가 잘보이는 것을 확인할 수 있다.</p>
<hr />
</div>
<div id="summary-of-chapter4" class="section level2">
<h2>Summary of Chapter4</h2>
<ul>
<li><p>데이터의 분석과정, 분석결과 등을 단순히 표 혹은 지표로 나타내는 것보다 더욱 효과적인 방법은 시각적인 <strong>그래프</strong>로 표현하여 나타내는 것이다. 도출된 결과들을 아무리 정리한다 한들, 시각적으로 정리된 그래프를 이길 수는 없다. 따라서, 적절한 시각화 방법을 익히고 항상 분석의 결과를 시각적으로 표현할 수 있어야 한다.</p></li>
<li><p><strong>탐색적 자료 분석(Exploratory data analysis)</strong>은 기존의 통계학이 가설 검정같은 정보의 추출 등에 치우쳐 데이터가 가지고 있는 의미를 찾기 어려워 보완하고자 나온 방법이다. 본격적인 분석을 진행하기 전에 데이터들을 시각화하여 데이터가 어떤 특징들을 갖고 있는지 살펴보는 것이다. 대표적인 방법으로는 Boxplot, Histogram 등을 예시로 들 수 있다.</p></li>
<li><p><strong>EDA(탐색적 자료 분석)</strong> 방법이 개발되고 시대가 지날수록 EDA는 선택적이 아니라 필수적인 방법론이 되고 있다. 빅데이터는 수많은 데이터와 변수를 내포하고 있기 때문에 이러한 정보에 대해서 사전에 탐색을 하지 않고 분석을 진행하게 되면 변수 선택에 대한 어려움, 데이터 이해의 부족 등의 문제가 발생하여 적절한 분석결과를 얻지 못할수도 있다. 따라서, 데이터 분석을 시작하기 전에 전처리 과정을 거친 후의 데이터를 가지고 EDA를 진행하여 데이터가 가지고 있는 의미를 파악하고 분석을 진행하는 것이 바람직하다.</p></li>
<li><p>그래프를 그릴 때 주의할 점은 축과 데이터에 대한 이해가 필요하다. 본인이 산점도 같은 그림을 그릴 때, x축에 어떤 변수를 지정할 것이며, y축은 어떤 변수로 지정할 것인지, 축에 적절한 변수와 적절한 범위로 나누어져 있는지에 대한 확인을 꼭 진행해야 한다. 또한, 본인이 그리고자 하는 데이터가 어떠한 특성의 데이터인지 정확이 이해하고 진행해야 한다. 예를 들어, boxplot같은 연속형 자료를 수치적으로 요약해주는 plot을 그릴 때 범주형 데이터를 input값으로 넣게 되면 당연히 오류가 발생할 것이다. 이같은 오류를 사전에 방지하기 위해 항상 그래프를 그리기 전, 꼼곰하게 확인하는 습관이 필요하다.</p></li>
<li><p>R은 통계적인 분석을 시각화 하는데 굉장히 유용한 패키지라고 할 수 있다. 현존하는 다른 컴퓨팅 프로그램과 비교해봤을 때, 분석결과를 적절하게 나타내고 시각적으로도 한 눈에 보이는 그래프를 코드 몇 줄로 그려낼 수 있기 때문이다. 특히, R의 <code>ggplot2</code>패키지는 시각화 패키지 중 손에 꼽을 정도로 쉬운 문법과 수많은 그래프를 그릴 수 있는 패키지이다.</p></li>
<li><p>기본적으로 plot을 그릴 때 필요한 input값은 x변수, y변수, 변수를 내포하고 있는 데이터이다. 추가적으로, plot에 더 많은 정보를 담고 싶다면 group변수, 색상정보, point의 type 등을 고려하여 많은 정보를 가지고 있는 멋진 그래프를 그릴 수 있다. 색상 혹은 point, line의 type같은 정보들은 한 번 정리해놓으면 분석을 진행할 때 마다 편리하게 사용할 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap5-introductory-inference" class="section level1">
<h1>Chap5 Introductory Inference</h1>
<div id="test-of-a-hypothesis-concering-the-mean-of-a-population-having-known-standard-deviation" class="section level2">
<h2>5.1 Test of a Hypothesis Concering the Mean of a Population Having Known Standard Deviation</h2>
<p><code>NTplot</code>을 이용하여 기각역, 신뢰구간 등 가설검정에 대한 다양한 시각화를 진행할 수 있다.<br />
- <em>alpha.right</em>: 우측의 유의수준을 설정한다.<br />
- <em>alpha.left</em>: 좌측의 유의수준을 설정한다.<br />
- alpha.left, alpha.right를 동시에 설정하면 좌측검정, 우측검정의 결과값을 동시에 보여준다.<br />
- <em>distribution.name</em>을 통해 분포의 형태를 지정할 수 있다.(normal, z,t,binomial)<br />
<code>type = "confidence</code>로 지정하게 되면 신뢰구간의 하한 상한을 구할 수 있다.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">alpha.right=</span><span class="fl">0.05</span>,<span class="at">alpha.left=</span><span class="dv">0</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-65-1.png" width="960" /></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="sc">-</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">alpha.left=</span><span class="fl">0.05</span>,<span class="at">alpha.right=</span><span class="dv">0</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-65-2.png" width="960" /></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">alpha.left=</span><span class="fl">0.025</span>,<span class="at">alpha.right=</span><span class="fl">0.025</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-65-3.png" width="960" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,<span class="at">alpha.left=</span><span class="fl">0.05</span>,<span class="at">alpha.right=</span><span class="dv">0</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-65-4.png" width="960" /></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="sc">-</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,<span class="at">alpha.right=</span><span class="fl">0.05</span>,<span class="at">alpha.left=</span><span class="dv">0</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-65-5.png" width="960" /></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,<span class="at">alpha.left=</span><span class="fl">0.025</span>,<span class="at">alpha.right=</span><span class="fl">0.025</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-65-6.png" width="960" /></p>
</div>
<div id="t.test-function" class="section level2">
<h2>5.1.1 t.test function</h2>
<p>R의 <code>t.test</code> 함수를 통해 단일 모집단 평균에 대한 검정을 진행한다.<br />
<code>alternative = greater</code> 혹은 <code>alternative = less</code>를 지정하면 단측검정을 진행한다.</p>
<p><code>alternative =two.sided</code>를 지정하면 양측검정을 진행한다.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;shrimp&quot;</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>shrimp.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(shrimp,<span class="at">mu=</span><span class="dv">30</span>,<span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>shrimp.t</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  shrimp
## t = 4.1299, df = 17, p-value = 0.00035
## alternative hypothesis: true mean is greater than 30
## 95 percent confidence interval:
##  31.03859      Inf
## sample estimates:
## mean of x 
##  31.79444</code></pre>
<p>t-test를 진행하게 되면 집단에 대한 가설검정 결과, 신뢰구간까지 추정을 하여 결과를 도출한다.<br />
t-test 결과 P-value는 0.00035로 유의수준 0.05보다 작으므로 귀무가설을 기각한다.<br />
따라서 모평균은 30보다 크다다는 결과를 도출할 수 있다.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;shrimp&quot;</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>shrimp.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(shrimp,<span class="at">mu=</span><span class="dv">30</span>,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>shrimp.t</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  shrimp
## t = 4.1299, df = 17, p-value = 0.0006999
## alternative hypothesis: true mean is not equal to 30
## 95 percent confidence interval:
##  30.87773 32.71116
## sample estimates:
## mean of x 
##  31.79444</code></pre>
<p>양측검정을 진행한 결과, 역시 P-value가 0.05보다 작으므로 모평균은 30이 아니라는 결과를 도출할 수 있다.</p>
<hr />
<p>NTplot의 <code>distribution.name = "t"</code>로 지정함으로써 정규분포가 아닌 t분포에 대해서도 시각화를 진행할 수 있다.<br />
t분포를 지정했을 경우, df를 통해 자유도 또한 지정해줘야 한다.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">xbar=</span><span class="fl">31.79</span>,<span class="at">sd=</span><span class="fl">1.84</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.right=</span>.<span class="dv">025</span>,<span class="at">alpha.left=</span><span class="fl">0.025</span>,<span class="at">distribution.name=</span><span class="st">&quot;t&quot;</span>,<span class="at">n=</span><span class="dv">18</span>,<span class="at">df=</span><span class="dv">17</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-68-1.png" width="960" /></p>
<p>t.test의 결과를 한 객체에 저장하고 NTplot을 그릴 수 있다.<br />
이는 t.test의 결과를 시각적으로 도출해준다.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(shrimp.t)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-69-1.png" width="960" /></p>
</div>
<div id="chisq-distribution을-기본-plot을-통해-그리기" class="section level2">
<h2>5.2 chisq-distribution을 기본 plot을 통해 그리기</h2>
<p>dchisq를 통해 카이제곱분포의 확률밀도함수를 쉽게 풀 수 있다.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="at">by=</span><span class="fl">0.2</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x,<span class="at">df=</span><span class="dv">3</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y1,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">main=</span><span class="st">&quot;chi-squared-distribution&quot;</span>,<span class="at">xlab=</span><span class="st">&#39;x&#39;</span>,</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&#39;prob&#39;</span>)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y1,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y2,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y3,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y4,<span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&#39;green&#39;</span>,<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;skyblue&#39;</span>),</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;df=1&#39;</span>,<span class="st">&#39;df=3&#39;</span>,<span class="st">&#39;df=5&#39;</span>,<span class="st">&#39;df=10&#39;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-70-1.png" width="960" /></p>
<p>자유도가 커질수록 종 모양에 가까워지는 것을 확인할 수 있다.</p>
</div>
<div id="using-hh-package" class="section level2">
<h2>5.3 Using HH Package</h2>
<p>HH패키지는 chisq, f분포에 대한 시각화 함수 또한 제공한다.<br />
<em>chisq.setup</em>: 자유도에 해당하는 카이제곱 분포의 틀을 잡는다.<br />
<em>chisq.curve</em>: 자유도에 해당하는 카이제곱 분포를 그린다. - <em>col</em>을 통해 색깔을 지정할 수 있다.<br />
- <em>xlim.in</em>을 통해 x의 범위를 지정할 수 있다.<br />
- <em>xlim.in</em>의 qchisq.intermediate를 통해 유의 확률에 따라서 조절할 수도 있다.<br />
- <em>ylim.in</em>을 통해 y의 범위를 지정할 수 있다.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">12</span>,<span class="at">xlim.in=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">12</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="dv">22</span>, <span class="at">df=</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-71-1.png" width="960" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">12</span>,<span class="at">xlim.in=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">qchisq.intermediate</span>(<span class="at">p=</span><span class="dv">1</span><span class="fl">-.025</span>,<span class="at">df=</span><span class="dv">12</span>)),<span class="at">ylim.in=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">12</span>, <span class="at">col=</span><span class="st">&#39;RED&#39;</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="dv">22</span>, <span class="at">df=</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-72-1.png" width="960" /></p>
<p>type=<strong>“confidnce”</strong>을 통해 신뢰구간을 추정할 수 있다.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">12</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">12</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">alpha=</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">025</span>),<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="dv">22</span>, <span class="at">df=</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-73-1.png" width="960" /></p>
<p>F분포는 chisq 분포와 달리 2개의 자유도를 입력해야 한다.<br />
<em>F.setup</em>: 자유도에 해당하는 F 분포의 틀을 잡는다.<br />
<em>F.curve</em>: 자유도에 해당하는 F 분포를 그린다. - <em>col</em>을 통해 색깔을 지정할 수 있다. - <em>xlim.in</em>을 통해 x의 범위를 지정할 수 있다.<br />
- <em>ylim.in</em>을 통해 y의 범위를 지정할 수 있다. - <em>main.in</em>을 통해 title을 설정할 수 있다.<br />
<em>alpha</em>: 설정한 유의수준에 대한 기각역을 보여준다. - 하나의 값을 입력하면 자동으로 우측 검정으로 실행된다.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F.setup</span>(<span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">30</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">F.curve</span>(<span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">30</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">alpha=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">05</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-74-1.png" width="960" /></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F.setup</span>(<span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">30</span>,)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">F.curve</span>(<span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">30</span>, <span class="at">col=</span><span class="st">&#39;Orange&#39;</span>,<span class="at">xlim.in=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="fu">F.observed</span>(<span class="dv">3</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">30</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-75-1.png" width="960" /></p>
</div>
<div id="tests-comparing-two-population-means-when-the-samples-are-independent" class="section level2">
<h2>5.4 Tests Comparing Two Population Means When the Samples Are Independent</h2>
<p>R에 내장돼있는 power.t.test 함수를 통해 one-sample-t, two-sample-t에 대해서 적절한 표본 수를 계산할 수 있다.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="do">## solve using power.t.test</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>PTT <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">delta=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">2</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="fl">0.8</span>, <span class="at">type=</span><span class="st">&quot;one.sample&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;one.sided&quot;</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>PTT</span></code></pre></div>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 26.13751
##           delta = 1
##              sd = 2
##       sig.level = 0.05
##           power = 0.8
##     alternative = one.sided</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(PTT, <span class="at">zaxis=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-76-1.png" width="960" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#NTplot (PTT, zaxis=TRUE, shiny=TRUE)</span></span></code></pre></div>
</div>
<div id="goodness-of-fit" class="section level2">
<h2>5.5 Goodness of Fit</h2>
<p>적합도 검정은 우리가 측정한 데이터셋이 우리가 이론적으로 지정한 특정한 분포를 따르는지 검정하는 방법이다.<br />
적합도 검정의 귀무가설은 아래와 같다.</p>
<p>H0 : the data are from a [specified population]<br />
H1 : the data are from some other population</p>
</div>
<div id="example---test-of-goodness-of-fit-to-a-discrete-uniform-distribution" class="section level2">
<h2>5.6 Example - Test of Goodness-of-Fit to a Discrete Uniform Distribution</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>dice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">6</span>)))</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>dice</span></code></pre></div>
<pre><code>##  [1] 4 6 4 2 6 4 3 4 6 1 2 5 4 6 1 3 4 2 4 3 2 1 3 3 6 6 2 3 2 2 4</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dice)</span></code></pre></div>
<pre><code>## dice
## 1 2 3 4 5 6 
## 3 7 6 8 1 6</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>chi<span class="ot">&lt;-</span><span class="fu">chisq.test</span>(<span class="fu">table</span>(dice))</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>chi</span></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  table(dice)
## X-squared = 6.7419, df = 5, p-value = 0.2406</code></pre>
<p>P-value는 0.2406으로 유의수준 0.05보다 크기 때문에 주어진 귀무가설을 기각하지 못한다.<br />
따라서, 주어진 예제는 Chi-sqaure 분포를 따른다고 할 수 있다.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="fl">6.8</span>,<span class="at">shade =</span> <span class="st">&quot;right&quot;</span>,<span class="at">shaded.area =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-78-1.png" width="960" /></p>
<p>그림을 통해 주어진 결과에 대해서 더 시각적으로 살펴볼 수 있다.</p>
<hr />
</div>
<div id="test-of-goodness-of-fit-to-a-binomial-distribution" class="section level2">
<h2>5.7 Test of Goodness-of-Fit to a Binomial Distribution</h2>
<p>R 의 binom.test 함수를 이용하면 주어진 데이터셋에 대해서 이항분포의 확률이 맞는지 확인할 수 있다.</p>
<p>’125번의 시행중 43번이 나왔을 때 성공확률은 0.45일 것이다’라는 가설검정을 진행해보자.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="dv">43</span>,<span class="dv">125</span>,<span class="at">p=</span><span class="fl">0.45</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  43 and 125
## number of successes = 43, number of trials = 125, p-value = 0.01914
## alternative hypothesis: true probability of success is not equal to 0.45
## 95 percent confidence interval:
##  0.2613610 0.4342206
## sample estimates:
## probability of success 
##                  0.344</code></pre>
<p>P-value = 0.01914로 유의수준 0.05보다 작다. 즉, 성공확률은 0.45가 아니라는 것을 알 수 있다.<br />
가설검정을 진행함과 동시에 성공확률에 대한 신뢰구간까지 제공해준다.<br />
주어진 표본을 통해 성공확률은 0.344일 것이라고 추정을 해준다.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>Observed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">6</span>,<span class="dv">5</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Observed) <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>Observed</span></code></pre></div>
<pre><code>##  0  1  2  3  4  5 
## 13 18 20 18  6  5</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="do">## binomial proportion p-.4 is specified</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>Expected <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">p=</span>.<span class="dv">4</span>)<span class="sc">*</span><span class="dv">80</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Expected) <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(Observed,<span class="at">p=</span>Expected,<span class="at">rescale.p=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in chisq.test(Observed, p = Expected, rescale.p = TRUE): Chi-squared
## approximation may be incorrect</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  Observed
## X-squared = 31.215, df = 5, p-value = 8.496e-06</code></pre>
<p>주어진 관측치와 계산한 기댓값에 대해서 chi-square 분포를 따르는지 검정을 진행한다.<br />
검정을 진행한 결과, P-value가 0.05보다 매우 작으므로 주어진 데이터셋은 chi-square 분포를 따르지 않는다.</p>
</div>
<div id="normal-probability-plots" class="section level2">
<h2>5.8 Normal Probability Plots</h2>
<p><code>qqplot</code>은 분석하는 변수가 정규분포로부터 추출되었는지 확인할 수 있는 방법이다.<br />
분포의 분위수를 이용하여 값을 계산하고 그 값을 plot을 통해 나타낸다.<br />
plot의 패턴이 근사적으로 직선을 따르면 데이터가 정규분포로부터 추출되었다고 할 수 있다.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">400</span>,<span class="dv">1000</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> n){</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(<span class="fu">rnorm</span>(y))</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(<span class="fu">rnorm</span>(y))</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-81-1.png" width="960" /></p>
<p>정규분포를 이용해서 난수를 생성한 결과,<br />
표본의 크기가 커질수록 패턴이 직선에 가까운 형태를 갖는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">400</span>,<span class="dv">1000</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> n){</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(<span class="fu">rexp</span>(y))</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(<span class="fu">rexp</span>(y))</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-82-1.png" width="960" /></p>
<p>지수분포를 이용해서 난수를 생성한 결과,<br />
표본의 크기가 커질수록 직선에 약간 가까워 지지만 정규분포만큼 뚜렷한 직선 패턴을 보이지는 않는다.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">400</span>,<span class="dv">1000</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> n){</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  da <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(y)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(da,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(da))</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-83-1.png" width="960" /></p>
<p>히스토그램을 통해서도 표본이 늘어날수록 정규분포의 종 모양에 가까워지는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">400</span>,<span class="dv">1000</span>)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> n){</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  da <span class="ot">&lt;-</span> <span class="fu">rexp</span>(y)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(da,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(da))</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-84-1.png" width="960" /></p>
<p>지수분포를 이용해 추출한 표본에서는 크기가 늘어나도 정규분포에 가까운 종 모양이 보이지 않는다.<br />
처음에는 확률이 크게 나왔다가 오른쪽으로 갈수록 감소하는 모양, 즉 오른쪽으로 꼬리가 긴 형태인 것을 살펴볼 수 있다.</p>
</div>
<div id="edf-gof-tests" class="section level2">
<h2>5.9 EDF GOF Tests</h2>
<ul>
<li>The Kolmogorov-Smirnov metric(<code>lillie.test</code>)<br />
</li>
<li>The Cramer-von-Mises meric(<code>cvm.test</code>)<br />
</li>
<li>The Anderson-Darling metric(<code>ad.test</code>)</li>
</ul>
<p><code>lillie.test</code>의 경우 <code>nortest</code>라는 패키지를 통해 불러올 수 있다.<br />
<code>cvm.test</code>, <code>ad.test</code>는 <code>nortest</code>, <code>goftest</code> 두 패키지에서 모두 불러올 수 있다.<br />
또한 goftest를 이용해서 cvm.test, ad.test를 진행하여 <code>estimated = TRUE</code>값을 지정할 경우,<br />
파라미터에 대한 추정값과 같이 출력해준다.</p>
<div id="install.pacakges-nortest-goftest" class="section level3">
<h3>5.9.1 install.pacakges <code>nortest</code>, <code>goftest</code></h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;nortest&quot;)</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;goftest&quot;)</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(goftest)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;goftest&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:nortest&#39;:
## 
##     ad.test, cvm.test</code></pre>
</div>
<div id="정규분포에서-랜덤-난수-추출" class="section level3">
<h3>5.9.2 정규분포에서 랜덤 난수 추출</h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">1</span>)</span></code></pre></div>
<p>표본의 크기가 달라질 때, 변하는 정도를 확인하기 위해 3개의 랜덤 정규표본 난수를 생성하였다.</p>
</div>
</div>
<div id="the-kolmogorov-sminov-metric-by-using-nortset-package" class="section level2">
<h2>5.10 The kolmogorov-Sminov metric by using nortset package</h2>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">lillie.test</span>(X1)</span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  X1
## D = 0.17198, p-value = 0.5491</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">lillie.test</span>(X2)</span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  X2
## D = 0.10747, p-value = 0.7883</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">lillie.test</span>(X3)</span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  X3
## D = 0.079722, p-value = 0.8967</code></pre>
<div id="the-cramer-von-mises-meric-by-using-nortest-package" class="section level3">
<h3>5.10.1 The Cramer-von-Mises meric by using nortest package</h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">cvm.test</span>(X1)</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises normality test
## 
## data:  X1
## W = 0.053122, p-value = 0.4301</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">cvm.test</span>(X2)</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises normality test
## 
## data:  X2
## W = 0.038197, p-value = 0.6977</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">cvm.test</span>(X3)</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises normality test
## 
## data:  X3
## W = 0.020221, p-value = 0.9635</code></pre>
</div>
<div id="the-cramer-von-mises-meric-by-using-goftest-package" class="section level3">
<h3>5.10.2 The Cramer-von-Mises meric by using goftest package</h3>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">cvm.test</span>(X1,<span class="st">&quot;pnorm&quot;</span>,<span class="fu">mean</span>(X1),<span class="at">sd=</span><span class="fu">sd</span>(X1))</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises test of goodness-of-fit
##  Null hypothesis: Normal distribution
##  with parameter sd = 0.699893509643704
##  Parameters assumed to be fixed
## 
## data:  X1
## omega2 = 0.053122, p-value = 0.8681</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">cvm.test</span>(X2,<span class="st">&quot;pnorm&quot;</span>,<span class="fu">mean</span>(X2),<span class="at">sd=</span><span class="fu">sd</span>(X2))</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises test of goodness-of-fit
##  Null hypothesis: Normal distribution
##  with parameter sd = 0.947672798832273
##  Parameters assumed to be fixed
## 
## data:  X2
## omega2 = 0.038197, p-value = 0.9464</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">cvm.test</span>(X3,<span class="st">&quot;pnorm&quot;</span>,<span class="fu">mean</span>(X3),<span class="at">sd=</span><span class="fu">sd</span>(X3))</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises test of goodness-of-fit
##  Null hypothesis: Normal distribution
##  with parameter sd = 0.947887463535685
##  Parameters assumed to be fixed
## 
## data:  X3
## omega2 = 0.020221, p-value = 0.9973</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">cvm.test</span>(X3,<span class="st">&quot;pnorm&quot;</span>,<span class="at">mean=</span><span class="fu">mean</span>(X3),<span class="at">sd=</span><span class="fu">sd</span>(X3),<span class="at">estimated =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises test of goodness-of-fit
##  Braun&#39;s adjustment using 5 groups
##  Null hypothesis: Normal distribution
##  with parameters mean = 1.88713294273152, sd = 0.947887463535685
##  Parameters assumed to have been estimated from data
## 
## data:  X3
## omega2max = 0.10696, p-value = 0.9846</code></pre>
</div>
</div>
<div id="the-anderson-darling-metric-by-using-nortest-package" class="section level2">
<h2>5.11 The Anderson-Darling metric by using nortest package</h2>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">ad.test</span>(X1)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  X1
## A = 0.32467, p-value = 0.4574</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">ad.test</span>(X2)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  X2
## A = 0.32419, p-value = 0.5035</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">ad.test</span>(X3)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  X3
## A = 0.13785, p-value = 0.9726</code></pre>
<div id="the-anderson-darling-metric-by-using-goftest-package" class="section level3">
<h3>5.11.1 The Anderson-Darling metric by using goftest package</h3>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">ad.test</span>(X1,<span class="st">&quot;pnorm&quot;</span>,<span class="fu">mean</span>(X1),<span class="at">sd=</span><span class="fu">sd</span>(X1))</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling test of goodness-of-fit
##  Null hypothesis: Normal distribution
##  with parameter sd = 0.699893509643704
##  Parameters assumed to be fixed
## 
## data:  X1
## An = 0.32467, p-value = 0.9169</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">ad.test</span>(X2,<span class="st">&quot;pnorm&quot;</span>,<span class="fu">mean</span>(X2),<span class="at">sd=</span><span class="fu">sd</span>(X2))</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling test of goodness-of-fit
##  Null hypothesis: Normal distribution
##  with parameter sd = 0.947672798832273
##  Parameters assumed to be fixed
## 
## data:  X2
## An = 0.32419, p-value = 0.918</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">ad.test</span>(X3,<span class="st">&quot;pnorm&quot;</span>,<span class="fu">mean</span>(X3),<span class="at">sd=</span><span class="fu">sd</span>(X3))</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling test of goodness-of-fit
##  Null hypothesis: Normal distribution
##  with parameter sd = 0.947887463535685
##  Parameters assumed to be fixed
## 
## data:  X3
## An = 0.13785, p-value = 0.9993</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>goftest<span class="sc">::</span><span class="fu">ad.test</span>(X3,<span class="st">&quot;pnorm&quot;</span>,<span class="at">mean=</span><span class="fu">mean</span>(X3),<span class="at">sd=</span><span class="fu">sd</span>(X3),<span class="at">estimated =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling test of goodness-of-fit
##  Braun&#39;s adjustment using 5 groups
##  Null hypothesis: Normal distribution
##  with parameters mean = 1.88713294273152, sd = 0.947887463535685
##  Parameters assumed to have been estimated from data
## 
## data:  X3
## Anmax = 1.2882, p-value = 0.7384</code></pre>
<p>분석결과, lillie.test는 표본이 작을 때는 유의확률이 cvm.test,ad.test에 비해서는 높지만,<br />
표본이 커질수록 cvm.test와 ad.test의 유의확률이 더 높아지는 것을 확인할 수 있다.</p>
<p>또한 goftest의 패키지를 통해 cvm.test와 ad.test를 이용할 경유 유의확률이 nortest 패키지에 비해서<br />
현저히 증가하는 것을 볼 수 있다.</p>
<p>조금 더 엄격한 정규성 검정이 필요할 경우, goftest보다 nortest 패키지를 이용하는 것이 좋다고 판단된다.</p>
<hr />
</div>
</div>
<div id="summary-of-chapter5" class="section level2">
<h2>Summary of Chapter5</h2>
<ul>
<li><p><strong>가설검정(Hypothesis Test)</strong>는 증명된 바 없는 주장이나 가설을 표본 데이터를 이용하여 가설의 진위여부를 판단, 증명, 검정하는 통계적 추론 방식이다. 가설검정에는 비교하는 값과 차이가 없다는 것을 가설로하는 <strong>귀무가설(Null Hypothesis)</strong>, 새로운 주장 또는 실제로 입증하고자 하는 가설인 <strong>대립가설(Alternative hypothesis)</strong>로 나뉜다.</p></li>
<li><p><strong>유의수준</strong>은 제 1종 오류 즉, 귀무가설이 옳음에도 불구하고 귀무가설을 기각하는 오류의 최대 허용 한계를 의미한다. <strong>유의확률</strong>은 귀무가설이 옳음에도 불구하고 귀무가설을 기각할 확률을 의미한다. 보통, 통계적인 분석을 할 때 유의수준은 5%로 설정하고 유의확률이 0.05보다 작을 때 통계적으로 유의하다고 말한다. 설정한 유의수준보다 유의확률이 낮기 때문에 연구자가 설정한 1종 오류의 허용한계를 넘지 않으므로 유의하다고 말하는 것이다.</p></li>
<li><p><strong>신뢰구간</strong>은 표본을 통해 모수가 어느 범위 안에 있는지를 확률적으로 보여주는 방법이다. 예를 들어, ’95% 신뢰수준에서 S제품의 불량품은 1%~2%이다’라고 할 때, 95%는 신뢰수준이고 1%~2%는 신뢰구간이라고 말한다. 이를 통해, 우리는 모수가 어느 정도의 범위에 속하고 있는지를 알 수 있다.</p></li>
<li><p>앞선 챕터에서 살펴봤듯이, 통계적인 데이터를 사용함에 있어서 정규성은 상당히 중요한 가정이라고 할 수 있다. <strong>히스토그램</strong>을 통해서도 살펴볼 수 있고 <strong>qqplot</strong>을 통해서도 정규성을 검정할 수 있다. <code>qqplot</code>은 <strong>분위수(Quantile)</strong>을 통해 두 확률 분포를 비교하는 것이다. 비교 중인 두 분포가 비슷하면 선형적으로 나타나고 이러한 모양을 가지면 정규성을 가지는 데이터라고 판단할 수 있다.</p></li>
<li><p>시각화를 통해 정규성을 검정하는 방법 외에도 R 프로그램에서는 특정 함수를 입력하게 되면 자동으로 정규성 검정을 진행해준다. 대표적인 함수로는 <strong>shapiro.test,ad.test</strong>등의 함수가 있다. 단, <code>shaprio.test</code>같은 경우 표본수가 3~5000사이의 범위를 가질때에만 검정을 진행할 수 있다. 위의 두 함수를 제외하고, 이번 챕터에서는 꽤 많은 정규성 검정에 대한 함수에 대해 알아보았다. 그래프의 모양을 통해 대략적인 분포를 유추하고 데이터에 따른 적절한 정규성 검정을 사용하면 데이터의 분포를 알 수 았을 것이다.</p></li>
<li><p>R에서 평균차이를 검정하고자 할 때 자주 언급되는 <strong>t.test</strong>외에도 <code>NTplot</code>이라는 함수를 사용할 수 있다. <code>NTplot</code>은 <code>t.test</code>의 결과에 더불어 결과에 대한 시각화까지 도출해준다. 진행한 분석 결과에 대한 기각역, 검정 통계량, 유의확률, 신뢰구간 등을 시각적으로 그려주기 때문에 <code>t.test</code>보다 조금 더 시각적인 결과 정리를 원한다면, 유용한 함수가 될 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap6-one-way-analysis-of-variance" class="section level1">
<h1>Chap6 One-Way Analysis of Variance</h1>
<p>앞서, 우리는 집단 간의 차이를 알아보고자 할 때 T-test 방법을 사용하였다.<br />
하지만 비교하고자 하는 집단의 수가 2 개의 집단이 아니라 3개, 4개 등 3집단 이상일 경우 t-test는 사용할 수 없다.</p>
<p>이렇게 집단이 3개 이상일 때 집단간의 평균의 차이를 알아보기위해 사용하는 방법이 바로 <em>ANOVA</em>방법이다.<br />
<em>ANOVA</em>는 Analysis Of Variance의 약자로 분산분석이라고 일컫는다.</p>
<p>One-way ANOVA는 분산분석에서 사용되는 독립변수의 갯수가 하나일때를 말한다.<br />
Two-way ANOVA는 분산분석에서 사용되는 독립변수의 갯수가 두 개일때를 말한다.</p>
<p>분산분석의 귀무가설은 다음과 같다.</p>
<p>H0: 모든 집단의 평균은 같다.<br />
H1: 적어도 한 집단의 평균은 다르다.</p>
<p>R에서 분산분석을 실행하는 함수는 aov와 anova 함수가 있다.<br />
aov의 경우, (종속변수 ~ 독립변수) Formula의 형태로 지정을 해줘야 한다.<br />
그 다음, 실험결과를 한 객체에 저장한 뒤, summary를 통해 요약된 결과를 볼 수 있다.</p>
<p>또는, aov를 이용해 객체에 저장을 한 후, anova 함수를 사용하여 분산분석의 결과를 확인할 수도 있다.</p>
<div id="example---catalyst-data" class="section level2">
<h2>6.1 Example - Catalyst Data</h2>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(catalystm)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>catalystmi.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>catalystmi.aov</span></code></pre></div>
<pre><code>## Call:
##    aov(formula = concent ~ catalyst, data = catalystm)
## 
## Terms:
##                 catalyst Residuals
## Sum of Squares  85.67583  34.56167
## Deg. of Freedom        3        12
## 
## Residual standard error: 1.697097
## Estimated effects may be unbalanced</code></pre>
<p>aov 함수를 이용해 분산분석을 진행하였다.<br />
summary를 따로 해주지 않으면 분석에 대한 P-value는 출력되지 않고,<br />
처리와 오차에 대한 제곱합과 자유도, 잔차의 standard error 값을 확인할 수 있다.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catalystmi.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## catalyst     3  85.68   28.56   9.916 0.00144 **
## Residuals   12  34.56    2.88                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>summary 함수를 이용하면 기존의 얻은 정보와 더불어 모형에 대한 검정을 할 수 있는 P-value 값 까지 확인할 수 있다.<br />
또한, 분석에 대한 MSE, F-value도 확인할 수 있다.<br />
P-value는 0.00144로 유의수준 0.05보다 작으므로 귀무가설을 기각한다.<br />
즉, 주어진 집단의 평균중, 적어도 하나는 다르다고 할 수 있다.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(catalystmi.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: concent
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## catalyst   3 85.676 28.5586  9.9157 0.001436 **
## Residuals 12 34.562  2.8801                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>anova함수를 이용하면, aov에 summary를 지정한 것 처럼 분산분석에 대한 자세한 결과를 얻을 수 있다.</p>
<p>데이터에 대해서 aov 함수를 지정하여 분산분석을 실행한 후 각 집단의 평균을 보고싶을 때가 있다.<br />
이러할 때에는 model.tables를 통해 집단별 평균과 전체 집단의 평균을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>table_mean <span class="ot">&lt;-</span> <span class="fu">model.tables</span>(catalystmi.aov,<span class="st">&quot;means&quot;</span>)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>table_mean</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##         
## 54.4875 
## 
##  catalyst 
##        A     B     C     D
##     56.9 55.77 53.23 51.12
## rep  5.0  4.00  3.00  4.00</code></pre>
<p>집단별 평균의 차이를 수치적으로 비교하면 한 눈에 살펴보기 어려울 수 있다.<br />
이러한 경우 시각적으로 데이터를 표현하여 조금 더 쉽게 집단간 평균의 차이를 살펴볼 수 있다.<br />
<code>lattice</code>패키지의 <code>bwplot</code>함수를 이용하여 그룹별 boxplot을 그린다.<br />
Formula 형태로 표현하여 하나의 boxplot이 아닌 여러개의 boxplot을 그릴 수 있다.<br />
Formula는 (수치적 자료 ~ 그룹)의 형태로 표현한다.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-96-1.png" width="960" /></p>
<p>집단별로 그려진 boxplot에 따라 box의 형태를 변경할 수도 있다.<br />
<code>bwplot</code>의 <code>par.settingsg</code>옵션을 이용하여 box의 형태를 직접 지정할 수 있다. - box.umbrella: 최대값, 최소값에 대한 옵션을 결정한다.<br />
- box.dot: 중앙값에 대한 옵션을 결정한다.<br />
- box.retangle: 1사분위수, 3사분위수와 데이터의 분포의 정보를 가지고 있는 사각형에 대한 옵션을 결정한다.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm,<span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">box.umbrella=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;orange&quot;</span>)),</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">box.dot=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;orange&quot;</span>)),</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">box.rectangle=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;orange&quot;</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-97-1.png" width="960" /></p>
</div>
<div id="random-effects" class="section level2">
<h2>6.2 Random Effects</h2>
<p>분산분석을 통해 우리는 집단간 차이가 있는지 없는지를 확인할 수 있다.<br />
만약, 모든 집단의 평균은 같다. 라는 귀무가설을 기각하게 되면, 적어도 한 집단에서 차이가 있다는 것을 알 수 있다.<br />
그렇다면, 이러한 차이가 있는 집단을 확인하고 싶을 것이다.<br />
이렇게 집단간에 차이가 어디에서 생겼는지 알고싶을 때 사용하는 것이 바로 사후검정 또는 다중비교(multiple comparison)이다.</p>
<p>R에서는 <code>mmc</code>함수를 통해 분산분석의 결과를 저장한 객체의 다중비교를 s진행할 수 있다.</p>
<p>mmc함수를 실행하게 되면 아래와 같은 결과를 얻을 수 있다.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(catalystmi.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">catalyst=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>catalystm.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = concent ~ catalyst, data = catalystm) 
## Estimated Quantile = 2.962353 
## 95% family-wise confidence level
## $mca
##     estimate   stderr        lower    upper   height
## A-B 1.125000 1.138447 -2.247482644 4.497483 56.33750
## A-C 3.666667 1.239385 -0.004827397 7.338161 55.06667
## B-C 2.541667 1.296179 -1.298073735 6.381407 54.50417
## A-D 5.775000 1.138447  2.402517356 9.147483 54.01250
## B-D 4.650000 1.200029  1.095091158 8.204909 53.45000
## C-D 2.108333 1.296179 -1.731407068 5.948074 52.17917
## $none
##   estimate    stderr    lower    upper   height
## A 56.90000 0.7589649 54.65168 59.14832 56.90000
## B 55.77500 0.8485486 53.26130 58.28870 55.77500
## C 53.23333 0.9798195 50.33076 56.13590 53.23333
## D 51.12500 0.8485486 48.61130 53.63870 51.12500</code></pre>
<p>집단간의 평균 차이 추정치, 표준오차, 평균차이의 하한과 상한 등 다양한 정보를 얻을 수 있다.</p>
<p>집단간의 차이에 대한 사후검정 뿐만아니라, 각 집단에 대한 평균, 표준오차, 평균 추정치의 하한과 상한에 대한 정보 또한 제공한다.</p>
<p>다중비교 역시 수치적으로 확인하는 것 보다는 시각적으로 한 눈에 살펴보는 것이 좋을 것이다.<br />
다중비교를 진행한 분석결과를 특정객체에 저장하고 R의 <code>mmcplot</code>을 이용하게 되면 다중비교의 결과를 한 눈에 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-99-1.png" width="960" /></p>
<p>mmcplot을 통해 다중비교의 결과를 시각적으로 나타내었다.<br />
각 집단의 평균의 값과 집단간 평균의 차이가 한 눈에 보이는 것을 확인할 수 있다.<br />
A-D, B-D의 집단간 차이의 신뢰구간이 0을 포함하지 않으므로 유의한 차이를 보이고 있는 집단이라고 할 수 있으며,<br />
집단간 차이가 유의하면 빨간색 실선, 유의하지 않으면 검은색 점선인 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-100-1.png" width="960" /></p>
<p><code>mmcplot</code>에서 <code>style = 'both'</code>라는 옵션을 지정하게 되면 기존에 MMCplot과 더불어 Tiebreaker라는 그림을 그릴 수 있다.<br />
Tiebreaker의 경우, 집단 별 차이만을 그림에 나타내며, 두 집단의 평균값 또한 나타내준다.<br />
MMCplot과 더불어 유의한 집단간 차이를 보이면 빨간색 실선으로 표시한다.</p>
</div>
<div id="example-batch-data" class="section level2">
<h2>6.3 Example-Batch Data</h2>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(batch)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-101-1.png" width="960" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>batch1.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(batch1.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Calcium
##           Df   Sum Sq  Mean Sq F value   Pr(&gt;F)   
## Batch      4 0.096976 0.024244  5.5352 0.003626 **
## Residuals 20 0.087600 0.004380                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>batch 데이터에 대한 분산분석을 진행한 결과 P-value는 0.003626으로 유의수준 0.05보다 작으므로, 적어도 하나의 집단에서 평균의 차이가 있다는 것을 알 수 있다.</p>
<p>분산분석의 기본 가정 중 하나는 등분산성을 만족하는 것이다. 여기서, 등분산이란 그룹간의 분산이 서로 같다는 것을 의미한다.<br />
등분산 검정의 귀무가설과 대립가설은 다음과 같다.<br />
H0: 모든 분산이 동일하다. (등분산성을 만족한다.) H1: 모든 분산이 동일하지않다. (등분산성을 만족하지 않는다.)</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hovBF</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span></code></pre></div>
<pre><code>## 
##  hov: Brown-Forsyth
## 
## data:  Calcium
## F = 0.032193, df:Batch = 4, df:Residuals = 20, p-value = 0.9978
## alternative hypothesis: variances are not identical</code></pre>
<p>batch 데이터에 대한 등분산 검정을 진행한결과, P-value는 0.9978 유의수준 0.05보다 매우 큰 값을 가지는 것을 볼 수 있다.<br />
따라서, 귀무가설을 기각하지 못하므로 분산의 차이가 없다는 것을 알 수 있으며, 이를 통해, 등분산성을 만족하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hovplotBF</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-103-1.png" width="960" /></p>
<p>hovplotBF 함수를 통해 등분상성에 대한 정보를 시각적으로 표현할 수 있다.<br />
왼쪽 패널의 경우, 집단간 데이터에 대한 boxplot을 보여주고,<br />
중앙 패널의 경우, 집단간 데이터와 데이터의 중앙값의 편차를 boxplot으로 나타내며,<br />
오른쪽 패널의 경우, 중앙 패널에 절대값을 씌운 boxplot을 나타낸다.</p>
</div>
<div id="data-description" class="section level2">
<h2>6.4 Data Description</h2>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(turkey)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>turkey.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain <span class="sc">~</span> diet, <span class="at">data=</span>turkey)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## diet         4 103.04  25.759   81.67 5.6e-14 ***
## Residuals   25   7.89   0.315                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>turkey 데이터에 대한 분산분석(ANOVA)를 진행한다.<br />
P-value는 5.6e-14로 거의 0에 가까운 값을 가지며, 유의수준 0.05보다 작으므로 귀무가설을 기각한다.<br />
즉, turkey 데이터의 diet 집단에 따라 차이 비교를 했을때, 적어도 한 집단 간 평균 차이가 존재한다고 할 수 있다.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(turkey.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##      
## 6.53 
## 
##  diet 
## diet
## control      A1      A2      B1      B2 
##   3.783   5.500   6.983   7.000   9.383 
## 
## Standard errors for differences of means
##           diet
##         0.3242
## replic.      6</code></pre>
<p><code>se=TRUE</code> 옵션을 지정하게 되면 평균의 차이에 대한 표준오차 값까지 얻을 수 있다.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(wt.gain<span class="sc">~</span>diet,<span class="at">data=</span>turkey)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-106-1.png" width="960" /></p>
<p>R에서는 범주형 변수들에 대해서 더미변수를 어떻게 인코딩하는지 확인할 수 있는데, 이러한 경우 <code>contrasts</code>함수를 이용한다.</p>
</div>
<div id="interpretation" class="section level2">
<h2>6.5 Interpretation</h2>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)</span></code></pre></div>
<pre><code>##         A1 A2 B1 B2
## control  0  0  0  0
## A1       1  0  0  0
## A2       0  1  0  0
## B1       0  0  1  0
## B2       0  0  0  1</code></pre>
<p>단순히 R에서 자동으로 인코딩 된 더미변수를 이용하는 것이 아니라, 연구자가 직접 설정할수도 있다.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)<span class="ot">&lt;-</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">control.vs.treatment=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>),</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">amount =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B.by.amount =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)</span></code></pre></div>
<pre><code>##         control.vs.treatment A.vs.B amount A.vs.B.by.amount
## control                 1.00    0.0    0.0              0.0
## A1                     -0.25    0.5    0.5              0.5
## A2                     -0.25    0.5   -0.5             -0.5
## B1                     -0.25   -0.5    0.5             -0.5
## B2                     -0.25   -0.5   -0.5              5.0</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(turkey<span class="sc">$</span>wt.gain,turkey<span class="sc">$</span>diet,mean) <span class="sc">%*%</span> </span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)</span></code></pre></div>
<pre><code>##      control.vs.treatment A.vs.B    amount A.vs.B.by.amount
## [1,]            -3.433333  -1.95 -1.933333           42.675</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>turkey2.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain<span class="sc">~</span>diet,<span class="at">data=</span>turkey)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey2.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## diet         4 103.04  25.759   81.67 5.6e-14 ***
## Residuals   25   7.88   0.315                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>앞서 설정한 contrasts(대비)에 대한 검정또한 진행할 수 있다.<br />
split을 통해 보고자 하는 대비 검정을 지정해준다.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>old.width <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">width=</span><span class="dv">67</span>)</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey2.aov,</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">split=</span><span class="fu">list</span>(<span class="at">diet=</span><span class="fu">list</span>(</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">control.vs.treatment=</span><span class="dv">1</span>,</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">A.vs.B=</span><span class="dv">2</span>,</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">amount=</span><span class="dv">3</span>,</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">A.vs.B.by.amount=</span><span class="dv">4</span></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>        )))</span></code></pre></div>
<pre><code>##                              Df Sum Sq Mean Sq F value   Pr(&gt;F)
## diet                          4 103.04   25.76  81.672 5.60e-14
##   diet: control.vs.treatment  1  56.58   56.58 179.395 6.58e-13
##   diet: A.vs.B                1  22.81   22.81  72.337 7.56e-09
##   diet: amount                1  22.43   22.43  71.105 8.88e-09
##   diet: A.vs.B.by.amount      1   1.21    1.21   3.852   0.0609
## Residuals                    25   7.88    0.32                 
##                                 
## diet                         ***
##   diet: control.vs.treatment ***
##   diet: A.vs.B               ***
##   diet: amount               ***
##   diet: A.vs.B.by.amount     .  
## Residuals                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="a-appendix-computation-for-the-analysis-of-variance" class="section level2">
<h2>6.A Appendix: Computation for the Analysis of Variance</h2>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(catalystm)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>catalystm.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent <span class="sc">~</span> catalyst,</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>catalystm)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(catalystm.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: concent
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## catalyst   3 85.676 28.5586  9.9157 0.001436 **
## Residuals 12 34.562  2.8801                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(catalystm.aov)</span></code></pre></div>
<pre><code>## Tables of effects
## 
##  catalyst 
##         A     B      C      D
##     2.412 1.287 -1.254 -3.362
## rep 5.000 4.000  3.000  4.000</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>Proj <span class="ot">&lt;-</span> <span class="fu">proj</span>(catalystm.aov)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>Proj <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Proj,<span class="at">Sum=</span><span class="fu">apply</span>(Proj,<span class="dv">1</span>,sum))</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>Proj</span></code></pre></div>
<pre><code>##    (Intercept)  catalyst  Residuals  Sum
## 1      54.4875  2.412500  1.3000000 58.2
## 2      54.4875  2.412500  0.3000000 57.2
## 3      54.4875  2.412500  1.5000000 58.4
## 4      54.4875  2.412500 -1.1000000 55.8
## 5      54.4875  2.412500 -2.0000000 54.9
## 6      54.4875  1.287500  0.5250000 56.3
## 7      54.4875  1.287500 -1.2750000 54.5
## 8      54.4875  1.287500  1.2250000 57.0
## 9      54.4875  1.287500 -0.4750000 55.3
## 10     54.4875 -1.254167 -3.1333333 50.1
## 11     54.4875 -1.254167  0.9666667 54.2
## 12     54.4875 -1.254167  2.1666667 55.4
## 13     54.4875 -3.362500  1.7750000 52.9
## 14     54.4875 -3.362500 -1.2250000 49.9
## 15     54.4875 -3.362500 -1.1250000 50.0
## 16     54.4875 -3.362500  0.5750000 51.7</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(Proj,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## (Intercept)    catalyst   Residuals         Sum 
## 47502.20250    85.67583    34.56167 47622.44000</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(catalystm<span class="sc">$</span>catalyst)</span></code></pre></div>
<pre><code>##   B C D
## A 0 0 0
## B 1 0 0
## C 0 1 0
## D 0 0 1</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(catalystm.aov)[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##    catalystB catalystC catalystD
## 1          0         0         0
## 2          0         0         0
## 3          0         0         0
## 4          0         0         0
## 5          0         0         0
## 6          1         0         0
## 7          1         0         0
## 8          1         0         0
## 9          1         0         0
## 10         0         1         0
## 11         0         1         0
## 12         0         1         0
## 13         0         0         1
## 14         0         0         1
## 15         0         0         1
## 16         0         0         1</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>catalystm.lm <span class="ot">&lt;-</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(concent <span class="sc">~</span> X[,<span class="st">&quot;catalystB&quot;</span>]<span class="sc">+</span>X[,<span class="st">&quot;catalystC&quot;</span>]<span class="sc">+</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>       X[,<span class="st">&quot;catalystD&quot;</span>],<span class="at">data=</span>catalystm)</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(catalystm.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: concent
##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## X[, &quot;catalystB&quot;]  1  8.841   8.841  3.0696 0.105259    
## X[, &quot;catalystC&quot;]  1  2.722   2.722  0.9453 0.350118    
## X[, &quot;catalystD&quot;]  1 74.112  74.112 25.7323 0.000274 ***
## Residuals        12 34.562   2.880                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><code>par(mfrow=c())</code>함수를 이용해 subplot의 차원을 지정해 준 후, anova결과가 저장된 객체를 plot으로 나타낼 수 있다.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>old.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(old.par)</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(catalystm.aov)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-114-1.png" width="960" /><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-114-2.png" width="960" /><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-114-3.png" width="960" /><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-114-4.png" width="960" /></p>
<hr />
</div>
<div id="summary-of-chapter6" class="section level2">
<h2>Summary of Chapter6</h2>
<ul>
<li><p>통계적인 분석에서 집단 간 평균 차이가 있는지를 볼 때, 가장 많이 쓰이는 방법은 <code>T-test</code>방법이다. 하지만, <code>T-test</code>의 경우, 비교 하고자 하는 집단이 2개의 집단일때만 가능하고 3개 이상일 경우에는 사용할 수 없다. 이러한 경우 쓰는 통계적 방법이 <strong>ANOVA</strong>이다.</p></li>
<li><p><strong>ANOVA</strong>는 Analysis Of Variance의 약자로 두 개 이상 다수의 집단을 비교하고자 할 때, 집단 간 분산 비교를 통해 만들어진 F분포를 이용하여 평균의 차이에 대한 가설검정을 하는 방법이다. <strong>ANOVA</strong>는 두 개 이상 집단을 비교할 때, 쓰인다고 하지만 대부분 두 개 이상의 집단을 가질때는 <strong>T-test</strong>를 많이 사용하고 <strong>ANOVA</strong>는 집단이 세 개 이상일 때 많이 쓰이는 분석방법이다.</p></li>
<li><p><strong>ANOVA</strong>의 기본가정은 각 집단의 데이터들은 정규분포를 따른다는 <strong>정규성</strong>, 모든 집단의 분산은 서로 동일한 분산을 가진다는 <strong>등분산성</strong>, 집단 간 서로 영향을 미치지 않는다는 <strong>독립성</strong> 3가지 이다.</p></li>
<li><p><strong>ANOVA</strong>의 총제곱합 SST는 처리 제곱합 SSA, 오차의 제곱합 SSE로 변동분해 할 수 있다. 즉, <em>SST = SSA + SSE</em>로 변동분해가 가능하다.</p></li>
<li><p>R에서 <strong>ANOVA</strong>분석은 <code>aov</code>함수를 이용하여 쉽게 분석을 진행할 수 있다. 이 때, 반드시 Formula를 수치적 자료 ~ 그룹의 형태로 input을 지정해 주어야한다. <strong>ANOVA</strong>분석을 진행하기 전에, EDA를 통해 사전에 데이터 탐색을하고 어떠한 집단을 기준으로 수치적 자료를 비교할 것인지를 이해하는 과정이 반드시 필요하다.</p></li>
<li><p><code>aov</code>함수를 이용하여 분산분석의 결과를 살펴 볼때, 우리가 비교하고자 하는 그릅분수(처리)의 P-value가 유의수준 보다 작다면, 유의한 평균차이를 보이는 집단이 적어도 하나 존재한다고 할 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap7-multiple-comparisons" class="section level1">
<h1>Chap7 Multiple Comparisons</h1>
<p>우리는 앞서 분산분석(ANOVA)을 진행해보고 집단간 평균 차이에 유무에 대한 결과를 얻을 수 있었다.<br />
만약, 분산분석의 결과로 ’적어도 한 집단간 차이가 존재한다’라는 결과를 도출하면, 우리는 어느 집단에서 차이가 존재하고, 어느 정도의 차이가 존재하는지에 대한 궁금증이 생길것 이다.</p>
<p>이러한 경우 진행하는 분석이 바로 다중 비교(사후 분석이라고도 한다.)이다.<br />
다중비교의 경우 실험 조건의 평균들을 대상으로 여러번 비교를 수행하는 것이다.</p>
<p>즉, 집단이 A,B,C 3개라면 3번의 비교를 진행하는 것이다.<br />
<em>A-B, A-C, B-C</em></p>
<p>다중비교에서 가장 많이 사용되는 분석은 <em>Bonferroni</em>, <em>Dunnett</em>, <em>Tukey</em>, <em>scheffe</em>가 있다.</p>
<p><em>Bonferroni</em>는 T 검정을 사용하여 그룹 평균 간 쌍대 비교를 수행하는 것이다.<br />
- 집단의 수가 동일하지 않아도 사용이 가능하다.<br />
- 유의수준을 1/n으로 낮추어 다중 비교에서 생기는 오류를 보정한다.<br />
Ex) 유의수준 = 0.05, 평균 쌍 비교 개수 = 5,<br />
사후검정에서의 유의수준 alpha는 다음과 같이 계산된다.</p>
<p><span class="math display">\[
Bonferroni\; \alpha = {0.05\div5 } = 0.01  
\]</span></p>
<p><em>Dunnett</em>은 하나의 집단을 기준으로 다른 집단들과 차이에 대하여 분석하는 방법이다.<br />
- 유의성이 작은 집단에 대한 차이를 검정할 정도로 검정력이 뛰어나다.<br />
- 하나의 집단을 기준으로 하기 때문에, 모든 집단 조합에대한 검정을 하지 않는다.</p>
<p><em>Tukey</em>는 비교되는 모든 집단의 표본 수가 동일한 경우 평균차를 비교하는 방법이다.<br />
- 비교 대상 표본수가 반드시 동일해야 한다.<br />
- 표본수가 동일할 경우 가장 많이 쓰이는 방법이다.<br />
- 표본수가 적을수록 정확도가 낮아진다.</p>
<p><em>scheffe</em>는 단순하게 집단간 비교하는 것 외에도 모든 경우의 수를 비교하며, 집단간 표본의 수가 달라도 사용이 가능한 방법이다.<br />
- 집단을 소극적으로 분리시킨다.<br />
- 하지만, 통계적으로 유의한 차이를 도출하기 쉽지않다.</p>
<div id="multiple-comparison-procedures" class="section level2">
<h2>7.1 Multiple Comparison Procedures</h2>
<div id="the-dunnett-procedure-for-comparing-one-mean" class="section level3">
<h3>7.1.1 The Dunnett Procedure for Comparing One Mean</h3>
<p>with All Others</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(weightloss)</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(loss<span class="sc">~</span>group,<span class="at">data=</span>weightloss,<span class="at">xlab=</span><span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-115-1.png" width="960" /></p>
<p>R에서의 <code>aov</code>함수를 이용하여 분산분석을 진행할 수 있다.<br />
<code>aov(자료변수~집단변수,data=데이터명)</code><br />
- <em>자료변수</em>: 자료들의 정보를 갖고있는 변수를 넣는다.<br />
- <em>집단변수</em>: 집단의 정보를 갖고있는 변수를 넣는다.<br />
- <em>data</em>: 변수들을 갖고있는 데이터를 넣는다.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(weightloss)</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>weightloss.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(loss <span class="sc">~</span> group,<span class="at">data=</span>weightloss)</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weightloss.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## group        4  59.88  14.970   15.07 6.88e-08 ***
## Residuals   45  44.70   0.993                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, P-value는 유의수준 0.05보다 작으므로 <em>적어도 한 집단간에서 평균 차이가 존재한다.</em>는 결론을 도출할 수 있다.</p>
<hr />
<p>집단간 평균차이가 존재하므로 다중비교(사후분석)을 통해 어느 집단에서 차이가 발생했는지를 분석한다.</p>
<p>R에서는 <code>glht</code>함수를 통해 일반화된 선형 가설 검정과 다중비교를 진행할 수 있다.</p>
<p>다중비교를 진행하는 것이기 때문에 분산분석을 진행한 결과를 넣어줘야한다.</p>
<p>이번예제에서는 우측검정을 기반으로한 dunnett 방법을 이용하기 위해 mcp를 통해 linfct의 옵션을 세부적으로 설정해 주었다.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcp</span>(<span class="at">group=</span><span class="fu">contrMat</span>(</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(weightloss<span class="sc">$</span>group),<span class="at">base=</span><span class="dv">4</span>),</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## $group
## 
##   Multiple Comparisons of Means: Dunnett Contrasts
## 
##       A B C  D E
## A - D 1 0 0 -1 0
## B - D 0 1 0 -1 0
## C - D 0 0 1 -1 0
## E - D 0 0 0 -1 1
## 
## $alternative
## [1] &quot;greater&quot;
## 
## attr(,&quot;interaction_average&quot;)
## [1] FALSE
## attr(,&quot;covariate_average&quot;)
## [1] FALSE
## attr(,&quot;class&quot;)
## [1] &quot;mcp&quot;</code></pre>
<p>앞선 boxplot에서 D그룹이 가장 작은 평균값을 가졌기 때문에, <em>Dunnet</em>방법을 이용하기 위해 <code>base=4</code>를 통해 D그룹을 기준변수로 지정해주었다.</p>
<p>첫 번째 줄의 (1,0,0,-1,0)은 기준변수인 D로 A를 비교하겠다.<br />
두 번째 줄의 (0,1,0,-1,0)은 기준변수인 D로 B와 비교하겠다.<br />
라는 의미이다.</p>
<p>가설검정은 <code>greater</code>를 통해 우측검정으로 지정해주었다.</p>
<hr />
<p><code>glht(model,linfct=mcp(그룹변수=다중비교방법))</code><br />
- <em>model</em>: 분산분석의 결과가 저장된 객체를넣는다.<br />
- <em>linfct</em>: 다중비교 방법을 지정해준다.</p>
</div>
<div id="computing-notespecifying-the-alternative-hypothesis" class="section level3">
<h3>7.1.2 Computing Note—Specifying the Alternative Hypothesis</h3>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>weightloss.dunnett <span class="ot">&lt;-</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(weightloss.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">group=</span><span class="fu">contrMat</span>(</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(weightloss<span class="sc">$</span>group),<span class="at">base=</span><span class="dv">4</span>)),</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(weightloss.dunnett)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = loss ~ group, data = weightloss)
## 
## Quantile = -2.2234
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##            Estimate lwr      upr     
## A - D &lt;= 0 2.780000 1.788947      Inf
## B - D &lt;= 0 1.750000 0.758947      Inf
## C - D &lt;= 0 1.000000 0.008947      Inf
## E - D &lt;= 0 2.900000 1.908947      Inf</code></pre>
<p>우측검정을 기준으로 하였기 때문에, 기각역의 상한 band는 inf임을 알 수 있다.<br />
추정값이 모두 기각역안에 들어가므로 귀무가설을 기각함을 알 수 있다.<br />
따라서, D그룹변수와 나머지 그룹변수 간에 모두 유의한 차이가 존재함을 알 수 있다.</p>
<hr />
<p><code>summary</code>함수를 이용해 유의확률을 통해서도 사후검정 결과를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weightloss.dunnett)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = loss ~ group, data = weightloss)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value   Pr(&gt;t)    
## A - D &lt;= 0   2.7800     0.4457   6.237  &lt; 1e-04 ***
## B - D &lt;= 0   1.7500     0.4457   3.926 0.000523 ***
## C - D &lt;= 0   1.0000     0.4457   2.243 0.047787 *  
## E - D &lt;= 0   2.9000     0.4457   6.506  &lt; 1e-04 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(weightloss.dunnett,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-120-1.png" width="960" /></p>
<p>사후검정의 결과를 그림으로 나타낸 결과, 모두 빨간색으로 지정되어 D그룹과 나머지 그룹간 평균차이가 존재하는 것을 시각적으로 살펴볼 수 있다.</p>
<hr />
<p><code>DescTools</code>패키지의 <code>DunnettTest</code>함수를 통해서도 <em>DunnettTest</em>를 진행할 수 있다.<br />
앞서 진행한 분석의 경우, 분산분석을 진행한 후 분산분석의 결과를 객체에 저장해야 됐었지만, <code>DunnettTest</code>함수의 경우에는 Formula형식으로 입력을 해주면 자동으로 사후분석을 진행해준다.</p>
<p><code>DunnettTest(자료변수~그룹변수,데이터,control)</code><br />
- <em>자료변수</em>: 자료의 정보를 갖고있는 변수를 넣어준다.<br />
- <em>그룹변수</em>: 그룹의 정보를 갖고있는 변수를 넣어준다.<br />
- <em>데이터</em>: 변수들의 정보를 갖고있는 데이터를 넣어준다.<br />
- <em>control</em>: 기준변수를 지정해준다.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span></code></pre></div>
<pre><code>## Warning: package &#39;DescTools&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;DescTools&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:fmsb&#39;:
## 
##     CronbachAlpha, VIF</code></pre>
<pre><code>## The following object is masked from &#39;package:HH&#39;:
## 
##     OddsRatio</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DunnettTest</span>(loss<span class="sc">~</span>group,<span class="at">data=</span>weightloss,<span class="at">control=</span><span class="st">&quot;D&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   Dunnett&#39;s test for comparing several treatments with a control :  
##     95% family-wise confidence level
## 
## $D
##     diff     lwr.ci   upr.ci    pval    
## A-D 2.78  1.6515054 3.908495 3.3e-07 ***
## B-D 1.75  0.6215054 2.878495  0.0011 ** 
## C-D 1.00 -0.1284946 2.128495  0.0954 .  
## E-D 2.90  1.7715054 4.028495 8.1e-08 ***
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석의 객체 저장을 진행하지 않고도 바로 사후분석의 결과를 얻는것을 확인할 수 있다.</p>
<hr />
<p><code>HH</code>패키지의 <code>mmc</code>함수를 통해서도 다중비교 분석을 진행할 수 있다.<br />
<code>mmc</code>함수의 경우의 입력방법은 앞서 살펴본 <code>glht</code>함수와 상당히 유사하다.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>weightloss.mmc <span class="ot">&lt;-</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(weightloss.aov,</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">group=</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">contrMat</span>(<span class="fu">table</span>(weightloss<span class="sc">$</span>group),</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">base=</span><span class="dv">4</span>)),</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>weightloss.mmc</span></code></pre></div>
<pre><code>## Dunnett contrasts
## Fit: aov(formula = loss ~ group, data = weightloss) 
## Estimated Quantile = -2.221724 
## 95% family-wise confidence level
## $mca
##     estimate stderr       lower upper height
## E-D     2.90   -Inf 1.909687963   Inf 10.720
## A-D     2.78   -Inf 1.789687963   Inf 10.660
## B-D     1.75   -Inf 0.759687963   Inf 10.145
## C-D     1.00   -Inf 0.009687963   Inf  9.770
## $none
##   estimate stderr     lower upper height
## E    12.17   -Inf 11.469744   Inf  12.17
## A    12.05   -Inf 11.349744   Inf  12.05
## B    11.02   -Inf 10.319744   Inf  11.02
## C    10.27   -Inf  9.569744   Inf  10.27
## D     9.27   -Inf  8.569744   Inf   9.27</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(weightloss.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-123-1.png" width="960" /></p>
<hr />
</div>
<div id="the-scheffe-procedure" class="section level3">
<h3>7.1.3 The Scheff´e Procedure</h3>
<p><em>scheffe</em>방법에는 tukrey 데이터를 이용하여 진행한다.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(turkey)</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>turkey.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain <span class="sc">~</span> diet, <span class="at">data=</span>turkey)</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co">#scheffe method에 calpha을 구한다.  </span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>scheffe.quantile <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">qf</span>(.<span class="dv">95</span>,<span class="dv">4</span>,<span class="dv">25</span>))</span></code></pre></div>
<p>사후분석을 진행하기에 앞서, 비교할 대상에 대한 contrast matrix를 만들어준다.<br />
첫 번째의 경우 control과 나머지 그룹을 비교하기 위해 (1,-.25,-.25,-.25,-.25)로 설정한 것을 확인할 수 있다.<br />
나머지 contrast matrix들도 비교하고자 하는 집단에 따라 구성됐다.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>turkey.lmat <span class="ot">&lt;-</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">control.vs.treatment =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>),</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">amount =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B.by.amount =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(turkey.lmat) <span class="ot">&lt;-</span> <span class="fu">row.names</span>(<span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet))</span></code></pre></div>
<p>앞서 설정한 <em>contrast matrix</em>를 비교군으로 설정하고, calpha 또한 앞에서 quantile을 이용해 구했던 객체를 지정해주었다.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>turkey.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(turkey.aov,<span class="at">calpha=</span>scheffe.quantile,<span class="at">focus =</span> <span class="st">&quot;diet&quot;</span>,<span class="at">focus.lmat=</span>turkey.lmat,</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimate.sign=</span><span class="dv">0</span>,</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order.contrasts =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>우리가 설정한 contrast matrix별 비교는 turkey.mmc$lmat에 저장된 것을 확인할 수 있다.</p>
<p>A. vs.B.by.amount는 신뢰구간이 0을 포함하므로 집단간 차이가 유의하지 않은 것을 알 수 있다.</p>
<p>나머지 그룹의 경우 신뢰구간이 0을 포함하지 않으므로 집단간 차이가 발생하며, 신뢰구간과 추정치를 통해 어느정도의 차이가 나는지 확인할 수 있다.</p>
<hr />
<p><em>mmcplot</em>을 통해서도 A.vs.B.by.amount를 제외한 나머지 그룹이 빨간색으로 지정된 것을 통해 유의한 차이가 있음을 확인할 수 있다.<br />
<em>mmcplot</em>에서 <code>type='lmat</code>를 지정하면 우리가 설정한 contrast matrix에 대한 차이만을 그림으로 나타낼 수 있다.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(turkey.mmc,<span class="at">type=</span><span class="st">&quot;lmat&quot;</span>,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-127-1.png" width="960" /></p>
<p><code>style = confint</code>을 지정하면 신뢰구간에 대한 그림만을 보여준다.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(turkey.mmc,<span class="at">type=</span><span class="st">&quot;lmat&quot;</span>,<span class="at">style=</span><span class="st">&quot;confint&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-128-1.png" width="960" /></p>
<hr />
<p>lmat(contrast matrix)에 대한 설정을 하지 않고 turkey.mmc를 객체로 입력하면 전체의 그룹간 차이를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(turkey.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-129-1.png" width="960" /></p>
<hr />
</div>
</div>
<div id="the-mean-mean-multiple-comparisons-display-mmc-plot" class="section level2">
<h2>7.2 The Mean-Mean Multiple Comparisons Display (MMC Plot)</h2>
<div id="difficulties-with-standard-displays" class="section level3">
<h3>7.2.1 Difficulties with Standard Displays</h3>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(catalystm)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>catalystm1.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>catalystm.glht <span class="ot">&lt;-</span> <span class="fu">glht</span>(catalystm1.aov,</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">catalyst=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(catalystm.glht)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = concent ~ catalyst, data = catalystm)
## 
## Quantile = 2.9655
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##            Estimate  lwr       upr      
## B - A == 0 -1.125000 -4.501041  2.251041
## C - A == 0 -3.666667 -7.342035  0.008702
## D - A == 0 -5.775000 -9.151041 -2.398959
## C - B == 0 -2.541667 -6.385459  1.302125
## D - B == 0 -4.650000 -8.208660 -1.091340
## D - C == 0 -2.108333 -5.952125  1.735459</code></pre>
<p>catalystm의 데이터를 이용하여 사후분석을 진행하였다.<br />
사후분석의 경우 <em>Tukey</em>방법을 이용하였다.<br />
<em>Tukey</em>의 경우 비교하는 집단 간 표본의 수가 같아야 사용할 수 있지만, 프로그램에서는 표본의 수가 달라도 사용할 수 있도록 만들어져있다.</p>
<p>A-D, B-D를 제외하고 모두 신뢰구간에 0이 포함된다. 따라서, A-D, B-D의 집단만이 유의한 차이를 가지고 있다고 할 수 있다.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.glht,<span class="at">style=</span><span class="st">&quot;confint&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-131-1.png" width="960" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-132-1.png" width="960" /></p>
<hr />
<p>앞서 진행한 <em>Tukey</em>분석의 경우 표본의 수가 동일하지 않을때, 사후검정을 진행하였다.<br />
그렇다면 <em>Tukey</em>분석에서 집단 간 표본의 크기를 같게하고, 표본의 크기가 클 때와 작을 때를 비교하면 어떤 결과가 나오는지 알아보자.</p>
<p><code>aovSufficient</code>함수는그룹에 대한 충분통계량을 이용하여 분산분석을 진행하는 방법이다.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">5</span>)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">2.1</span>,<span class="fl">2.8</span>,<span class="dv">3</span>)</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>inconsistent.aov <span class="ot">&lt;-</span> <span class="fu">aovSufficient</span>(ybar <span class="sc">~</span> group, <span class="at">weight=</span>n, <span class="at">sd=</span>.<span class="dv">8</span>)</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(inconsistent.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: ybar
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## group       3  27.024  9.0079  14.075 2.213e-08 ***
## Residuals 206 131.840  0.6400                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, 유의확률은 유의수준 0.05보다 작으므로 적어도 한 그룹 이상에서 유의한 차이를 보인다고 할 수 있다.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey의 확률값을 이용하여 임계값을 구한다.  </span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>crit.point <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(.<span class="dv">95</span>,<span class="dv">4</span>,<span class="dv">206</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>inconsistent.glht <span class="ot">&lt;-</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(inconsistent.aov, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">group=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov=</span>vcovSufficient,<span class="at">df=</span>inconsistent.aov<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## Warning in if (df &lt; 0) stop(sQuote(&quot;df&quot;), &quot; is not positive&quot;):
## length &gt; 1 이라는 조건이 있고, 첫번째 요소만이 사용될 것입니다</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(inconsistent.glht,<span class="at">calpha=</span>crit.point)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = formula, data = data, weights = weights, x = TRUE)
## 
## Quantile = 2.5901
## 95% confidence level
##  
## 
## Linear Hypotheses:
##            Estimate lwr      upr     
## B - A == 0  0.10000 -0.84956  1.04956
## C - A == 0  0.80000 -0.14956  1.74956
## D - A == 0  1.00000 -0.31051  2.31051
## C - B == 0  0.70000  0.40696  0.99304
## D - B == 0  0.90000 -0.04956  1.84956
## D - C == 0  0.20000 -0.74956  1.14956</code></pre>
<p><em>Tukey</em>를 이용한 사후분석 결과 신뢰구간에서 0을 포함하지 않는 그룹은 C-B 하나 뿐인 것을 확인할 수 있다.<br />
따라서, C-B는 유의한 차이가 존재하는 것을 확인할 수 있다.</p>
<p>여기서, C-B의 경우 표본의 수가 100으로 상당히 큰 표본의 수를 가지며, 비교대상끼리 같은 표본의 수를 가지는 것을 확인할 수 있다.<br />
A,D의 경우에는 비교 대상간 표본의 수가 같지만 표본의 수가 5개로 매우 작은 것을 확인할 수 있다.</p>
<p>이를 통해, 우리는 <em>Tukey</em> 사후분석의 경우, 집단간 표본의 수가 같고 클수록 더 정확한 검정을 진행하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ybar<span class="sc">~</span>group)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-135-1.png" width="960" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(<span class="fu">mmc</span>(inconsistent.aov,<span class="at">calpha=</span>crit.point))</span></code></pre></div>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-136-1.png" width="960" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(<span class="fu">mmc</span>(inconsistent.aov,<span class="at">calpha=</span>crit.point),<span class="at">style=</span><span class="st">&quot;confint&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-137-1.png" width="960" /></p>
<p>C-B의 그룹간 차이만이 유의하기 때문에 빨간색으로 표시되어 나타나는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>inconsistent.mmc2 <span class="ot">&lt;-</span> <span class="fu">mmc</span>(inconsistent.aov,<span class="at">calpha=</span>crit.point)</span></code></pre></div>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(inconsistent.mmc2<span class="sc">$</span>none)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-138-1.png" width="960" /></p>
<p>mmc에 내포돼있는 none을 불러오게 되면 각 그룹에 대한 정보만을 볼 수 있다.<br />
B와 D의 평균이 모두 A와 D사이에 있는것을 확인할 수 있다.<br />
A와 D는 표본의 수가 매우 작기때문에 평균에 대한 신뢰구간이 높게 나왔고 B와 C는 그에 반해 표본의 수가 훨씬 많아 신뢰구간이 줄어든 것을 알 수 있다.</p>
</div>
<div id="construction-of-the-mean-mean-scatterplot" class="section level3">
<h3>7.2.2 Construction of the Mean-Mean Scatterplot</h3>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>catalystmi.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(catalystmi.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">catalyst=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-139-1.png" width="960" /></p>
<hr />
<p><code>interaction2wt</code> 함수는 주효과와 교호작용을 시각화 시켜줌으로써 한 눈에 살펴볼 수 있는 함수이다.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(display)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(time <span class="sc">~</span> emergenc <span class="sc">*</span> panel.ordered, <span class="at">data=</span>display)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-140-1.png" width="960" /></p>
</div>
<div id="display-of-an-orthogonal-basis-set-of-contrasts" class="section level3">
<h3>7.2.3 Display of an Orthogonal Basis Set of Contrasts</h3>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="do">## aov contrast matrix for catalyst factor. The columns are</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="do">## constructed by contr.treatment with the default base = 1</span></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(catalystm<span class="sc">$</span>catalyst)</span></code></pre></div>
<pre><code>##   B C D
## A 0 0 0
## B 1 0 0
## C 0 1 0
## D 0 0 1</code></pre>
<p>Base를 설정해주지 않을경우, 자동으로 첫 번째 그룹변수가 base가 된다.<br />
catalyst의 경우 A가 첫 번째 그룹변수이기 때문에 기준 그룹변수로 지정되는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear function used internaily by glht for pairwise contrasts</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The rows of linfct are the difference of the columns</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of the contrast matrix</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>catalystmi.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(catalystmi.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">catalyst=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a>catalystm.mmc<span class="sc">$</span>mca<span class="sc">$</span>glht<span class="sc">$</span>linfct</span></code></pre></div>
<pre><code>##     (Intercept) catalystB catalystC catalystD
## A-B           0        -1         0         0
## A-C           0         0        -1         0
## B-C           0         1        -1         0
## A-D           0         0         0        -1
## B-D           0         1         0        -1
## C-D           0         0         1        -1</code></pre>
<p>mmc의 분석결과에서도 base에 대한 기준이 지정되지 않아 catalystA라는 변수가 아닌 (Intercept)로 지정이 되는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Contrasts in lmat format, each column sums to zero.</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The last three rows are the transpose of the last three columns</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of the linfct matrix.</span></span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The first row is prepended to make the column sum be zero.</span></span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>catalyst.pairwise <span class="ot">&lt;-</span> <span class="fu">lmatPairwise</span>(catalystm.mmc)</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>catalyst.pairwise</span></code></pre></div>
<pre><code>##   A-B A-C B-C A-D B-D C-D
## A   1   1   0   1   0   0
## B  -1   0   1   0   1   0
## C   0  -1  -1   0   0   1
## D   0   0   0  -1  -1  -1</code></pre>
<p><code>lmatPairwise</code>를 이용하여 contrast matrix를 살펴본 결과, 비교 하는 대상간(열을 기준으로)은 항상 합이 0이 되는 것을 확인할 수 있다.<br />
예를 들어, A와 B를 비교할때, A를 기준으로 하므로 A=1, B는 비교대상이므로 B= -1 이고 두 개의 합은 0이다.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="do">## An orthogonal set of ($4-1$) contrasts for the catalyst factor.</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="do">## user-spcified contrasts</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>catalystm.lmat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;AB-D&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;A-B&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;ABD-C&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(catalystm.lmat)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">levels</span>(catalystm<span class="sc">$</span>catalyst)</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>catalystm.lmat</span></code></pre></div>
<pre><code>##   AB-D A-B ABD-C
## A    1   1     1
## B    1  -1     1
## C    0   0    -3
## D   -2   0     1</code></pre>
<p>정확히 두 집단만 비교하는 것이 아니라 원하는 다중 집단을 비교할수도 있다.<br />
첫 번째 열의 <em>AB-D</em>의 경우, A와B를 기준으로 비교를 하기 때문에 A,B를 각각 1,1, 비교대상 D를 -2로 설정하였다. (합은 항상 0이어야 한다.)<br />
세 번째 열의 <em>ABD-C</em>의 경우, A,B,D를 기준으로 비교를 하기 때문에 A,B,D에 각각 (1,1,1), 비교대상 C를 -3으로 설정하였다.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossprod</span>(catalystm.lmat)</span></code></pre></div>
<pre><code>##       AB-D A-B ABD-C
## AB-D     6   0     0
## A-B      0   2     0
## ABD-C    0   0    12</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>catalyst.pairwise</span></code></pre></div>
<pre><code>##   A-B A-C B-C A-D B-D C-D
## A   1   1   0   1   0   0
## B  -1   0   1   0   1   0
## C   0  -1  -1   0   0   1
## D   0   0   0  -1  -1  -1</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(<span class="fu">lm</span>(catalystm.lmat <span class="sc">~</span> catalyst.pairwise))</span></code></pre></div>
<pre><code>##   AB-D A-B ABD-C
## A    0   0     0
## B    0   0     0
## C    0   0     0
## D    0   0     0</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(catalystm1.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">catalyst=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">focus.lmat=</span>catalystm.lmat)</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>catalystm.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = concent ~ catalyst, data = catalystm) 
## Estimated Quantile = 2.965437 
## 95% family-wise confidence level
## $mca
##     estimate   stderr        lower    upper   height
## A-B 1.125000 1.138447 -2.250994483 4.500994 56.33750
## A-C 3.666667 1.239385 -0.008650604 7.341984 55.06667
## B-C 2.541667 1.296179 -1.302072139 6.385405 54.50417
## A-D 5.775000 1.138447  2.399005517 9.150994 54.01250
## B-D 4.650000 1.200029  1.091389355 8.208611 53.45000
## C-D 2.108333 1.296179 -1.735405473 5.952072 52.17917
## $none
##   estimate    stderr    lower    upper   height
## A 56.90000 0.7589649 54.64934 59.15066 56.90000
## B 55.77500 0.8485486 53.25868 58.29132 55.77500
## C 53.23333 0.9798195 50.32774 56.13893 53.23333
## D 51.12500 0.8485486 48.60868 53.64132 51.12500
## $lmat
##       estimate   stderr     lower    upper   height
## A-B   1.125000 1.138447 -2.250994 4.500994 56.33750
## ABD-C 1.366667 1.088144 -1.860156 4.593489 53.91667
## AB-D  5.212500 1.021788  2.182452 8.242548 53.73125</code></pre>
<p>다중비교 결과, 우리가 설정한 3가지의 집단에 대해서도 결과가 알맞게 출력된 것을 확인할 수 있다.<br />
AB-D는 신뢰구간에서 0을 포함하지 않으므로 집단간 유의한 차이가 존재하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc,<span class="at">type=</span><span class="st">&quot;lmat&quot;</span>,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-147-1.png" width="960" /></p>
<p><em>mmcplot</em>함수에서 <em>type = “lmat”</em>옵션을 지정하게 되면 우리가 설정한 <em>contrast matrix</em>에 대한 <code>mmcplot</code>을 그릴 수 있다.<br />
AB-D의 집단간 차이가 유의하여 빨간색으로 지정된 것을 알 수 있다.</p>
<hr />
</div>
<div id="hsu-and-peruggias-pulmonary-example" class="section level3">
<h3>7.2.4 Hsu and Peruggia’s Pulmonary Example</h3>
<p>Pulmonary 데이터셋은 smokers를 특정한 그룹으로 나누고 폐활량에 대한 정보가 담겨있는 데이터이다.<br />
반응변수의 의미는 다음과 같다.<br />
- NS: 비흡연자<br />
- PS: 간접흡연자<br />
- NI: 흡입담배를 피지않는 흡연자<br />
- LS: 지난 20년동안, 하루에 핀 담배의 개수가 1~10개비인 흡연자<br />
- MS: 지난 20년동안, 하루에 핀 담배의 개수가 11~39개비인 흡연자<br />
- HS: 지난 20년동안, 하루에 핀 담배의 개수가 40개비이상인 흡연자</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;pulmonary&quot;</span>)</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pulmonary,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##    smoker   n  FVC    s
## NS     NS 200 3.35 0.63
## PS     PS 200 3.23 0.46
## NI     NI  50 3.19 0.52
## LS     LS 200 3.15 0.39
## MS     MS 200 2.80 0.38</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>pulmonary.aov <span class="ot">&lt;-</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aovSufficient</span>(FVC <span class="sc">~</span> smoker, <span class="at">data=</span>pulmonary,</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights =</span> pulmonary<span class="sc">$</span>n, <span class="at">sd=</span>pulmonary<span class="sc">$</span>s)</span></code></pre></div>
<p>그룹에 따라 표본의 갯수가 지정돼있으므로 충분통계량을 이용햐는 <code>aovSufficient</code>함수를 사용하였다.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pulmonary.aov)</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)    
## smoker         5  89.27  17.853   83.93 &lt;2e-16 ***
## Residuals   1044 222.08   0.213                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석결과, P-value가 유의수준 0.05보다 작으므로 적어도 한 그룹 간 집단차이가 존재하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>crit.point <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(.<span class="dv">95</span>,<span class="dv">4</span>,<span class="dv">206</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>pulmonary.glht <span class="ot">&lt;-</span></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(pulmonary.aov, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">smoker=</span><span class="st">&quot;Tukey&quot;</span>))</span></code></pre></div>
<pre><code>## Warning in summary.lm(object, ...): residual degrees of freedom in
## object suggest this is not an &quot;lm&quot; fit</code></pre>
<pre><code>## Warning in summary.lm(model): residual degrees of freedom in object
## suggest this is not an &quot;lm&quot; fit</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pulmonary.glht)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = formula, data = data, weights = weights, x = TRUE)
## 
## Linear Hypotheses:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## PS - NS == 0 -0.12000    0.04612  -2.602   0.0934 .  
## NI - NS == 0 -0.16000    0.07292  -2.194   0.2333    
## LS - NS == 0 -0.20000    0.04612  -4.336   &lt;0.001 ***
## MS - NS == 0 -0.55000    0.04612 -11.925   &lt;0.001 ***
## HS - NS == 0 -0.80000    0.04612 -17.345   &lt;0.001 ***
## NI - PS == 0 -0.04000    0.07292  -0.549   0.9938    
## LS - PS == 0 -0.08000    0.04612  -1.735   0.4991    
## MS - PS == 0 -0.43000    0.04612  -9.323   &lt;0.001 ***
## HS - PS == 0 -0.68000    0.04612 -14.744   &lt;0.001 ***
## LS - NI == 0 -0.04000    0.07292  -0.549   0.9938    
## MS - NI == 0 -0.39000    0.07292  -5.348   &lt;0.001 ***
## HS - NI == 0 -0.64000    0.07292  -8.776   &lt;0.001 ***
## MS - LS == 0 -0.35000    0.04612  -7.589   &lt;0.001 ***
## HS - LS == 0 -0.60000    0.04612 -13.009   &lt;0.001 ***
## HS - MS == 0 -0.25000    0.04612  -5.420   &lt;0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>사후분석 결과, PS-NS, NI-NS, PS-NI, PS-LS, NI-LS 그룹을 제외한 모든 그룹에서 집단간 차이가 존재하는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(pulmonary.glht)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-151-1.png" width="960" /></p>
<p><em>mmcplot</em> 또한 5가지의 집단 간 차이를 제외한 나머지 집단 간 차이가 모두 유의하므로 빨간색으로 지정한 것을 살펴볼 수 있다.</p>
</div>
</div>
<div id="bonferroni-test" class="section level2">
<h2>7.3 <em>Bonferroni Test</em></h2>
<p><em>Bonferroni Test</em>는 <code>agricolae</code>패키지의 <code>LSD.test</code> 함수를 이용하여 분석을 진행할 수 있다.<br />
<code>LSD.test(model,trt,p.adj)</code></p>
<ul>
<li><em>model</em>: ANOVA 결과의 모델을 넣는다.<br />
</li>
<li><em>trt</em>: group변수를 넣어준다.<br />
</li>
<li><em>p.adj</em>: 유의확률을 어떤 방법으로 조정할지를 넣는다.</li>
</ul>
<p>여기서는 <em>Bonferroni Test</em>를 진행하므로 p.adj에 bonferroni를 넣는다.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code></pre></div>
<pre><code>## Warning: package &#39;agricolae&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;catalystm&quot;</span>)</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>catalystm.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent<span class="sc">~</span>catalyst,<span class="at">data=</span>catalystm)</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(catalystm.aov,<span class="st">&quot;catalyst&quot;</span>,<span class="at">p.adj=</span><span class="st">&quot;bonferroni&quot;</span>,<span class="at">group=</span>F)</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>compare</span></code></pre></div>
<pre><code>## $statistics
##    MSerror Df    Mean       CV
##   2.880139 12 54.4875 3.114654
## 
## $parameters
##         test  p.ajusted   name.t ntr alpha
##   Fisher-LSD bonferroni catalyst   4  0.05
## 
## $means
##    concent      std r      LCL      UCL  Min  Max    Q25   Q50
## A 56.90000 1.519868 5 55.24636 58.55364 54.9 58.4 55.800 57.20
## B 55.77500 1.099621 4 53.92617 57.62383 54.5 57.0 55.100 55.80
## C 53.23333 2.779089 3 51.09849 55.36818 50.1 55.4 52.150 54.20
## D 51.12500 1.443087 4 49.27617 52.97383 49.9 52.9 49.975 50.85
##      Q75
## A 58.200
## B 56.475
## C 54.800
## D 52.000
## 
## $comparison
##       difference pvalue signif.        LCL      UCL
## A - B   1.125000 1.0000         -2.4641619 4.714162
## A - C   3.666667 0.0717       . -0.2407179 7.574051
## A - D   5.775000 0.0016      **  2.1858381 9.364162
## B - C   2.541667 0.4411         -1.5447739 6.628107
## B - D   4.650000 0.0132       *  0.8666912 8.433309
## C - D   2.108333 0.7787         -1.9781072 6.194774
## 
## $groups
## NULL
## 
## attr(,&quot;class&quot;)
## [1] &quot;group&quot;</code></pre>
<p><em>Bonferroni</em>방법을 이용한 사후분석결과와 각 그룹변수에 대한 정보까지 한 번에 얻을 수 있다.<br />
A-D, B-D 그룹을 제외하고 모두 집단 간 차이가 유의하지 않음을 알 수 있다.</p>
<hr />
</div>
<div id="summary-of-chapter7" class="section level2">
<h2>Summary of Chapter7</h2>
<ul>
<li><p>분산분석을 통해 적어도 한 집단 간 유의한 차이가 존재하는 것을 알았다면, 어떤 집단끼리 유의한 차이가 발생했는지에 대해 알아야한다. 이 때, 사용되는 방법을 <strong>다중비교(Multiple Comparison)</strong>라고 한다.</p></li>
<li><p><strong>다중비교(사후검정)</strong>은 실험 집단의 평균을 이용하여 여러번 비교를 수행하여 평균 차이가 존재하는 집단을 찾을 때 사용되는 방법이다.</p></li>
<li><p><strong>다중비교</strong>의 종류는 Bonferroni, Dunnett, Tukey, Scheffe 등 많은 분석 방법이 있다. 다중비교 방법마다 적용되는 방법과 유의 수준이 다르기 때문에, 데이터에 맞는 적절한 다중비교 방법을 적용하어야 한다.</p></li>
<li><p><strong>contrast</strong>는 집단간 평균들을 비교하기 위해서 각 집단들의 평균을 하나의 직선식으로 표현한 것이다. 이때, 행의 합은 항상 0이 되도록 만들어줘야한다. 예를 들어, A,B,C 집단에서 A와 C를 비교하기를 원한다면, (1,0,-1) or (2,0,-2)… 등 다양한 방식으로 표현을 할 수 있다. 하지만, 일반적으로 1을 통해 많이 표현을 한다.</p></li>
<li><p>R에서는 다중비교의 결과를 볼 때, P-value와 유의수준을 통해 볼수도 있지만, 신뢰구간을 통해서 집단 간 평균차이 유무를 알 수 있는데, 바로 신뢰구간이 0을 포함하는 경우이다. 0은 집단 간 평균차이가 없다는 뜻이기 때문에 다중비교 결과의 신뢰구간이 0을 포함한다면, 그 집단의 차이는 유의하지 않다고 판단할 수 있다.</p></li>
<li><p>또한, 앞서 우리가 지속적으로 살펴보고 강조했던 것 처럼, 분석의 결과를 시각적으로 요악하는 작업은 상당히 중요시 된다. R에서는 다중비교의 결과를 <code>mmcplot</code>이라는 함수를 통해 시각화를 진행할 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap8-linear-regression-by-least-squares" class="section level1">
<h1>Chap8 Linear Regression by Least Squares</h1>
<p>우리는 일상에서 수많은 일들을 경험하면서 살아간다. 이러한 경우, 인과관계는 하나의 원인이 하나의 결과에 영향을 미치는 것을 의미한다. 예를 들어, 소득이 높아질수록 세금을 많이 낸다거나 하루 총 칼로리가 높아질수록 몸무게가 커진다 등 우리는 수많은 인과관계 안에서 살아가고 있다.</p>
<p><strong>회귀분석</strong>은 이렇게 관찰된 연속형 변수들에 대해 두 변수 사이의 모형을 구한뒤 적합도를 측정해 내는 분석 방법이다.<br />
시간에 따라 변화하는 데이터나, 어떤 영향, 인과관계의 모델링 등의 통계적인 예측에 이용될 수 있다.</p>
<p><strong>단순회귀분석(Linear Regression)</strong>은 하나의 독립변수와 종속변수를 이용하여 회귀분석을 진행하는 것을 말한다.</p>
<p><strong>독립변수</strong>는 종속변수에 영향을 주는 변수를 의미하고 즉, 원인을 나타내는 변수이고 <strong>종속변수</strong>는 독립 변수에 의해 영향을 받는 변수로 결과를 나타내는 변수이다.</p>
<p>이번 챕터에서는 통계에서 가장 중요하게 여기는 분석방법 중 하나인 회귀분석에 대해서 알아본다.</p>
<p>다양한 회귀 중에서도, 최소제곱법을 통한 선형회귀에 대해서 배워본다.</p>
<div id="example-body-fat-data" class="section level2">
<h2>8.1 Example-Body Fat Data</h2>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(fat)</span></code></pre></div>
<p><strong>fat</strong> 데이터의 변수는 다음과 같다.<br />
* bodyfat: Siri의 방정식을 이용한 체지방 비율<br />
* abdomin: 복부 둘레 * biceps: 확장된 이두근 둘레</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>fat,<span class="at">main=</span><span class="st">&quot;Fat data&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-154-1.png" width="960" /></p>
<p><strong>fat</strong> 산점도 행렬을 그리면 위와 같다.<br />
양의 상관관계를 가지고 있는 몇몇 변수가 보이는 것을 알 수 있다.</p>
</div>
<div id="simple-linear-regression" class="section level2">
<h2>8.2 Simple Linear Regression</h2>
<div id="algebra" class="section level3">
<h3>8.2.1 Algebra</h3>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat, <span class="at">fit.line=</span><span class="cn">FALSE</span>,</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">185</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat,</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">185</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">resid.plot=</span><span class="st">&quot;line&quot;</span>)</span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat,</span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">185</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">resid.plot=</span><span class="st">&quot;square&quot;</span>)</span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>fat<span class="sc">$</span>shallow <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span> .<span class="dv">1</span><span class="sc">*</span>fat<span class="sc">$</span>abdomin</span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>fat.shallow.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(shallow <span class="sc">~</span> abdomin, <span class="at">data=</span>fat)</span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat,</span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">185</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">resid.plot=</span><span class="st">&quot;line&quot;</span>,</span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lm.object=</span>fat.shallow.lm)</span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat,</span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">185</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">resid.plot=</span><span class="st">&quot;square&quot;</span>,</span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lm.object=</span>fat.shallow.lm)</span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a>ALL <span class="ot">&lt;-</span></span>
<span id="cb368-22"><a href="#cb368-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="fu">c</span>(C, E, A, B, D, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)),</span>
<span id="cb368-23"><a href="#cb368-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">skip=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">5</span>)),</span>
<span id="cb368-24"><a href="#cb368-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb368-25"><a href="#cb368-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">y=</span><span class="dv">2</span>),</span>
<span id="cb368-26"><a href="#cb368-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;abdomin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;bodyfat&quot;</span>,</span>
<span id="cb368-27"><a href="#cb368-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab.top=</span><span class="fu">c</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb368-28"><a href="#cb368-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;least-squares fit:</span><span class="sc">\n</span><span class="st">y = -28.56 + .505 x&quot;</span>,</span>
<span id="cb368-29"><a href="#cb368-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;too shallow:</span><span class="sc">\n</span><span class="st">y = 20 + .1x&quot;</span>),</span>
<span id="cb368-30"><a href="#cb368-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab.right=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;squared</span><span class="sc">\n</span><span class="st">residuals&quot;</span>,<span class="st">&quot;residuals&quot;</span>), <span class="at">rot=</span><span class="dv">0</span>))</span>
<span id="cb368-31"><a href="#cb368-31" aria-hidden="true" tabindex="-1"></a>ALL</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-155-1.png" width="960" /></p>
<p>fat 데이터에 대한 잔차를 그래프로 표현하였다.<br />
첫 번째 행 패널은 잔차, 두 번째 행 패널은 표준화된 잔차를 의미한다.<br />
첫 번째 행 패널의 두 번째 그림은 최소제곱법을 통해 잔차를 구한 그림을 나타낸다.</p>
</div>
<div id="calculations" class="section level3">
<h3>8.2.2 Calculations</h3>
<p>R에서의 선형회귀분석은 내장함수인 <code>lm</code>함수를 이용하여 분석을 진행할 수 있다.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(fat)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>fat.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bodyfat<span class="sc">~</span>abdomin,<span class="at">data=</span>fat)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fat.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: bodyfat
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## abdomin    1 2440.5 2440.50  86.427 4.854e-12 ***
## Residuals 45 1270.7   28.24                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fat.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bodyfat ~ abdomin, data = fat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.421  -4.111   1.212   3.522   9.652 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -28.56015    5.10999  -5.589 1.27e-06 ***
## abdomin       0.50494    0.05431   9.297 4.85e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.314 on 45 degrees of freedom
## Multiple R-squared:  0.6576, Adjusted R-squared:   0.65 
## F-statistic: 86.43 on 1 and 45 DF,  p-value: 4.854e-12</code></pre>
<p>선형회귀분석 결과, <strong>abdomin</strong>변수의 유의확률이 유의수준 0.05보다 작으므로 유의한 변수임을 알 수 있다.<br />
선형회귀식 또한 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat.lm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-157-1.png" width="960" /></p>
<p>잔차분석 결과, 모델의 선형성이 어긋나고 등분산성이 만족하지 않는 것처럼 보인다.<br />
또한, 12번, 36번, 39번 데이터가 이상치임을 알 수 있다.<br />
특히, 39번 데이터는 이상치 중에서도 모델에 심각한 영향을 끼치는 이상치로 보인다.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat.lm,<span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-158-1.png" width="960" /></p>
<p><code>which</code>옵션을 이용해 잔차분석에 대한 추가적인 그래프를 더 볼 수 있다.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat,</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">resid.plot=</span><span class="st">&quot;line&quot;</span>)</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(fat<span class="sc">$</span>abdomin, fat<span class="sc">$</span>bodyfat,</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">resid.plot=</span><span class="st">&quot;line&quot;</span>,</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lm.object=</span><span class="fu">lm</span>(bodyfat <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>fat))</span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">c</span>(F, B, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)), <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>),</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;abdomin&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;bodyfat&quot;</span>,</span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab.top=</span><span class="fu">c</span>(<span class="st">&quot;Variance about</span><span class="sc">\n</span><span class="st">mean of y&quot;</span>, <span class="st">&quot;Variance about</span><span class="sc">\n</span><span class="st">least-squares line&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-159-1.png" width="960" /></p>
<p>첫 번째 패널은 표본평균 y와 관측값 y에 대한 잔차를 나타낸 그래프이다.<br />
두 번째 패널은 최소제곱법을 이용한 잔차를 나타낸 그래프이다. (관측값 - 회귀선)의 제곱의 합</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lattice&quot;</span>)</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>bWA <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&quot;</span></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="st"> color   x       y</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="st"> red    1   6</span></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a><span class="st"> blue   2   2</span></span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a><span class="st"> green  3   10</span></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a><span class="st"> orange 4   5</span></span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a><span class="st"> brown  5   18</span></span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a><span class="st"> purple 6   12</span></span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a><span class="st"> &quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb376-12"><a href="#cb376-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-13"><a href="#cb376-13" aria-hidden="true" tabindex="-1"></a>betaWeightedAverageLattice <span class="ot">&lt;-</span></span>
<span id="cb376-14"><a href="#cb376-14" aria-hidden="true" tabindex="-1"></a>   <span class="cf">function</span>(x, y,</span>
<span id="cb376-15"><a href="#cb376-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">xbar=</span><span class="fu">mean</span>(x), <span class="at">ybar=</span><span class="fu">mean</span>(y),</span>
<span id="cb376-16"><a href="#cb376-16" aria-hidden="true" tabindex="-1"></a>            beta1.hat, beta0.hat,</span>
<span id="cb376-17"><a href="#cb376-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">seq</span>(<span class="at">length=</span><span class="fu">length</span>(x))<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb376-18"><a href="#cb376-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">color.summary=</span><span class="dv">1</span>,</span>
<span id="cb376-19"><a href="#cb376-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">summary=</span><span class="cn">TRUE</span>,</span>
<span id="cb376-20"><a href="#cb376-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">summary.text=</span><span class="cn">TRUE</span>,</span>
<span id="cb376-21"><a href="#cb376-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb376-22"><a href="#cb376-22" aria-hidden="true" tabindex="-1"></a>            ...) {</span>
<span id="cb376-23"><a href="#cb376-23" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (<span class="fu">missing</span>(beta1.hat) <span class="sc">||</span> <span class="fu">missing</span>(beta0.hat)) {</span>
<span id="cb376-24"><a href="#cb376-24" aria-hidden="true" tabindex="-1"></a>             beta.hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))</span>
<span id="cb376-25"><a href="#cb376-25" aria-hidden="true" tabindex="-1"></a>             beta1.hat <span class="ot">&lt;-</span> beta.hat[<span class="dv">2</span>]</span>
<span id="cb376-26"><a href="#cb376-26" aria-hidden="true" tabindex="-1"></a>             beta0.hat <span class="ot">&lt;-</span> beta.hat[<span class="dv">1</span>]</span>
<span id="cb376-27"><a href="#cb376-27" aria-hidden="true" tabindex="-1"></a>           }</span>
<span id="cb376-28"><a href="#cb376-28" aria-hidden="true" tabindex="-1"></a>         <span class="fu">xyplot</span>(y <span class="sc">~</span> x, <span class="at">col=</span>col,</span>
<span id="cb376-29"><a href="#cb376-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xbar=</span>xbar,</span>
<span id="cb376-30"><a href="#cb376-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ybar=</span>ybar,</span>
<span id="cb376-31"><a href="#cb376-31" aria-hidden="true" tabindex="-1"></a>                             <span class="at">beta1.hat=</span>beta1.hat,</span>
<span id="cb376-32"><a href="#cb376-32" aria-hidden="true" tabindex="-1"></a>                             <span class="at">beta0.hat=</span>beta0.hat,</span>
<span id="cb376-33"><a href="#cb376-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col=</span>col,</span>
<span id="cb376-34"><a href="#cb376-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color.summary=</span>color.summary,</span>
<span id="cb376-35"><a href="#cb376-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">summary=</span>summary,</span>
<span id="cb376-36"><a href="#cb376-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">summary.text=</span>summary.text,</span>
<span id="cb376-37"><a href="#cb376-37" aria-hidden="true" tabindex="-1"></a>                             <span class="at">cex=</span>cex, <span class="at">pch=</span>pch,</span>
<span id="cb376-38"><a href="#cb376-38" aria-hidden="true" tabindex="-1"></a>                             ...,</span>
<span id="cb376-39"><a href="#cb376-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">panel=</span><span class="cf">function</span>(x, y, ...) {</span>
<span id="cb376-40"><a href="#cb376-40" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.points</span>(<span class="at">x=</span>xbar, <span class="at">y=</span>ybar, <span class="at">pch=</span><span class="dv">8</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>color.summary)</span>
<span id="cb376-41"><a href="#cb376-41" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;bottom&quot;</span>, <span class="at">at=</span>xbar, <span class="at">labels=</span><span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="at">rot=</span><span class="dv">0</span>, <span class="at">outside=</span><span class="cn">TRUE</span>)</span>
<span id="cb376-42"><a href="#cb376-42" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;bottom&quot;</span>, <span class="at">at=</span>xbar, <span class="at">labels=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb376-43"><a href="#cb376-43" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;top&quot;</span>, <span class="at">at=</span>xbar, <span class="at">labels=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb376-44"><a href="#cb376-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;top&quot;</span>, <span class="at">at=</span>xbar, <span class="at">labels=</span><span class="st">&quot;&quot;</span>, <span class="at">outside=</span><span class="cn">TRUE</span>)</span>
<span id="cb376-45"><a href="#cb376-45" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;left&quot;</span>, <span class="at">at=</span>ybar, <span class="at">labels=</span><span class="fu">expression</span>(<span class="fu">bar</span>(y)), <span class="at">outside=</span><span class="cn">TRUE</span>)</span>
<span id="cb376-46"><a href="#cb376-46" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;left&quot;</span>, <span class="at">at=</span>ybar, <span class="at">labels=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb376-47"><a href="#cb376-47" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;right&quot;</span>, <span class="at">at=</span>ybar, <span class="at">labels=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb376-48"><a href="#cb376-48" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.axis</span>(<span class="st">&quot;right&quot;</span>, <span class="at">at=</span>ybar, <span class="at">labels=</span><span class="st">&quot;&quot;</span>, <span class="at">outside=</span><span class="cn">TRUE</span>)</span>
<span id="cb376-49"><a href="#cb376-49" aria-hidden="true" tabindex="-1"></a>                                 <span class="cf">if</span> (summary)</span>
<span id="cb376-50"><a href="#cb376-50" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">panel.abline</span>(<span class="at">a=</span>beta0.hat, <span class="at">b=</span>beta1.hat, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>color.summary)</span>
<span id="cb376-51"><a href="#cb376-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="cf">if</span> (summary.text) {</span>
<span id="cb376-52"><a href="#cb376-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="do">## panel.text(x=xbar-1, y=ybar+2,</span></span>
<span id="cb376-53"><a href="#cb376-53" aria-hidden="true" tabindex="-1"></a>                                       <span class="do">##            expression((bar(x) * &#39;,&#39; * bar(y))),</span></span>
<span id="cb376-54"><a href="#cb376-54" aria-hidden="true" tabindex="-1"></a>                                       <span class="do">##            col=color.summary, cex=2)</span></span>
<span id="cb376-55"><a href="#cb376-55" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">panel.text</span>(<span class="at">x=</span><span class="fl">6.6</span>, <span class="at">y=</span><span class="fl">14.2</span>,<span class="fu">expression</span>(<span class="at">y =</span> <span class="fu">hat</span>(beta)[<span class="dv">0</span>] <span class="sc">+</span> <span class="fu">hat</span>(beta)[<span class="dv">1</span>] <span class="sc">*</span> x),</span>
<span id="cb376-56"><a href="#cb376-56" aria-hidden="true" tabindex="-1"></a>                                                                              <span class="at">col=</span>color.summary, <span class="at">cex=</span><span class="fl">1.4</span>,</span>
<span id="cb376-57"><a href="#cb376-57" aria-hidden="true" tabindex="-1"></a>                                                                              <span class="at">xpd=</span><span class="cn">NA</span>, <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb376-58"><a href="#cb376-58" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">panel.text</span>(<span class="at">x=</span><span class="dv">8</span>, <span class="at">y=</span><span class="fl">14.2</span>,<span class="fu">paste</span>(<span class="st">&quot;  =&quot;</span>, <span class="fu">round</span>(beta0.hat, <span class="dv">3</span>), <span class="st">&quot;+&quot;</span>, </span>
<span id="cb376-59"><a href="#cb376-59" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">round</span>(beta1.hat, <span class="dv">3</span>), <span class="st">&quot;x&quot;</span>),<span class="at">col=</span>color.summary,</span>
<span id="cb376-60"><a href="#cb376-60" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cex=</span><span class="fl">1.4</span>,<span class="at">xpd=</span><span class="cn">NA</span>, <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb376-61"><a href="#cb376-61" aria-hidden="true" tabindex="-1"></a>                                   }</span>
<span id="cb376-62"><a href="#cb376-62" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">panel.segments</span>(x, y,    x,    ybar, <span class="at">col=</span>col, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb376-63"><a href="#cb376-63" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.segments</span>(x, ybar, xbar, ybar, <span class="at">col=</span>col, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb376-64"><a href="#cb376-64" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">panel.segments</span>(x, y,    xbar, ybar, <span class="at">col=</span>col, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb376-65"><a href="#cb376-65" aria-hidden="true" tabindex="-1"></a>                               },</span>
<span id="cb376-66"><a href="#cb376-66" aria-hidden="true" tabindex="-1"></a>                             <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">clip=</span><span class="fu">list</span>(<span class="at">panel=</span><span class="cn">FALSE</span>))</span>
<span id="cb376-67"><a href="#cb376-67" aria-hidden="true" tabindex="-1"></a>                             )</span>
<span id="cb376-68"><a href="#cb376-68" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb376-69"><a href="#cb376-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-70"><a href="#cb376-70" aria-hidden="true" tabindex="-1"></a><span class="do">## betaWeightedAverageLattice(bWA$x, bWA$y, col=bWA$color, xlim=c(-.2, 12.2))</span></span>
<span id="cb376-71"><a href="#cb376-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-72"><a href="#cb376-72" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> bWA<span class="sc">$</span>x<span class="sc">-</span><span class="fu">mean</span>(bWA<span class="sc">$</span>x)</span>
<span id="cb376-73"><a href="#cb376-73" aria-hidden="true" tabindex="-1"></a>dy <span class="ot">&lt;-</span> bWA<span class="sc">$</span>y<span class="sc">-</span><span class="fu">mean</span>(bWA<span class="sc">$</span>y)</span>
<span id="cb376-74"><a href="#cb376-74" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> dy <span class="sc">/</span> dx</span>
<span id="cb376-75"><a href="#cb376-75" aria-hidden="true" tabindex="-1"></a>wts <span class="ot">&lt;-</span> dx<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(dx<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb376-76"><a href="#cb376-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-77"><a href="#cb376-77" aria-hidden="true" tabindex="-1"></a>Six <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c,<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bWA),<span class="cf">function</span>(i)</span>
<span id="cb376-78"><a href="#cb376-78" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">betaWeightedAverageLattice</span>(bWA<span class="sc">$</span>x[i],bWA<span class="sc">$</span>y[i],<span class="at">col=</span>bWA<span class="sc">$</span>color[i],<span class="at">xbar=</span><span class="fu">mean</span>(bWA<span class="sc">$</span>x),</span>
<span id="cb376-79"><a href="#cb376-79" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">ybar=</span><span class="fu">mean</span>(bWA<span class="sc">$</span>y),<span class="at">summary=</span><span class="cn">FALSE</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">xlab=</span><span class="cn">NULL</span>, <span class="at">ylab=</span><span class="cn">NULL</span>,<span class="at">summary.text=</span><span class="cn">FALSE</span>)))</span>
<span id="cb376-80"><a href="#cb376-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-81"><a href="#cb376-81" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">more=</span><span class="cn">TRUE</span>,</span>
<span id="cb376-82"><a href="#cb376-82" aria-hidden="true" tabindex="-1"></a>        <span class="fu">update</span>(Six,</span>
<span id="cb376-83"><a href="#cb376-83" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strip=</span><span class="fu">strip.custom</span>(<span class="at">factor.levels=</span><span class="fu">paste</span>(</span>
<span id="cb376-84"><a href="#cb376-84" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;slope = &quot;</span>, <span class="fu">round</span>(betas, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb376-85"><a href="#cb376-85" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;weight = &quot;</span>, <span class="fu">round</span>(wts, <span class="dv">3</span>),</span>
<span id="cb376-86"><a href="#cb376-86" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb376-87"><a href="#cb376-87" aria-hidden="true" tabindex="-1"></a>                             ),</span>
<span id="cb376-88"><a href="#cb376-88" aria-hidden="true" tabindex="-1"></a>                         <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">lines=</span><span class="fl">2.5</span>, <span class="at">cex=</span>.<span class="dv">7</span>),</span>
<span id="cb376-89"><a href="#cb376-89" aria-hidden="true" tabindex="-1"></a>                         <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="dv">0</span>),</span>
<span id="cb376-90"><a href="#cb376-90" aria-hidden="true" tabindex="-1"></a>                         <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span><span class="dv">1</span>),</span>
<span id="cb376-91"><a href="#cb376-91" aria-hidden="true" tabindex="-1"></a>                         <span class="at">as.table=</span><span class="cn">TRUE</span>,</span>
<span id="cb376-92"><a href="#cb376-92" aria-hidden="true" tabindex="-1"></a>                         <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">1</span>)</span>
<span id="cb376-93"><a href="#cb376-93" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb376-94"><a href="#cb376-94" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb376-95"><a href="#cb376-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-96"><a href="#cb376-96" aria-hidden="true" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>bWA))</span>
<span id="cb376-97"><a href="#cb376-97" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(.<span class="dv">2</span>, <span class="dv">0</span>, .<span class="dv">8</span>, .<span class="dv">6</span>), <span class="at">more=</span><span class="cn">FALSE</span>,</span>
<span id="cb376-98"><a href="#cb376-98" aria-hidden="true" tabindex="-1"></a>         <span class="fu">update</span>(<span class="fu">betaWeightedAverageLattice</span>(bWA<span class="sc">$</span>x, bWA<span class="sc">$</span>y, <span class="at">col=</span>bWA<span class="sc">$</span>color, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">9</span>), <span class="at">summary.text=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="cn">NULL</span>, <span class="at">ylab=</span><span class="cn">NULL</span>),</span>
<span id="cb376-99"><a href="#cb376-99" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strip=</span><span class="fu">strip.custom</span>(<span class="at">factor.levels=</span><span class="fu">paste</span>(<span class="st">&quot;slope =&quot;</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(beta.hat[<span class="dv">2</span>], <span class="dv">3</span>)))))</span>
<span id="cb376-100"><a href="#cb376-100" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-160-1.png" width="960" /></p>
<p>기울기와 가중치에 따른 직선의 변화를 살펴볼 수 있다.</p>
</div>
<div id="new-observations" class="section level3">
<h3>8.2.3 New Observations</h3>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">hat</span>(<span class="fu">model.matrix</span>(fat.lm))</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fat.lm, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(fat.lm)</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(fat.lm)[&#39;Residuals&#39;,&#39;Mean Sq&#39;]를 지정하면 anova에 저장된 MSE값을 객체에 저장할 수 있다.  </span></span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>sigma.hat.sequare <span class="ot">&lt;-</span> <span class="fu">anova</span>(fat.lm)[<span class="st">&quot;Residuals&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a>fat.predvalues <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;y=bodyfat&quot;</span><span class="ot">=</span>fat<span class="sc">$</span>bodyfat,<span class="st">&quot;x=abdomin&quot;</span><span class="ot">=</span>fat<span class="sc">$</span>abdomin, <span class="at">h=</span>h, <span class="at">mu.hat=</span>pred<span class="sc">$</span>fit, <span class="at">e=</span>res, <span class="at">var.mu.hat=</span>h<span class="sc">*</span>sigma.hat.sequare, <span class="at">var.resid=</span>(<span class="dv">1</span><span class="sc">-</span>h)<span class="sc">*</span>sigma.hat.sequare, <span class="at">se.fit=</span><span class="fu">sqrt</span>(h<span class="sc">*</span>sigma.hat.sequare),<span class="at">se.resid=</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">-</span>h))<span class="sc">*</span>sigma.hat.sequare)</span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a>fat.predvalues[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span></code></pre></div>
<pre><code>##   y.bodyfat x.abdomin          h   mu.hat         e var.mu.hat
## 1      12.6      85.2 0.02762220 14.46046 -1.860461  0.7799891
## 2       6.9      83.0 0.03171035 13.34960 -6.449600  0.8954292
## 3      24.6      87.9 0.02398709 15.82379  8.776210  0.6773415
##   var.resid
## 1  27.45777
## 2  27.34233
## 3  27.56042</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="do">## linear identity</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">rowSums</span>(fat.predvalues[,<span class="fu">c</span>(<span class="st">&quot;mu.hat&quot;</span>,<span class="st">&quot;e&quot;</span>)]),fat<span class="sc">$</span>bodyfat,<span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="do">## quadratic identity</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>(SSqReg <span class="ot">&lt;-</span> <span class="fu">sum</span>((fat.predvalues<span class="sc">$</span>mu.hat<span class="sc">-</span><span class="fu">mean</span>(fat<span class="sc">$</span>bodyfat))<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2440.5</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>(SSqRes <span class="ot">&lt;-</span> <span class="fu">sum</span>(res<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1270.699</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>(SSqTot <span class="ot">&lt;-</span> <span class="fu">sum</span>((fat<span class="sc">$</span>bodyfat <span class="sc">-</span> <span class="fu">mean</span>(fat<span class="sc">$</span>bodyfat))<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 3711.199</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(SSqReg <span class="sc">+</span> SSqRes, SSqTot)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><strong>SST,SSR,SSE</strong>를 <code>fat</code>데이터를 이용하여 직접 계산하였다.<br />
그 후, R의 <code>all.equal</code>함수를 이용하여 SST(총변동) = SSR + SSE이 식대로 정말 같은지 확인하였다.<br />
결과값은 TRUE로, 주어진 식이 성립하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>old.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">50</span>),<span class="at">x1=</span><span class="fu">rnorm</span>(<span class="dv">50</span>),<span class="at">x2=</span><span class="fu">rnorm</span>(<span class="dv">50</span>),<span class="at">x3=</span><span class="fu">rnorm</span>(<span class="dv">50</span>))</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>example.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3,<span class="at">data=</span>old.data)</span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a>(example.coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(example.lm))</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2          x3 
##  0.01655401 -0.28723580  0.13264896  0.13650668</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>(new.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1=</span><span class="dv">3</span>,<span class="at">x2=</span><span class="dv">2</span>,<span class="at">x3=</span><span class="dv">45</span>))</span></code></pre></div>
<pre><code>##   x1 x2 x3
## 1  3  2 45</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(example.lm,<span class="at">newdata =</span> new.data,<span class="at">se.fit=</span><span class="cn">TRUE</span>,<span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<pre><code>## $fit
##        fit       lwr      upr
## 1 5.562945 -11.33792 22.46381
## 
## $se.fit
## [1] 8.396295
## 
## $df
## [1] 46
## 
## $residual.scale
## [1] 1.140696</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(example.lm,<span class="at">newdata=</span>new.data,<span class="at">se.fit=</span><span class="cn">TRUE</span>,</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>## $fit
##        fit       lwr      upr
## 1 5.562945 -11.49318 22.61907
## 
## $se.fit
## [1] 8.396295
## 
## $df
## [1] 46
## 
## $residual.scale
## [1] 1.140696</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">data.matrix</span>(new.data)) <span class="sc">%*%</span> example.coef</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 5.562945</code></pre>
<p>난수를 통해 회귀식을 세우고 새로운 데이터에 대해서 선형회귀식을 적합시켰다.<br />
<code>predict</code>함수를 통해 새로운 데이터에 대한 예측을 진행할 수 있다.<br />
<code>se.fit</code> 옵션을 통해 잔차를 계산할 수 있고 <code>interval</code>옵션을 통해 신뢰구간을 구할 수 있다.</p>
<hr />
<p><code>ci.plot</code>함수를 사용하면 앞선 분석을 통해 얻었던 관찰값, 회귀식, 신뢰구간 등을 시각적으로 나타낼 수 있다.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.plot</span>(fat.lm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-164-1.png" width="960" /></p>
<p><code>lmplot</code>함수를 사용하면 회귀모형을 진단하기 위한 정보를 얻을 수 있다.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmplot</span>(fat.lm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-165-1.png" width="960" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>colB <span class="ot">&lt;-</span> <span class="fu">likertColor</span>(<span class="dv">2</span>)[<span class="dv">2</span>]</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">101</span>)</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(pp)</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(pp <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">xlab.top=</span><span class="fu">list</span>(<span class="st">&quot;Cumulative Distribution of N(0,1)</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>), <span class="at">col=</span>colB,</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>), <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>), <span class="at">ylab.right=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>, <span class="at">tck=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-166-1.png" width="960" /></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fat)</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n)<span class="sc">/</span>n</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>diag2a <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(f <span class="sc">~</span> <span class="fu">sort</span>(<span class="fu">predict</span>(fat.lm)), <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">&quot;empirical cdf of</span><span class="sc">\n</span><span class="st">fitted values</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">col=</span>colB)</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>diag2b <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(f <span class="sc">~</span> <span class="fu">sort</span>(<span class="fu">resid</span>(fat.lm)), <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">&quot;empirical cdf of</span><span class="sc">\n</span><span class="st">residuals</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">col=</span>colB)</span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">c</span>(diag2a, diag2b, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)),</span>
<span id="cb402-9"><a href="#cb402-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="fu">c</span>(diag2a<span class="sc">$</span>xlab, diag2b<span class="sc">$</span>xlab), <span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb402-10"><a href="#cb402-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab.top=</span><span class="fu">list</span>(<span class="fu">c</span>(diag2a<span class="sc">$</span>main, diag2b<span class="sc">$</span>main), <span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb402-11"><a href="#cb402-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>), <span class="at">ylab.right=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb402-12"><a href="#cb402-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="cn">NULL</span>,</span>
<span id="cb402-13"><a href="#cb402-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>, <span class="at">tck=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))),</span>
<span id="cb402-14"><a href="#cb402-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-166-2.png" width="960" /></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>mean.bodyfat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fat<span class="sc">$</span>bodyfat)</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>diag3a <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(f <span class="sc">~</span> <span class="fu">sort</span>(<span class="fu">predict</span>(fat.lm) <span class="sc">-</span> mean.bodyfat), <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">&quot;empirical cdf of</span><span class="sc">\n</span><span class="st">centered fitted values</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">col=</span>colB)</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>diag3b <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(f <span class="sc">~</span> <span class="fu">sort</span>(<span class="fu">resid</span>(fat.lm)), <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">&quot;empirical cdf of</span><span class="sc">\n</span><span class="st"> residuals</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">col=</span>colB)</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>tmp3 <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">c</span>(diag3a, diag3b, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)),</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">paste0</span>(diag3a<span class="sc">$</span>xlab, <span class="st">&quot;       &quot;</span>), diag3b<span class="sc">$</span>xlab), <span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab.top=</span><span class="fu">list</span>(<span class="fu">c</span>(diag3a<span class="sc">$</span>main, diag3b<span class="sc">$</span>main), <span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>), <span class="at">ylab.right=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="cn">NULL</span>,</span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>, <span class="at">tck=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))),</span>
<span id="cb403-12"><a href="#cb403-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>))</span>
<span id="cb403-13"><a href="#cb403-13" aria-hidden="true" tabindex="-1"></a>tmp3c <span class="ot">&lt;-</span></span>
<span id="cb403-14"><a href="#cb403-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combineLimits</span>(<span class="fu">as.matrix</span>(<span class="at">row=</span><span class="cn">TRUE</span>, tmp3), <span class="at">margin.x=</span><span class="dv">1</span>)</span>
<span id="cb403-15"><a href="#cb403-15" aria-hidden="true" tabindex="-1"></a>tmp3c</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-166-3.png" width="960" /></p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>diag4a <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(<span class="fu">sort</span>(<span class="fu">predict</span>(fat.lm) <span class="sc">-</span> mean.bodyfat) <span class="sc">~</span> f, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">&quot;transposed empirical cdf of</span><span class="sc">\n</span><span class="st">centered fitted values&quot;</span>, <span class="at">col=</span>colB)</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>diag4b <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(<span class="fu">sort</span>(<span class="fu">resid</span>(fat.lm)) <span class="sc">~</span> f, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">&quot;transposed empirical cdf of</span><span class="sc">\n</span><span class="st">residuals&quot;</span>, <span class="at">col=</span>colB)</span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a>tmp4 <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">c</span>(diag4a, diag4b, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)),</span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab.top=</span><span class="fu">list</span>(<span class="fu">c</span>(diag4a<span class="sc">$</span>main, diag4b<span class="sc">$</span>main), <span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>), <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="cn">NULL</span>,</span>
<span id="cb404-10"><a href="#cb404-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab.right=</span><span class="fu">list</span>(diag4b<span class="sc">$</span>ylab, <span class="at">cex=</span><span class="fl">1.3</span>),</span>
<span id="cb404-11"><a href="#cb404-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>, <span class="at">tck=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)), <span class="at">y=</span><span class="fu">list</span>(<span class="at">rot=</span><span class="dv">0</span>)),</span>
<span id="cb404-12"><a href="#cb404-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>))</span>
<span id="cb404-13"><a href="#cb404-13" aria-hidden="true" tabindex="-1"></a><span class="fu">combineLimits</span>(<span class="fu">as.matrix</span>(<span class="at">row=</span><span class="cn">TRUE</span>, tmp4))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-166-4.png" width="960" /></p>
<p>회귀모형에 대한 empricial distribution을 plot을 통해 나타내었다.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">1</span>) <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="fl">-.1</span>) <span class="sc">*</span> e</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span>) <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="fl">-.5</span>) <span class="sc">*</span> e</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>y9 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">9</span>) <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="fl">-.9</span>) <span class="sc">*</span> e</span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true" tabindex="-1"></a>rr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, e, y1, y5, y9)</span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true" tabindex="-1"></a>ThreeR2 <span class="ot">&lt;-</span></span>
<span id="cb405-10"><a href="#cb405-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb405-11"><a href="#cb405-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">diagplot5new</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x, <span class="at">data=</span>rr), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.2</span>, <span class="fl">3.2</span>)),</span>
<span id="cb405-12"><a href="#cb405-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">diagplot5new</span>(<span class="fu">lm</span>(y5 <span class="sc">~</span> x, <span class="at">data=</span>rr), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.2</span>, <span class="fl">3.2</span>)),</span>
<span id="cb405-13"><a href="#cb405-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">diagplot5new</span>(<span class="fu">lm</span>(y9 <span class="sc">~</span> x, <span class="at">data=</span>rr), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.2</span>, <span class="fl">3.2</span>))</span>
<span id="cb405-14"><a href="#cb405-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb405-15"><a href="#cb405-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ThreeR2</span></span>
<span id="cb405-16"><a href="#cb405-16" aria-hidden="true" tabindex="-1"></a>TM <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">matrix.trellis</span>(ThreeR2, <span class="at">byrow=</span><span class="cn">TRUE</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>), <span class="at">between=</span><span class="fu">list</span>(<span class="at">y=</span><span class="dv">1</span>))</span>
<span id="cb405-17"><a href="#cb405-17" aria-hidden="true" tabindex="-1"></a><span class="do">## TM</span></span>
<span id="cb405-18"><a href="#cb405-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-19"><a href="#cb405-19" aria-hidden="true" tabindex="-1"></a>TMn <span class="ot">&lt;-</span> <span class="fu">update</span>(TM,</span>
<span id="cb405-20"><a href="#cb405-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab.top=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(y)<span class="sc">-</span><span class="fu">bar</span>(y)), <span class="fu">expression</span>(y<span class="sc">-</span><span class="fu">hat</span>(y))),</span>
<span id="cb405-21"><a href="#cb405-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab.right=</span><span class="cn">NULL</span>)</span>
<span id="cb405-22"><a href="#cb405-22" aria-hidden="true" tabindex="-1"></a><span class="do">## TMn</span></span>
<span id="cb405-23"><a href="#cb405-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-24"><a href="#cb405-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">more=</span><span class="cn">TRUE</span>,</span>
<span id="cb405-25"><a href="#cb405-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span>(<span class="at">strip=</span><span class="cn">FALSE</span>, <span class="at">xlab.top=</span><span class="fu">expression</span>(<span class="fu">phantom</span>(<span class="fu">hat</span>(y))<span class="sc">*</span>y<span class="sc">*</span><span class="fu">phantom</span>(<span class="fu">hat</span>(y))),</span>
<span id="cb405-26"><a href="#cb405-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="cn">NULL</span>,</span>
<span id="cb405-27"><a href="#cb405-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab.right=</span><span class="fu">list</span>(<span class="fu">c</span>(</span>
<span id="cb405-28"><a href="#cb405-28" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span><span class="sc">==</span>.<span class="dv">1</span>),</span>
<span id="cb405-29"><a href="#cb405-29" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span><span class="sc">==</span>.<span class="dv">5</span>),</span>
<span id="cb405-30"><a href="#cb405-30" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span><span class="sc">==</span>.<span class="dv">9</span>)), <span class="at">rot=</span><span class="dv">0</span>),</span>
<span id="cb405-31"><a href="#cb405-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.2</span>, <span class="fl">3.2</span>),</span>
<span id="cb405-32"><a href="#cb405-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">xyplot</span>(y1 <span class="sc">+</span> y5 <span class="sc">+</span> y9 <span class="sc">~</span> x, <span class="at">data=</span>rr, <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb405-33"><a href="#cb405-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel=</span><span class="cf">function</span>(...) {</span>
<span id="cb405-34"><a href="#cb405-34" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">panel.lmline</span>(...)</span>
<span id="cb405-35"><a href="#cb405-35" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">panel.points</span>(...)</span>
<span id="cb405-36"><a href="#cb405-36" aria-hidden="true" tabindex="-1"></a>                    },</span>
<span id="cb405-37"><a href="#cb405-37" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb405-38"><a href="#cb405-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>), <span class="at">between=</span><span class="fu">list</span>(<span class="at">y=</span><span class="dv">1</span>))</span>
<span id="cb405-39"><a href="#cb405-39" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb405-40"><a href="#cb405-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-41"><a href="#cb405-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(.<span class="dv">39</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">more=</span><span class="cn">FALSE</span>,</span>
<span id="cb405-42"><a href="#cb405-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span>(TMn, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.2</span>, <span class="fl">3.2</span>))</span>
<span id="cb405-43"><a href="#cb405-43" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-167-1.png" width="960" /></p>
<p>임의의 난수를 생성하여 산점도를 살펴보고 그에 따른 결정계수를 구해보았으며, empricial distribution을 오른쪽 패널에 나타내었다.</p>
<hr />
</div>
</div>
<div id="summary-of-chapter8" class="section level2">
<h2>Summary of Chapter8</h2>
<ul>
<li><p><strong>회귀분석</strong>이란 인과관계를 맺고 있는 변수들간의 함수 관계를 규명하여 최적회귀모형을 도출하기위한 통계적 분석방법이다. 다시 말해서, 우리가 가지고 있는 원인변수가 결과변수에 얼만큼의 영향을 미치고 원인변수를 통해 결과변수를 예측하는 것을 목표로한다.</p></li>
<li><p><strong>단순회귀분석</strong>은 하나의 독립변수와 하나의 종속변수를 이용하여 회귀모형에 적합시키는 것을 말한다. <strong>종속변수</strong>는 우리가 예측하고자 하는 변수로 인과관계에서 결과의 의미를 가지고 있는 변수를 말하며, <strong>독립변수</strong>는 종속변수에 대해 영향을 미치는 변수를 말하며 원인의 의미를 가지고 있는 변수이다.</p></li>
<li><p><strong>최소제곱법</strong>은 근사적으로 구하려는 해와 실제 해의 오차의 제곱의 합이 최소가 되는 해를 구하는 방식이다. 일반적으로 단순회귀분석에서는 이러한 최소제곱법을 이용하여 회귀모형에 대한 가장 적합한 직선을 찾게 된다.</p></li>
<li><p>회귀분석은 일반적으로 4가지의 기본 가정을 가지고 있는데 ANOVA와 동일한 기본 가정인 <strong>독립성</strong>, <strong>등분산성</strong>, <strong>정규성</strong>과 <strong>선형성</strong>의 가정을 가지게 된다. <strong>선형성은</strong> 종속변수와 독립변수간 선형성을 만족한다는 가정을 말한다. 이러한 가정들은 변수들을 모형에 적합시킨 후, 잔차분석을 통해 기본가정이 성립하는지 확인할 수 있다.</p></li>
<li><p><strong>결정계수</strong>는 독립변수와 종속변수를 통해 우리가 추정한 회귀 모형이 얼마 만큼 적합한지를 나타내는 척도로, 최대값은 1이며 높을수록 적합도가 높다는 의미이다.</p></li>
<li><p>R에서는 <code>lm</code>함수를 이용하여 회귀분석을 쉽게 진행할 수 있다. <code>lm</code>의 기본적인 Formula는 (종속변수 ~ 독립변수,data)의 형태로 지정하여 분석을 할 수 있다. <code>lm</code>을 통해 회귀모형을 만들게 되면, 독립변수가 유의한지, 주어진 회귀모형의 적합도와 회귀모형이 유의한지, 잔차분석 등 많은 유용한 정보를 확인할 수 있다.</p></li>
</ul>
<hr />
<hr />
</div>
</div>
<div id="chapter-9-multiple-regression---more-than-one-predictor" class="section level1">
<h1>Chapter 9 Multiple Regression - More than One Predictor</h1>
<p>앞선 챕터에서 우리는 하나의 독립변수를 가지는 <strong>단순선형회귀</strong>분석에 대해서 알아보았다.<br />
정확히 하나의 결과에만 영향을 미치는 독립변수가 하나만 있다면 예측력도 좋고 간단한 모델을 만들 수 있을 것이다.</p>
<p>하지만, 우리의 일상에서는 하나의 결과에 대하여 수많은 원인을 갖고 있는 경우가 대부분이다.<br />
따라서, 이러한 경우에는 하나의 독립변수만을 사용하는 <strong>단순선형회귀분석</strong>을 이용할 수가 없다.</p>
<p>독립변수가 하나가 아닌 두 개 이상의 독립변수를 갖는 경우, <strong>다중회귀분석</strong>을 이용하여 회귀모형을 만들어야 한다.<br />
<strong>다중회귀분석</strong>은 하나의 종속변수에 대하여 독립변수가 두 개이상 있을 때 사용하는 분석기법으로, 종속변수에 영향을 미치는 유의한 독립변수를 찾을 때, 유용한 분석 방법이다.</p>
<p>이번 챕터에서는 <strong>다중회귀분석</strong>에 대하여 알아보도록 한다.</p>
<div id="multiple-regression---two-x-analysis" class="section level2">
<h2>9.1 Multiple Regression - Two X Analysis</h2>
<p><code>car</code>패키지의 <code>scatter3d</code>함수를 이용하여 3차원의 산점도를 그릴 수 있다.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>fat2.resid <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(bodyfat <span class="sc">~</span> abdomin <span class="sc">+</span> biceps, <span class="at">data=</span>fat))</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">scatter3d</span>(bodyfat <span class="sc">~</span> abdomin <span class="sc">+</span> biceps, <span class="at">data=</span>fat, <span class="at">fit=</span><span class="st">&quot;linear&quot;</span>,</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">residuals=</span><span class="st">&quot;squares&quot;</span>,</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">axis.scales=</span><span class="cn">TRUE</span>, <span class="at">grid=</span><span class="cn">TRUE</span>, <span class="at">ellipsoid=</span><span class="cn">FALSE</span>,</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">square.color =</span> <span class="st">&quot;gray80&quot;</span>, <span class="at">surface.col=</span><span class="st">&quot;#a6cafe&quot;</span>,</span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">surface.alpha=</span>.<span class="dv">3</span>, <span class="at">sphere.size=</span>.<span class="dv">7</span>,</span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>)[<span class="dv">1</span><span class="sc">+</span>(fat2.resid <span class="sc">&gt;=</span> <span class="dv">0</span>)])</span></code></pre></div>
<pre><code>## Loading required namespace: rgl</code></pre>
<pre><code>## Loading required namespace: mgcv</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>fat2.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bodyfat <span class="sc">~</span> abdomin <span class="sc">+</span> biceps, <span class="at">data=</span>fat)</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fat2.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: bodyfat
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## abdomin    1 2440.50 2440.50 101.1718 5.581e-13 ***
## biceps     1  209.32  209.32   8.6773  0.005134 ** 
## Residuals 44 1061.38   24.12                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fat2.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bodyfat ~ abdomin + biceps, data = fat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.2524  -3.6736   0.7158   3.7708  10.2405 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -14.59374    6.69222  -2.181  0.03460 *  
## abdomin       0.68294    0.07856   8.693 4.17e-11 ***
## biceps       -0.92215    0.31305  -2.946  0.00513 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.911 on 44 degrees of freedom
## Multiple R-squared:  0.714,  Adjusted R-squared:  0.701 
## F-statistic: 54.92 on 2 and 44 DF,  p-value: 1.096e-12</code></pre>
<p><code>fat</code>데이터에 대해서 다중회귀분석을 진행하였다.<br />
회귀식에 사용된 <strong>abdomin,biceps</strong>변수 모두 유의확률이 유의수준 0.05보다 작은 것으로 보아 유의한 변수임을 확인할 수 있다.</p>
<hr />
<p><strong>fat2.lm</strong>의 회귀모형을 진단하기 위해 <code>lmplot</code>함수를 사용하였다.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmplot</span>(fat2.lm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-170-1.png" width="960" /></p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat2.lm)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-171-1.png" width="960" /></p>
<p>잔차분석 결과, 36,39,41번 데이터가 이상점인 것을 확인할 수 있었다.<br />
선형성과 정규성, 등분산성은 약간 만족하지 않는 것 처럼 보인다.</p>
</div>
<div id="example---albuquerque-home-price-data" class="section level2">
<h2>9.2 Example - Albuquerque Home Price Data</h2>
<div id="data-description-1" class="section level3">
<h3>9.2.1 Data Description</h3>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;houseprice&quot;</span>)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>houseprice)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-172-1.png" width="960" /></p>
<p><strong>houseprice</strong>데이터의 변수별 관계를 살펴보기 위해 산점도 행렬을 그려보았다.<br />
<strong>price-sqft</strong>,<strong>price-taxes</strong>는 양의 상관관계를 가지고 있는 것 처럼 보인다.</p>
</div>
</div>
<div id="partial-f-tests" class="section level2">
<h2>9.3 Partial F-Tests</h2>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>houseprice.lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> sqft <span class="sc">+</span> taxes <span class="sc">+</span> custom <span class="sc">+</span> corner, <span class="at">data=</span>houseprice)</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(houseprice.lm2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: price
##            Df   Sum Sq  Mean Sq  F value    Pr(&gt;F)    
## sqft        1 11102445 11102445 421.3406 &lt; 2.2e-16 ***
## taxes       1  1374474  1374474  52.1616  9.46e-11 ***
## custom      1   350716   350716  13.3098 0.0004181 ***
## corner      1   114215   114215   4.3345 0.0398506 *  
## Residuals 102  2687729    26350                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(houseprice.lm2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ sqft + taxes + custom + corner, data = houseprice)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -544.58  -99.53   -4.83   64.76  510.15 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 175.16603   56.31157   3.111 0.002421 ** 
## sqft          0.20760    0.06105   3.401 0.000961 ***
## taxes         0.67707    0.10101   6.703 1.15e-09 ***
## custom      156.81481   44.49454   3.524 0.000637 ***
## corner      -83.40126   40.05934  -2.082 0.039851 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 162.3 on 102 degrees of freedom
## Multiple R-squared:  0.828,  Adjusted R-squared:  0.8213 
## F-statistic: 122.8 on 4 and 102 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><strong>price</strong>를 종속변수로 하고 <strong>sqft, taxes, custom, corner </strong>을 독립변수로 하는 회귀분석을 진행하였다.<br />
회귀분석 결과, 모든 변수의 유의확률이 유의수준 0.05보다 작으므로 모든 독립변수는 유의하다.<br />
또한, 회귀모형의 P-value가 0.05보다 작으므로 회귀모형은 유의한 모형임을 확인할 수 있다.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>house_dat <span class="ot">&lt;-</span> houseprice <span class="sc">%&gt;%</span> </span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(price,sqft,taxes)</span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a>houseprice<span class="sc">$</span>group <span class="ot">&lt;-</span> </span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(houseprice<span class="sc">$</span>corner<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;middle&quot;</span>,<span class="st">&quot;corner&quot;</span>)</span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>house_dat<span class="sc">|</span>houseprice<span class="sc">$</span>group,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685c8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>),<span class="at">groups=</span>houseprice<span class="sc">$</span>custom,<span class="at">key=</span><span class="fu">list</span>(<span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;regular&quot;</span>,<span class="st">&quot;custom&quot;</span>)),</span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-174-1.png" width="960" /></p>
<p>그룹에 따른 데이터 탐색을 위해 회귀모형에 사용한 연속형 변수에 대한 산점도 행렬을 그려보았다.<br />
산점도 행렬은 <strong>corner</strong>변수에 따라 구분하였고 <strong>custom</strong>변수에 따라 포인터의 형태와 색깔을 다르게 지정하였다.<br />
<strong>regular</strong>일 때보다, <strong>custom</strong>일 떄 연속형 변수들이 조금 더 높은 값을 가지는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>houseprice.lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> sqft <span class="sc">+</span>taxes, <span class="at">data=</span>houseprice)</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(houseprice.lm1, houseprice.lm2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: price ~ sqft + taxes
## Model 2: price ~ sqft + taxes + custom + corner
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    104 3152660                                  
## 2    102 2687729  2    464931 8.8221 0.0002925 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>기존 모델과 변수를 하나 제거한 모델의 <strong>Anova</strong>를 진행하였다.<br />
분석결과, 유의확률이 유의하게 나온 것을 알 수 있었고 이는 회귀모형간 평균차이가 있다는 것을 의미한다.<br />
즉, <strong>Houseprice</strong>의 회귀모형에서 <strong>custom</strong>변수 유무에따른 평균차이가 존재한 다는 것을 알 수 있다.</p>
</div>
<div id="polynomial-models" class="section level2">
<h2>9.4 Polynomial Models</h2>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hardness)</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>hardness.lin.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(hardness <span class="sc">~</span> density, <span class="at">data=</span>hardness)</span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(hardness.lin.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: hardness
##           Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
## density    1 21345674 21345674  636.98 &lt; 2.2e-16 ***
## Residuals 34  1139366    33511                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>hardness.quad.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(hardness <span class="sc">~</span> density <span class="sc">+</span> <span class="fu">I</span>(density<span class="sc">^</span><span class="dv">2</span>),<span class="at">data=</span>hardness)</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(hardness.quad.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: hardness
##              Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
## density       1 21345674 21345674 815.923 &lt; 2.2e-16 ***
## I(density^2)  1   276041   276041  10.552  0.002669 ** 
## Residuals    33   863325    26161                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary.lm</span>(hardness.quad.lm))</span></code></pre></div>
<pre><code>##                  Estimate Std. Error    t value    Pr(&gt;|t|)
## (Intercept)  -118.0073759 334.966905 -0.3522956 0.726856611
## density         9.4340214  14.935620  0.6316458 0.531969926
## I(density^2)    0.5090775   0.156721  3.2483031 0.002669045</code></pre>
<p><strong>hardness</strong>데이터를 이용하여 1차 회귀식과 2차 회귀식을 비교해보았다.<br />
1차, 2차 회귀식 모두 변수에 따른 평균 차이가 있음을 확인할 수 있었다.<br />
하지만, 계수를 확인해본결과, 절편과 <strong>1차 density</strong>는 유의하지 않은 것을 확인할 수 있다.<br />
여기서의 2차는 단순 2차식이 아닌 <code>I</code>함수를 이용하여 직교 2차를 이용하였다.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">density=</span>hardness<span class="sc">$</span>density, <span class="fu">poly</span>(hardness<span class="sc">$</span>density,<span class="dv">2</span>))</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(X1 <span class="sc">+</span> X2 <span class="sc">~</span> density, <span class="at">data=</span>h2)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-177-1.png" width="960" /></p>
<p>이번에는 <code>poly</code>함수를 이용하여 단순 제곱을 구하여 다시 한 번 분석을 진행해본다.<br />
<strong>density</strong>에 대한 1차식, 2차식을 plot으로 나타내었다.<br />
파란점이 1차식, 빨간점이 2차식의 데이터를 나타낸다.</p>
<hr />
<p><code>regrresidplot</code>함수를 통해 최소제곱법을 이용한 잔차의 계산 과정을 시각화하여 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>SQ <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(hardness<span class="sc">$</span>density, hardness<span class="sc">$</span>hardness, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">85</span>),</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">resid.plot=</span><span class="st">&quot;square&quot;</span>)</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>QU <span class="ot">&lt;-</span> <span class="fu">regrresidplot</span>(hardness<span class="sc">$</span>density, hardness<span class="sc">$</span>hardness, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">85</span>),</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">resid.plot=</span><span class="st">&quot;square&quot;</span>, <span class="at">lm.object=</span>hardness.quad.lm)</span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">c</span>(SQ, QU, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)), <span class="at">xlab=</span><span class="st">&quot;density&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;hardness&quot;</span>,</span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>), <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-178-1.png" width="960" /></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>hardness.quad.orth.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(hardness <span class="sc">~</span> density <span class="sc">+</span> h2<span class="sc">$</span>X2, <span class="at">data=</span>hardness)</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(hardness.quad.orth.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: hardness
##           Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
## density    1 21345674 21345674 815.923 &lt; 2.2e-16 ***
## h2$X2      1   276041   276041  10.552  0.002669 ** 
## Residuals 33   863325    26161                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary.lm</span>(hardness.quad.orth.lm))</span></code></pre></div>
<pre><code>##                Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept) -1160.49970  95.937035 -12.096472 1.125169e-13
## density        57.50667   2.013231  28.564370 7.527551e-25
## h2$X2         525.39610 161.744788   3.248303 2.669045e-03</code></pre>
<p>단순 제곱을 이용하여 분석을 진행한 결과, 변수에 따른 평균적인 차이가 있음을 알 수 있다.<br />
또한, 앞선 분석과 달리 <strong>1차,2차,절편</strong>의 모든 계수가 유의해진 것을 확인할 수 있다.</p>
</div>
<div id="models-without-a-constant-term" class="section level2">
<h2>9.5 Models Without a Constant Term</h2>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(fat)</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="do">## usual model with intercept</span></span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a>xy.int.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bodyfat <span class="sc">~</span> biceps, <span class="at">data=</span>fat)</span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy.int.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bodyfat ~ biceps, data = fat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.5800  -5.4427  -0.8457   5.2551  21.0875 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -20.3644    10.8551  -1.876  0.06715 .  
## biceps        1.1712     0.3261   3.592  0.00081 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.006 on 45 degrees of freedom
## Multiple R-squared:  0.2228, Adjusted R-squared:  0.2055 
## F-statistic:  12.9 on 1 and 45 DF,  p-value: 0.0008096</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(xy.int.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: bodyfat
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## biceps     1  826.8   826.8  12.899 0.0008096 ***
## Residuals 45 2884.4    64.1                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>fat</strong>데이터에 대해서 회귀분석을 진행한 결과, 절편은 유의하지 않고 <strong>biceps</strong>는 유의한 변수임을 확인할 수 있다.<br />
또한, <code>anova</code>분석을 통해 <strong>biceps</strong>에 따라 평균 차이가 있음을 알 수 있다.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(fat)</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="do">## model without a constant term</span></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>xy.noint.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bodyfat <span class="sc">~</span> biceps <span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>fat)</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy.noint.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bodyfat ~ biceps - 1, data = fat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.1101  -6.1446  -0.0065   6.8413  20.1854 
## 
## Coefficients:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## biceps  0.56296    0.03603   15.62   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.222 on 46 degrees of freedom
## Multiple R-squared:  0.8415, Adjusted R-squared:  0.838 
## F-statistic: 244.1 on 1 and 46 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(xy.noint.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: bodyfat
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## biceps     1  16506 16506.2  244.14 &lt; 2.2e-16 ***
## Residuals 46   3110    67.6                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>유의하지 않은 절편을 제거하고 분석을 다시 진행한 결과, 이전 분석보다 회귀모형의 설명력과 유의확률이 더 좋아진 것을 알 수 있다.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xyplot</span>(bodyfat <span class="sc">~</span> biceps, <span class="at">data=</span>fat, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="fu">likertColor</span>(<span class="dv">2</span>)[<span class="dv">2</span>],</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;model&quot;</span>,</span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">space=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;no intercept&quot;</span>)),</span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lines=</span><span class="fu">list</span>(<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>),</span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">border=</span><span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb443-9"><a href="#cb443-9" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.abline</span>(xy.int.lm, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb443-10"><a href="#cb443-10" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.abline</span>(xy.noint.lm, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>))</span>
<span id="cb443-11"><a href="#cb443-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-12"><a href="#cb443-12" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span></span>
<span id="cb443-13"><a href="#cb443-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(A, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">46</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">22</span>,<span class="dv">35</span>)) <span class="sc">+</span></span>
<span id="cb443-14"><a href="#cb443-14" aria-hidden="true" tabindex="-1"></a> latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;gray40&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>))</span>
<span id="cb443-15"><a href="#cb443-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-16"><a href="#cb443-16" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(A, B, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-182-1.png" width="960" /></p>
<p><code>xyplot</code>을 이용하여 앞서 진행한 분석을 시각적으로 나타내었다.</p>
</div>
<div id="prediction" class="section level2">
<h2>9.6 Prediction</h2>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>fat2.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bodyfat <span class="sc">~</span> abdomin <span class="sc">+</span> biceps, <span class="at">data=</span>fat)</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>pi.fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(fat2.lm,</span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">abdomin=</span><span class="dv">93</span><span class="sc">:</span><span class="dv">94</span>,<span class="at">biceps=</span><span class="dv">33</span><span class="sc">:</span><span class="dv">34</span>),</span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se.fit=</span><span class="cn">TRUE</span>, <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a>ci.fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(fat2.lm, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">abdomin=</span><span class="dv">93</span><span class="sc">:</span><span class="dv">94</span>,<span class="at">biceps=</span><span class="dv">33</span><span class="sc">:</span><span class="dv">34</span>),</span>
<span id="cb444-8"><a href="#cb444-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se.fit=</span><span class="cn">TRUE</span>,<span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<p><code>predict``함수를 이용하여 회귀식을 통해 예측을 진행해보았다.</code>interval<code>옵션을 이용하여</code>prediction<code>을 입력하면 예측구간,</code>confidence`를 입력하면 신뢰구간에 대한 정보를 얻을 수 있다.</p>
</div>
<div id="example---longley-data" class="section level2">
<h2>9.7 Example - Longley Data</h2>
<div id="data-description-2" class="section level3">
<h3>9.7.2 Data Description</h3>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(longley)</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>longley)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-184-1.png" width="960" /></p>
<p><strong>longley</strong>함수의 데이터 탐색을 위해 산점도 행렬을 그려보았다.<br />
대부분의 변수간 양의 상관관계가 존재하는 데이터임을 알 수 있다.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>longley.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Employed <span class="sc">~</span>. , <span class="at">data=</span>longley)</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(longley.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ ., data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.41011 -0.15767 -0.02816  0.10155  0.45539 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.482e+03  8.904e+02  -3.911 0.003560 ** 
## GNP.deflator  1.506e-02  8.492e-02   0.177 0.863141    
## GNP          -3.582e-02  3.349e-02  -1.070 0.312681    
## Unemployed   -2.020e-02  4.884e-03  -4.136 0.002535 ** 
## Armed.Forces -1.033e-02  2.143e-03  -4.822 0.000944 ***
## Population   -5.110e-02  2.261e-01  -0.226 0.826212    
## Year          1.829e+00  4.555e-01   4.016 0.003037 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3049 on 9 degrees of freedom
## Multiple R-squared:  0.9955, Adjusted R-squared:  0.9925 
## F-statistic: 330.3 on 6 and 9 DF,  p-value: 4.984e-10</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(longley.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Employed
##              Df  Sum Sq Mean Sq   F value    Pr(&gt;F)    
## GNP.deflator  1 174.397 174.397 1876.5326 9.295e-12 ***
## GNP           1   4.787   4.787   51.5105 5.211e-05 ***
## Unemployed    1   2.264   2.264   24.3605 0.0008071 ***
## Armed.Forces  1   0.876   0.876    9.4301 0.0133357 *  
## Population    1   0.349   0.349    3.7509 0.0847552 .  
## Year          1   1.499   1.499   16.1274 0.0030368 ** 
## Residuals     9   0.836   0.093                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(longley.lm)</span></code></pre></div>
<pre><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
##    135.53244   1788.51348     33.61889      3.58893    399.15102 
##         Year 
##    758.98060</code></pre>
<p><strong>longley</strong>의 모든 변수를 이용하여 회귀분석을 진행하였다.<br />
회귀모형 안에서, <strong>절편,Unemployed,Armed.Forces,Year</strong>의 변수가 유의한 변수임을 확인할 수 있었다.<br />
하지만, <code>vif</code>함수를 이용하여 다중공선성을 검사해본 결과, <strong>Armed.Forces</strong> 변수를 제외한 모든 변수들의 다중공선성이 매우 심각한 것을 확인할 수 있었다.<br />
따라서, 적합한 회귀모형을 찾기 위해서는 적절한 변수 선택이 필요한 것으로 보인다.</p>
</div>
</div>
<div id="variable-selection" class="section level2">
<h2>9.8 Variable Selection</h2>
<div id="manual-use-of-the-stepwise-philosophy" class="section level3">
<h3>9.8.1 Manual Use of the Stepwise Philosophy</h3>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>longley3.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Employed <span class="sc">~</span> GNP.deflator <span class="sc">+</span> GNP <span class="sc">+</span> Unemployed <span class="sc">+</span> Armed.Forces <span class="sc">+</span> Year, <span class="at">data=</span>longley)</span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(longley3.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ GNP.deflator + GNP + Unemployed + Armed.Forces + 
##     Year, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.39012 -0.14342 -0.03560  0.09728  0.46136 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.565e+03  7.724e+02  -4.615 0.000957 ***
## GNP.deflator  2.772e-02  6.075e-02   0.456 0.657984    
## GNP          -4.213e-02  1.762e-02  -2.391 0.037891 *  
## Unemployed   -2.104e-02  3.029e-03  -6.945 3.97e-05 ***
## Armed.Forces -1.042e-02  2.002e-03  -5.207 0.000397 ***
## Year          1.869e+00  3.994e-01   4.680 0.000867 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.29 on 10 degrees of freedom
## Multiple R-squared:  0.9955, Adjusted R-squared:  0.9932 
## F-statistic: 437.9 on 5 and 10 DF,  p-value: 2.266e-11</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(longley3.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Employed
##              Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## GNP.deflator  1 174.397 174.397 2073.265 6.284e-13 ***
## GNP           1   4.787   4.787   56.911 1.962e-05 ***
## Unemployed    1   2.264   2.264   26.915 0.0004084 ***
## Armed.Forces  1   0.876   0.876   10.419 0.0090545 ** 
## Year          1   1.843   1.843   21.906 0.0008670 ***
## Residuals    10   0.841   0.084                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(longley3.lm)</span></code></pre></div>
<pre><code>## GNP.deflator          GNP   Unemployed Armed.Forces         Year 
##    76.641401   546.870494    14.289620     3.460846   644.626426</code></pre>
<p><strong>Population</strong> 변수를 제거한 후, 다시 한 번 다중공선성 검사를 진행해본 결과, 여전히 <strong>Armed.Forces</strong> 변수를 제외한 변수에서 다중공선성이 있는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>longley4.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Employed <span class="sc">~</span> GNP <span class="sc">+</span> Unemployed <span class="sc">+</span> Armed.Forces <span class="sc">+</span> Year, <span class="at">data=</span>longley)</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(longley4.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ GNP + Unemployed + Armed.Forces + Year, 
##     data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.42165 -0.12457 -0.02416  0.08369  0.45268 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.599e+03  7.406e+02  -4.859 0.000503 ***
## GNP          -4.019e-02  1.647e-02  -2.440 0.032833 *  
## Unemployed   -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
## Armed.Forces -1.015e-02  1.837e-03  -5.522 0.000180 ***
## Year          1.887e+00  3.828e-01   4.931 0.000449 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2794 on 11 degrees of freedom
## Multiple R-squared:  0.9954, Adjusted R-squared:  0.9937 
## F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(longley4.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Employed
##              Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## GNP           1 178.973 178.973 2292.704 4.042e-14 ***
## Unemployed    1   2.457   2.457   31.476 0.0001579 ***
## Armed.Forces  1   0.822   0.822   10.535 0.0077944 ** 
## Year          1   1.898   1.898   24.314 0.0004490 ***
## Residuals    11   0.859   0.078                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(longley4.lm)</span></code></pre></div>
<pre><code>##          GNP   Unemployed Armed.Forces         Year 
##   515.123851    14.108642     3.141581   638.128041</code></pre>
<p><strong>GNP.deflator</strong> 변수를 제거한 후에도 <strong>Armed.Forces</strong>변수를 제외한 변수들은 여전히 다중공선성이 있는 것처럼 보인다.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>longley5.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Employed <span class="sc">~</span> Unemployed <span class="sc">+</span> Armed.Forces <span class="sc">+</span> Year, <span class="at">data=</span>longley)</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(longley5.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ Unemployed + Armed.Forces + Year, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57285 -0.11989  0.04087  0.13979  0.75303 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.797e+03  6.864e+01 -26.183 5.89e-12 ***
## Unemployed   -1.470e-02  1.671e-03  -8.793 1.41e-06 ***
## Armed.Forces -7.723e-03  1.837e-03  -4.204  0.00122 ** 
## Year          9.564e-01  3.553e-02  26.921 4.24e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3321 on 12 degrees of freedom
## Multiple R-squared:  0.9928, Adjusted R-squared:  0.9911 
## F-statistic: 555.2 on 3 and 12 DF,  p-value: 3.916e-13</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(longley5.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Employed
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Unemployed    1 46.716  46.716  423.61 9.977e-11 ***
## Armed.Forces  1 57.043  57.043  517.25 3.095e-11 ***
## Year          1 79.927  79.927  724.76 4.241e-12 ***
## Residuals    12  1.323   0.110                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(longley5.lm)</span></code></pre></div>
<pre><code>##   Unemployed Armed.Forces         Year 
##     3.317929     2.223317     3.890861</code></pre>
<p><strong>vif</strong>지수가 제일 높은 <strong>GNP</strong> 변수를 제거한 결과, 남은 3개의 변수 모두 다중공선성이 없는 것을 확인할 수 있었다.</p>
</div>
<div id="automated-stepwise-modeling-of-the-longley-data" class="section level3">
<h3>9.8.2 Automated Stepwise Modeling of the Longley Data</h3>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>longley.subsets <span class="ot">&lt;-</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>  leaps<span class="sc">::</span><span class="fu">regsubsets</span>(Employed <span class="sc">~</span> GNP.deflator <span class="sc">+</span> GNP <span class="sc">+</span> Unemployed <span class="sc">+</span> Armed.Forces <span class="sc">+</span> Population <span class="sc">+</span> Year,</span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>longley, <span class="at">nbest=</span><span class="dv">2</span>)</span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>longley.subsets.Summary <span class="ot">&lt;-</span> <span class="fu">summaryHH</span>(longley.subsets)</span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true" tabindex="-1"></a>longley.subsets.Summary</span></code></pre></div>
<pre><code>##               model p   rsq    rss adjr2     cp   bic stderr
## 1               GNP 2 0.967  6.036 0.965  52.95 -49.2  0.657
## 2                 Y 2 0.943 10.457 0.939 100.51 -40.4  0.864
## 3               U-Y 3 0.982  3.272 0.980  25.21 -56.2  0.502
## 4             GNP-U 3 0.981  3.579 0.978  28.51 -54.8  0.525
## 5             U-A-Y 4 0.993  1.323 0.991   6.24 -68.0  0.332
## 6           GNP-U-A 4 0.985  2.757 0.981  21.66 -56.2  0.479
## 7         GNP-U-A-Y 5 0.995  0.859 0.994   3.24 -72.1  0.279
## 8           U-A-P-Y 5 0.995  0.986 0.993   4.61 -69.9  0.299
## 9       GNP-U-A-P-Y 6 0.995  0.839 0.993   5.03 -69.7  0.290
## 10   GNP.-GNP-U-A-Y 6 0.995  0.841 0.993   5.05 -69.7  0.290
## 11 GNP.-GNP-U-A-P-Y 7 0.995  0.836 0.992   7.00 -67.0  0.305
## 
## Model variables with abbreviations
##                                                                     model
## GNP                                                                   GNP
## Y                                                                    Year
## U-Y                                                       Unemployed-Year
## GNP-U                                                      GNP-Unemployed
## U-A-Y                                        Unemployed-Armed.Forces-Year
## GNP-U-A                                       GNP-Unemployed-Armed.Forces
## GNP-U-A-Y                                GNP-Unemployed-Armed.Forces-Year
## U-A-P-Y                           Unemployed-Armed.Forces-Population-Year
## GNP-U-A-P-Y                   GNP-Unemployed-Armed.Forces-Population-Year
## GNP.-GNP-U-A-Y              GNP.deflator-GNP-Unemployed-Armed.Forces-Year
## GNP.-GNP-U-A-P-Y GNP.deflator-GNP-Unemployed-Armed.Forces-Population-Year
## 
## model with largest adjr2
## 7 
## 
## Number of observations
## 16</code></pre>
<p><code>summaryHH</code>함수를 이용하여 변수선택에 따른 회귀모형의 성능지표 변화를 확인할 수 있다.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> (longley.subsets.Summary<span class="sc">$</span>cp <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a>longley.subsets.Summary[tmp,]</span></code></pre></div>
<pre><code>##               model p   rsq   rss adjr2   cp   bic stderr
## 5             U-A-Y 4 0.993 1.323 0.991 6.24 -68.0  0.332
## 7         GNP-U-A-Y 5 0.995 0.859 0.994 3.24 -72.1  0.279
## 8           U-A-P-Y 5 0.995 0.986 0.993 4.61 -69.9  0.299
## 9       GNP-U-A-P-Y 6 0.995 0.839 0.993 5.03 -69.7  0.290
## 10   GNP.-GNP-U-A-Y 6 0.995 0.841 0.993 5.05 -69.7  0.290
## 11 GNP.-GNP-U-A-P-Y 7 0.995 0.836 0.992 7.00 -67.0  0.305
## 
## Model variables with abbreviations
##                                                                     model
## GNP                                                                   GNP
## Y                                                                    Year
## U-Y                                                       Unemployed-Year
## GNP-U                                                      GNP-Unemployed
## U-A-Y                                        Unemployed-Armed.Forces-Year
## GNP-U-A                                       GNP-Unemployed-Armed.Forces
## GNP-U-A-Y                                GNP-Unemployed-Armed.Forces-Year
## U-A-P-Y                           Unemployed-Armed.Forces-Population-Year
## GNP-U-A-P-Y                   GNP-Unemployed-Armed.Forces-Population-Year
## GNP.-GNP-U-A-Y              GNP.deflator-GNP-Unemployed-Armed.Forces-Year
## GNP.-GNP-U-A-P-Y GNP.deflator-GNP-Unemployed-Armed.Forces-Population-Year
## 
## model with largest adjr2
## 7 
## 
## Number of observations
## 16</code></pre>
<p>선별된 변수들 중, <strong>cp</strong>지수가 10보다 작은 변수선택 방법들만을 추출하였다.</p>
</div>
</div>
<div id="example---u.s.air-pollution-data" class="section level2">
<h2>9.9 Example - U.S.Air Pollution Data</h2>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(usair)</span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>usair)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-191-1.png" width="960" /></p>
<p><strong>usair</strong>변수에 대한 데이터 탐색을 진행하기 위해 <code>splom</code>을 이용하여 산점도 행렬을 나타내었다.<br />
변환을 통해 몇몇 변수에 대하여 데이터를 조금 더 퍼뜨릴 필요성이 있어 보인다.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a>usair<span class="sc">$</span>lnSO2 <span class="ot">&lt;-</span> <span class="fu">log</span>(usair<span class="sc">$</span>SO2)</span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a>usair<span class="sc">$</span>lnmfg <span class="ot">&lt;-</span> <span class="fu">log</span>(usair<span class="sc">$</span>mfgfirms)</span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>usair<span class="sc">$</span>lnpopn <span class="ot">&lt;-</span> <span class="fu">log</span>(usair<span class="sc">$</span>popn)</span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a>usair_tansform <span class="ot">&lt;-</span> usair <span class="sc">%&gt;%</span> </span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SO2,<span class="sc">-</span>mfgfirms,popn)</span></code></pre></div>
<p>변환이 필요한 변수들에 <strong>log</strong>변환을 진행하여 데이터를 조금 더 퍼뜨려주었다.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>usair_tansform)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-193-1.png" width="960" /></p>
<p>앞서 변환을 진행하기 전 산점도 행렬보다 상관관계가 보이는 변수들을 확인할 수 있다.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>usair.regsubset <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(lnSO2 <span class="sc">~</span> lnmfg<span class="sc">+</span> lnpopn <span class="sc">+</span> precip <span class="sc">+</span> raindays <span class="sc">+</span> temp <span class="sc">+</span> wind, <span class="at">data=</span>usair_tansform, <span class="at">nbest=</span><span class="dv">2</span>)</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>usair.subsets.Summary <span class="ot">&lt;-</span> <span class="fu">summaryHH</span>(usair.regsubset)</span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> (usair.subsets.Summary<span class="sc">$</span>cp <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb477-6"><a href="#cb477-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-7"><a href="#cb477-7" aria-hidden="true" tabindex="-1"></a>usair.subsets.Summary[tmp,]</span></code></pre></div>
<pre><code>##              model p   rsq   rss adjr2   cp    bic stderr
## 5          lnm-t-w 4 0.456 10.74 0.412 8.15 -10.09  0.539
## 6            p-t-w 4 0.446 10.94 0.401 8.93  -9.33  0.544
## 7        lnm-p-t-w 5 0.543  9.02 0.492 3.58 -13.51  0.501
## 8        lnm-r-t-w 5 0.513  9.61 0.459 5.82 -10.93  0.517
## 9    lnm-lnp-p-t-w 6 0.550  8.88 0.486 5.03 -10.46  0.504
## 10     lnm-p-r-t-w 6 0.543  9.02 0.477 5.58  -9.80  0.508
## 11 lnm-lnp-p-r-t-w 7 0.550  8.87 0.471 7.00  -6.78  0.511
## 
## Model variables with abbreviations
##                                                  model
## t                                                 temp
## r                                             raindays
## p-t                                        precip-temp
## r-t                                      raindays-temp
## lnm-t-w                                lnmfg-temp-wind
## p-t-w                                 precip-temp-wind
## lnm-p-t-w                       lnmfg-precip-temp-wind
## lnm-r-t-w                     lnmfg-raindays-temp-wind
## lnm-lnp-p-t-w            lnmfg-lnpopn-precip-temp-wind
## lnm-p-r-t-w            lnmfg-precip-raindays-temp-wind
## lnm-lnp-p-r-t-w lnmfg-lnpopn-precip-raindays-temp-wind
## 
## model with largest adjr2
## 7 
## 
## Number of observations
## 41</code></pre>
<p><code>summaryHH</code>를 이용하여 <strong>usair</strong> 데이터에 대하여여 자동적으로 변수선택을 진행하고 그에 따른 회귀 성능지표의 변화를 살펴보았다.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(usair.subsets.Summary[tmp,], <span class="at">statistic=</span><span class="st">&#39;cp&#39;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-195-1.png" width="960" /></p>
<p><strong>cp</strong>와 <strong>Number of paramter</strong>의 관계를 산점도로 나타내었다.</p>
</div>
<div id="example---mtcars-data" class="section level2">
<h2>9.10 Example - mtcars data</h2>
<p>지금까지 배운 내용들을 토대로 mtcars 데이터를 통해 <strong>multiple regression</strong>을 적합시켜 보자.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3
##                   carb
## Mazda RX4            4
## Mazda RX4 Wag        4
## Datsun 710           1
## Hornet 4 Drive       1
## Hornet Sportabout    2</code></pre>
<p>mtcars의 데이터 변수들의 형태와 대략적인 구조를 살펴본다.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mtcars)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-198-1.png" width="960" /></p>
<p><code>pairs</code>함수를 이용해 변수들의 관계를 살펴보기 위해 다중산점도 행렬을 그려보았다.<br />
우리가 target변수로 설정한 mpg와 다른 독립변수들은 양의 상관관계 혹은 음의 상관관계를 갖고있는 것 처럼 보인다.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(mtcars))</span></code></pre></div>
<pre><code>##  mpg  cyl disp   hp drat   wt qsec   vs   am gear carb 
##    0    0    0    0    0    0    0    0    0    0    0</code></pre>
<p><code>colSums</code>를 이용하여 결측치 검정을 진행한 결과, 데이터의 결측치는 확인되지 않았다.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a>mr <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg<span class="sc">~</span>.,<span class="at">data=</span>mtcars)</span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ ., data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4506 -1.6044 -0.1196  1.2193  4.6271 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 12.30337   18.71788   0.657   0.5181  
## cyl         -0.11144    1.04502  -0.107   0.9161  
## disp         0.01334    0.01786   0.747   0.4635  
## hp          -0.02148    0.02177  -0.987   0.3350  
## drat         0.78711    1.63537   0.481   0.6353  
## wt          -3.71530    1.89441  -1.961   0.0633 .
## qsec         0.82104    0.73084   1.123   0.2739  
## vs           0.31776    2.10451   0.151   0.8814  
## am           2.52023    2.05665   1.225   0.2340  
## gear         0.65541    1.49326   0.439   0.6652  
## carb        -0.19942    0.82875  -0.241   0.8122  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.65 on 21 degrees of freedom
## Multiple R-squared:  0.869,  Adjusted R-squared:  0.8066 
## F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## Warning: package &#39;car&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DescTools&#39;:
## 
##     Recode</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following objects are masked from &#39;package:HH&#39;:
## 
##     logit, vif</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mr)</span></code></pre></div>
<pre><code>##       cyl      disp        hp      drat        wt      qsec 
## 15.373833 21.620241  9.832037  3.374620 15.164887  7.527958 
##        vs        am      gear      carb 
##  4.965873  4.648487  5.357452  7.908747</code></pre>
<p>mtcars 데이터를 이용하여 다중회귀분석을 진행해보았다. 모형은 유의하고 적합도는 약 80%로 나온것을 확인할 수 있었다. 하지만, 대부분의 변수들의 유의확률보다 높아 유의하지 않았고 다중공선성이 존재하는 변수가 있는 것을 확인할 수 있었다.<br />
따라서, 변수선택법을 진행하여 최적의 변수들을 찾아볼 필요가 있다고 판단하였다.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(mr,<span class="at">direction=</span><span class="st">&quot;forward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=70.9
## mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ cyl + disp + hp + drat + wt + qsec + vs + 
##     am + gear + carb, data = mtcars)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711  
##          wt         qsec           vs           am         gear  
##    -3.71530      0.82104      0.31776      2.52023      0.65541  
##        carb  
##    -0.19942</code></pre>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> disp <span class="sc">+</span> hp <span class="sc">+</span> drat <span class="sc">+</span> wt <span class="sc">+</span> qsec <span class="sc">+</span> vs <span class="sc">+</span> am <span class="sc">+</span> gear <span class="sc">+</span> carb,<span class="at">data=</span>mtcars))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ cyl + disp + hp + drat + wt + qsec + vs + 
##     am + gear + carb, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4506 -1.6044 -0.1196  1.2193  4.6271 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 12.30337   18.71788   0.657   0.5181  
## cyl         -0.11144    1.04502  -0.107   0.9161  
## disp         0.01334    0.01786   0.747   0.4635  
## hp          -0.02148    0.02177  -0.987   0.3350  
## drat         0.78711    1.63537   0.481   0.6353  
## wt          -3.71530    1.89441  -1.961   0.0633 .
## qsec         0.82104    0.73084   1.123   0.2739  
## vs           0.31776    2.10451   0.151   0.8814  
## am           2.52023    2.05665   1.225   0.2340  
## gear         0.65541    1.49326   0.439   0.6652  
## carb        -0.19942    0.82875  -0.241   0.8122  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.65 on 21 degrees of freedom
## Multiple R-squared:  0.869,  Adjusted R-squared:  0.8066 
## F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
<p><strong>전진선택법</strong>을 이용하여 변수선택을 진행해본 결과, 모든 변수를 선택하는 것이 적합하다고 나왔다.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(mr,<span class="at">direction=</span><span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=70.9
## mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - cyl   1    0.0799 147.57 68.915
## - vs    1    0.1601 147.66 68.932
## - carb  1    0.4067 147.90 68.986
## - gear  1    1.3531 148.85 69.190
## - drat  1    1.6270 149.12 69.249
## - disp  1    3.9167 151.41 69.736
## - hp    1    6.8399 154.33 70.348
## - qsec  1    8.8641 156.36 70.765
## &lt;none&gt;              147.49 70.898
## - am    1   10.5467 158.04 71.108
## - wt    1   27.0144 174.51 74.280
## 
## Step:  AIC=68.92
## mpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - vs    1    0.2685 147.84 66.973
## - carb  1    0.5201 148.09 67.028
## - gear  1    1.8211 149.40 67.308
## - drat  1    1.9826 149.56 67.342
## - disp  1    3.9009 151.47 67.750
## - hp    1    7.3632 154.94 68.473
## &lt;none&gt;              147.57 68.915
## - qsec  1   10.0933 157.67 69.032
## - am    1   11.8359 159.41 69.384
## - wt    1   27.0280 174.60 72.297
## 
## Step:  AIC=66.97
## mpg ~ disp + hp + drat + wt + qsec + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - carb  1    0.6855 148.53 65.121
## - gear  1    2.1437 149.99 65.434
## - drat  1    2.2139 150.06 65.449
## - disp  1    3.6467 151.49 65.753
## - hp    1    7.1060 154.95 66.475
## &lt;none&gt;              147.84 66.973
## - am    1   11.5694 159.41 67.384
## - qsec  1   15.6830 163.53 68.200
## - wt    1   27.3799 175.22 70.410
## 
## Step:  AIC=65.12
## mpg ~ disp + hp + drat + wt + qsec + am + gear
## 
##        Df Sum of Sq    RSS    AIC
## - gear  1     1.565 150.09 63.457
## - drat  1     1.932 150.46 63.535
## &lt;none&gt;              148.53 65.121
## - disp  1    10.110 158.64 65.229
## - am    1    12.323 160.85 65.672
## - hp    1    14.826 163.35 66.166
## - qsec  1    26.408 174.94 68.358
## - wt    1    69.127 217.66 75.350
## 
## Step:  AIC=63.46
## mpg ~ disp + hp + drat + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - drat  1     3.345 153.44 62.162
## - disp  1     8.545 158.64 63.229
## &lt;none&gt;              150.09 63.457
## - hp    1    13.285 163.38 64.171
## - am    1    20.036 170.13 65.466
## - qsec  1    25.574 175.67 66.491
## - wt    1    67.572 217.66 73.351
## 
## Step:  AIC=62.16
## mpg ~ disp + hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - disp  1     6.629 160.07 61.515
## &lt;none&gt;              153.44 62.162
## - hp    1    12.572 166.01 62.682
## - qsec  1    26.470 179.91 65.255
## - am    1    32.198 185.63 66.258
## - wt    1    69.043 222.48 72.051
## 
## Step:  AIC=61.52
## mpg ~ hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - hp    1     9.219 169.29 61.307
## &lt;none&gt;              160.07 61.515
## - qsec  1    20.225 180.29 63.323
## - am    1    25.993 186.06 64.331
## - wt    1    78.494 238.56 72.284
## 
## Step:  AIC=61.31
## mpg ~ wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;              169.29 61.307
## - am    1    26.178 195.46 63.908
## - qsec  1   109.034 278.32 75.217
## - wt    1   183.347 352.63 82.790</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt         qsec           am  
##       9.618       -3.917        1.226        2.936</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> wt <span class="sc">+</span> qsec <span class="sc">+</span> am, <span class="at">data =</span> mtcars))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4811 -1.5555 -0.7257  1.4110  4.6610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.6178     6.9596   1.382 0.177915    
## wt           -3.9165     0.7112  -5.507 6.95e-06 ***
## qsec          1.2259     0.2887   4.247 0.000216 ***
## am            2.9358     1.4109   2.081 0.046716 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.459 on 28 degrees of freedom
## Multiple R-squared:  0.8497, Adjusted R-squared:  0.8336 
## F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> wt <span class="sc">+</span> qsec <span class="sc">+</span> am, <span class="at">data =</span> mtcars))</span></code></pre></div>
<pre><code>##       wt     qsec       am 
## 2.482952 1.364339 2.541437</code></pre>
<p><strong>후진제거법</strong>을 사용하여 변수선택을 진행한결과, <strong>wt,qsec,am</strong>변수가 선택되었고 이 변수들을 회귀모형에 적합시킨 결과, 모든 변수가 유의하고 결정계수 또한 이전보다 높아진 것을 확인할 수 있었다.<br />
또한, 다중공선성이 존재하는 변수들도 사라진 것을 알 수 있었다.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(mr,<span class="at">direction=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=70.9
## mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - cyl   1    0.0799 147.57 68.915
## - vs    1    0.1601 147.66 68.932
## - carb  1    0.4067 147.90 68.986
## - gear  1    1.3531 148.85 69.190
## - drat  1    1.6270 149.12 69.249
## - disp  1    3.9167 151.41 69.736
## - hp    1    6.8399 154.33 70.348
## - qsec  1    8.8641 156.36 70.765
## &lt;none&gt;              147.49 70.898
## - am    1   10.5467 158.04 71.108
## - wt    1   27.0144 174.51 74.280
## 
## Step:  AIC=68.92
## mpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - vs    1    0.2685 147.84 66.973
## - carb  1    0.5201 148.09 67.028
## - gear  1    1.8211 149.40 67.308
## - drat  1    1.9826 149.56 67.342
## - disp  1    3.9009 151.47 67.750
## - hp    1    7.3632 154.94 68.473
## &lt;none&gt;              147.57 68.915
## - qsec  1   10.0933 157.67 69.032
## - am    1   11.8359 159.41 69.384
## + cyl   1    0.0799 147.49 70.898
## - wt    1   27.0280 174.60 72.297
## 
## Step:  AIC=66.97
## mpg ~ disp + hp + drat + wt + qsec + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - carb  1    0.6855 148.53 65.121
## - gear  1    2.1437 149.99 65.434
## - drat  1    2.2139 150.06 65.449
## - disp  1    3.6467 151.49 65.753
## - hp    1    7.1060 154.95 66.475
## &lt;none&gt;              147.84 66.973
## - am    1   11.5694 159.41 67.384
## - qsec  1   15.6830 163.53 68.200
## + vs    1    0.2685 147.57 68.915
## + cyl   1    0.1883 147.66 68.932
## - wt    1   27.3799 175.22 70.410
## 
## Step:  AIC=65.12
## mpg ~ disp + hp + drat + wt + qsec + am + gear
## 
##        Df Sum of Sq    RSS    AIC
## - gear  1     1.565 150.09 63.457
## - drat  1     1.932 150.46 63.535
## &lt;none&gt;              148.53 65.121
## - disp  1    10.110 158.64 65.229
## - am    1    12.323 160.85 65.672
## - hp    1    14.826 163.35 66.166
## + carb  1     0.685 147.84 66.973
## + vs    1     0.434 148.09 67.028
## + cyl   1     0.414 148.11 67.032
## - qsec  1    26.408 174.94 68.358
## - wt    1    69.127 217.66 75.350
## 
## Step:  AIC=63.46
## mpg ~ disp + hp + drat + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - drat  1     3.345 153.44 62.162
## - disp  1     8.545 158.64 63.229
## &lt;none&gt;              150.09 63.457
## - hp    1    13.285 163.38 64.171
## + gear  1     1.565 148.53 65.121
## + cyl   1     1.003 149.09 65.242
## + vs    1     0.645 149.45 65.319
## + carb  1     0.107 149.99 65.434
## - am    1    20.036 170.13 65.466
## - qsec  1    25.574 175.67 66.491
## - wt    1    67.572 217.66 73.351
## 
## Step:  AIC=62.16
## mpg ~ disp + hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - disp  1     6.629 160.07 61.515
## &lt;none&gt;              153.44 62.162
## - hp    1    12.572 166.01 62.682
## + drat  1     3.345 150.09 63.457
## + gear  1     2.977 150.46 63.535
## + cyl   1     2.447 150.99 63.648
## + vs    1     1.121 152.32 63.927
## + carb  1     0.011 153.43 64.160
## - qsec  1    26.470 179.91 65.255
## - am    1    32.198 185.63 66.258
## - wt    1    69.043 222.48 72.051
## 
## Step:  AIC=61.52
## mpg ~ hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - hp    1     9.219 169.29 61.307
## &lt;none&gt;              160.07 61.515
## + disp  1     6.629 153.44 62.162
## + carb  1     3.227 156.84 62.864
## + drat  1     1.428 158.64 63.229
## - qsec  1    20.225 180.29 63.323
## + cyl   1     0.249 159.82 63.465
## + vs    1     0.249 159.82 63.466
## + gear  1     0.171 159.90 63.481
## - am    1    25.993 186.06 64.331
## - wt    1    78.494 238.56 72.284
## 
## Step:  AIC=61.31
## mpg ~ wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;              169.29 61.307
## + hp    1     9.219 160.07 61.515
## + carb  1     8.036 161.25 61.751
## + disp  1     3.276 166.01 62.682
## + cyl   1     1.501 167.78 63.022
## + drat  1     1.400 167.89 63.042
## + gear  1     0.123 169.16 63.284
## + vs    1     0.000 169.29 63.307
## - am    1    26.178 195.46 63.908
## - qsec  1   109.034 278.32 75.217
## - wt    1   183.347 352.63 82.790</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt         qsec           am  
##       9.618       -3.917        1.226        2.936</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> wt <span class="sc">+</span> qsec <span class="sc">+</span> am, <span class="at">data =</span> mtcars))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4811 -1.5555 -0.7257  1.4110  4.6610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.6178     6.9596   1.382 0.177915    
## wt           -3.9165     0.7112  -5.507 6.95e-06 ***
## qsec          1.2259     0.2887   4.247 0.000216 ***
## am            2.9358     1.4109   2.081 0.046716 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.459 on 28 degrees of freedom
## Multiple R-squared:  0.8497, Adjusted R-squared:  0.8336 
## F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11</code></pre>
<p><strong>stepwise</strong>방법을 이용하여 변수 선택을 진행한결과, 후진제거법과 동일한 변수선택이 나왔다.<br />
이를 통해, 변수선택법을 이용함에 있어서는 <strong>wt,qsec,am</strong>변수를 통해 회귀모형을 만드는 것이 최적의 회귀모형임을 알 수 있었다.</p>
<hr />
</div>
<div id="summary-of-chapter9" class="section level2">
<h2>Summary of Chapter9</h2>
<ul>
<li><p><strong>다중회귀분석(Multiple Regression)</strong>은 단순회귀분석과 달리, 독립변수가 두 개 이상인 회귀분석을 말한다. 독립변수가 하나가 아닌 두 개이상 사용되기 때문에 적절한 변수를 선택하고 변수마다 확실하게 이해를 하고 회귀모형에 적합하는 것이 좋다.</p></li>
<li><p>변수들을 다중회귀모형에 적합하기 전, 가장 좋은 방법 중 하나는 산점도 행렬을 통해 변수들간의 관계를 살펴보는 것이다. <strong>산점도 행렬</strong>은 변수 간 산점도를 행렬과 같이 한 공간안에 모두 나타내는 것을 말한다. <strong>산점도 행렬</strong>을 보게 되면, 변수들의 관계를 시각적으로 쉽게 파악할 수 있다.</p></li>
<li><p><strong>다중회귀분석</strong>은 많은 변수들을 고려하기 때문에 변수들 안에서 강한 상관관계가 나타날 수 있다. <strong>다중공선성</strong>은 독립변수들 간에 강한 상관관계가 나타나는 문제를 말하며, 이는 공분산을 높이게 되어 회귀모형의 적합도를 낮출 수도 있다. 따라서, 항상 다중회귀분석을 진행하기 전에, 독립변수 간 다중공선성을 파악하는 것이 필요하다.</p></li>
<li><p>고려해야할 변수가 너무 많은 경우, <strong>변수선택법</strong>을 고려할 수 있다. <strong>변수선택법</strong>은 모형을 보다 더 잘 설명하는 변수들만을 골라서 최적의 회귀모형을 만드는 것을 말한다. <strong>변수선택법</strong>은 일반적으로 3가지의 선택법이 있다.</p></li>
<li><p>첫 번째는 <strong>전진선택법</strong>으로 변수의 개수를 하나씩 늘려나가면서 최적의 회귀모형을 찾아나가는 방법이다. 두 번째는 <strong>후진제거법</strong>으로 전체 변수를 모형에 적합시킨 뒤, 변수를 하나씩 제거해가며 최적의 회귀모형을 찾아나가는 방법이다. 마지막으로 <strong>단계적선택법</strong>은 변수를 하나씩 늘려가다가 중요하지 않은 변수가 선택되면 제거하고 다시 다른 변수를 추가하는 식으로 진행되는 방법이다. 일반적으로는 <strong>단계적선택법(Stepwise)</strong>방법을 많이 사용하지만, 모형의 목적과 데이터에 따라 적절한 변수선택법이 다를 수도 있으니 모든 방법을 고려해보는 것이 좋다.</p></li>
<li><p>R에서 다중공선성은 <code>car</code>패키지의 <code>vif</code>함수를 통해 쉽게 확인할 수 있다. <strong>vif</strong>는 분산팽창요인이라고 말하며, 10이 넘는 경우 다중공선성이 있다고 말한다. 따라서, 다중공선성이 의심된다면 10이 넘는 변수들 중, 값이 큰 변수들부터 제거하여 회귀모형에 적합시키는 것이 좋다.</p></li>
<li><p>앞서, 단순회귀분석에서 우리는 회귀모형의 적합도를 파악하는데 결정계수를 사용하였다. 다중회귀분석의 적합도를 살펴볼 때에는 이러한 결정계수를 통해 적합도를 확인해서는 안 된다. 왜냐하면, 결정계수는 독립변수의 수가 늘어날수록 커지는 경향이 있기때문에 다중회귀분석에서는 적합도 측정 지표로 적합하지 않다. 따라서, 다중회귀분석에서는 결정계수가 아닌 수정된 결정계수, cp, BIC 등 다른 지표를 통해 적합도를 살펴보는 것이 좋다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap10-multiple-regression---dummy-variablescontrastsand-analysis-of-covariacne" class="section level1">
<h1>Chap10 Multiple Regression - Dummy Variables,Contrasts,and Analysis of Covariacne</h1>
<p>이번 챕터에서는 앞서 살펴본 다중회귀분석과 더불어 <strong>더미 변수</strong>와 <strong>대조</strong>에 대해 알아보도록 한다.</p>
<p><strong>더미 변수(Dummy variable)</strong>은 질적인 특성을 갖고있는 독립변수들을 통합하는 것을 말한다. 예를 들어, A,B,C 3개의 변수를 가지고 있다고 가정하고 이에 대한 더미 변수화를 지정하게 되면, A =(1,0,0), B=(0,1,0), C=(0,0,1)와 같은 식으로 표현될 수 있다.</p>
<p>또한, 분산분석의 개념과 회귀분석의 개념이 혼합된 <strong>공분산분석(Analysiss of Covariance)</strong>에 대해서도 알아보자.</p>
<div id="example-height-and-weight" class="section level2">
<h2>10.1 Example-Height and Weight</h2>
<div id="data-description-3" class="section level3">
<h3>10.1.1 Data Description</h3>
<ul>
<li>feet: 정수로 반올림한 피트 단위의 높이</li>
<li>inches: 인치단위의 높이</li>
<li>months: 월 단위로 표혀한 나이</li>
<li>lbs: 파운드 단위의 몸무게</li>
<li>sex: 남성 혹은 여성</li>
<li>meters: 미터단위의 높이</li>
</ul>
</div>
<div id="data-problems" class="section level3">
<h3>10.1.2 Data Problems</h3>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(htwt)</span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">factor</span>(htwt<span class="sc">$</span>sex,<span class="at">exclude=</span><span class="cn">NULL</span>))</span></code></pre></div>
<pre><code>## [1] &quot;f&quot; &quot;m&quot; NA</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(htwt<span class="sc">$</span>ht))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><code>any</code>함수를 이용해 <em>ht</em>변수 안에 결측값이 있는지 확인한다.<br />
확인결과, TRUE를 반환하여 결측값이 있는 것으로 보인다.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (h <span class="cf">in</span> <span class="fu">tapply</span>(htwt<span class="sc">$</span>ht,<span class="fu">factor</span>(htwt<span class="sc">$</span>sex,<span class="at">exclude =</span> <span class="cn">NULL</span>),c)){</span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stem</span>(h,<span class="at">scal=</span><span class="fl">1.5</span>)</span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
##   The decimal point is at the |
## 
##   58 | 0
##   60 | 
##   62 | 00000
##   64 | 000000000
##   66 | 000008
##   68 | 0
## 
## 
##   The decimal point is at the |
## 
##   62 | 0
##   64 | 0
##   66 | 000
##   68 | 00
##   70 | 
##   72 | 000000
##   74 | 00</code></pre>
<p><em>ht</em>변수를 성별에 따라 <code>stem</code>함수를 이용하여 줄기 잎 그림 으로 표현하였다.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>df_htwt <span class="ot">&lt;-</span> htwt <span class="sc">%&gt;%</span> </span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;lbs&quot;</span>,<span class="st">&quot;months&quot;</span>,<span class="st">&quot;sex&quot;</span>,<span class="st">&quot;ht&quot;</span>)</span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>df_htwt,<span class="at">groups=</span>df_htwt<span class="sc">$</span>sex,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">19</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685c8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>),<span class="at">key=</span><span class="fu">list</span>(<span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>)),</span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">19</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-211-1.png" width="960" /></p>
<p>데이터 탐색을 위해 성별을 그룹으로 지정하고 <code>splom</code>함수를 사용하여 산점도 행렬을 그린 후, 변수 간 관계를 살펴보았다.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(lbs<span class="sc">~</span>ht,<span class="at">data=</span>htwt,<span class="at">groups=</span>sex,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">19</span>),</span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685c8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>),</span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">key=</span><span class="fu">list</span>(<span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>)),</span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">19</span>),</span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E16A92&quot;</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-212-1.png" width="960" /></p>
<p>성별에 따른 ht변수와 lbs변수의 산점도를 그려보았다.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="do">## one-wway analysis of variance</span></span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a>htwt.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(ht <span class="sc">~</span> sex,<span class="at">data=</span>htwt)</span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(htwt.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## sex          1  237.2   237.2   26.66 9.78e-06 ***
## Residuals   35  311.3     8.9                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 2 observations deleted due to missingness</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(htwt.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 66.53378 
## 
##  sex 
##         f    m
##     64.44 69.6
## rep 22.00 15.0</code></pre>
<p>ht변수에 대해서 성별로 평균 차이가 있는지에 대한 분산분석을 진행한 결과, P-value는 0에 매우 가까운 값으로 유의수준 0.05보다 작으므로 유의한 것을 확이할 수 있다.</p>
<p>따라서, 성별에 따라서 ht변수에 대한 평균차이가 존재하는 것을 알 수 있다.</p>
</div>
<div id="three-variants-on-the-analysis" class="section level3">
<h3>10.1.3 Three Variants on the Analysis</h3>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="do">## dummy variable</span></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a>htwt<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(htwt<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;f&quot;</span>)</span></code></pre></div>
<p>성별이 female인 경우를 1로 지정하고 남성인 경우를 0으로 지정하여 더미변수화를 진행해주었다.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>htwt.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(ht <span class="sc">~</span> female, <span class="at">data=</span>htwt)</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(htwt.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ht ~ female, data = htwt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.6000 -2.4432  0.5568  2.4000  5.4000 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  69.6000     0.7701  90.380  &lt; 2e-16 ***
## female       -5.1568     0.9987  -5.164 9.78e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.983 on 35 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.4324, Adjusted R-squared:  0.4162 
## F-statistic: 26.66 on 1 and 35 DF,  p-value: 9.78e-06</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(htwt.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: ht
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## female     1 237.18 237.179  26.663 9.78e-06 ***
## Residuals 35 311.34   8.895                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>더미변수화를 진행한 후 회귀분석과 다시 한 번 분산분석을 진행해본 결과, 유의한 변수임을 알 수 있었고 분산분석의 결과는 앞선 결과와 동일하게 성별 간 평균차이가 존재하는 것을 확인할 수 있었다.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="do">## dummy variable</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a>htwt<span class="sc">$</span>treat <span class="ot">&lt;-</span> (htwt<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;f&quot;</span>) <span class="sc">-</span> (htwt<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a>htwtb.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(ht <span class="sc">~</span> treat,<span class="at">data=</span>htwt)</span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(htwtb.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ht ~ treat, data = htwt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.6000 -2.4432  0.5568  2.4000  5.4000 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  67.0216     0.4993 134.220  &lt; 2e-16 ***
## treat        -2.5784     0.4993  -5.164 9.78e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.983 on 35 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.4324, Adjusted R-squared:  0.4162 
## F-statistic: 26.66 on 1 and 35 DF,  p-value: 9.78e-06</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(htwtb.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: ht
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## treat      1 237.18 237.179  26.663 9.78e-06 ***
## Residuals 35 311.34   8.895                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>앞선 더미변수 방법과는 다르게 여성일 경우 1, 남성일 경우 -1로 변환해 준 후, 다시 한 번 분석을 진행해본 결과 동일한 결과가 나온 것을 확인할 수 있다.</p>
</div>
</div>
<div id="polynomial-contrasts-and-orthogonal-polynomials" class="section level2">
<h2>10.2 Polynomial Contrasts and Orthogonal Polynomials</h2>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(fabricwear)</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(wear<span class="sc">~</span>speed,<span class="at">data=</span>fabricwear,<span class="at">ylab=</span><span class="st">&quot;wear&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;speed&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-217-1.png" width="960" /></p>
<p><strong>fabricwear</strong>데이터의 <em>wear,speed</em>변수를 이용하여 boxplot을 그려본 결과, speed가 높아짐에 따라 wear의 평균 또한 같이 높아지는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>fabricwear.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wear <span class="sc">~</span> speed, <span class="at">data=</span>fabricwear)</span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fabricwear.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## speed        5   4872   974.4   297.7 &lt;2e-16 ***
## Residuals   42    137     3.3                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, 탐색적 자료분석을 통해 얻은 결과와 동일하게 wear변수에 대하여 적어도 한 speed 집단 간 유의한 평균차이가 발생하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>tmp.c <span class="ot">&lt;-</span> <span class="fu">zapsmall</span>(<span class="fu">contrasts</span>(fabricwear<span class="sc">$</span>speed),<span class="dv">14</span>)</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tmp.c)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">levels</span>(fabricwear<span class="sc">$</span>speed)</span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>tmp.c</span></code></pre></div>
<pre><code>##             .L         .Q         .C         ^4          ^5
## 100 -0.5976143  0.5455447 -0.3726780  0.1889822 -0.06299408
## 120 -0.3585686 -0.1091089  0.5217492 -0.5669467  0.31497039
## 140 -0.1195229 -0.4364358  0.2981424  0.3779645 -0.62994079
## 160  0.1195229 -0.4364358 -0.2981424  0.3779645  0.62994079
## 180  0.3585686 -0.1091089 -0.5217492 -0.5669467 -0.31497039
## 200  0.5976143  0.5455447  0.3726780  0.1889822  0.06299408</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>tmp.c_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp.c)</span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rownames</span>(tmp.c_df),tmp.c_df<span class="sc">$</span>.L,<span class="at">type=</span><span class="st">&quot;o&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;speed&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;polynomials&quot;</span>,<span class="at">main=</span><span class="st">&quot;.L&quot;</span>,<span class="at">col=</span><span class="st">&quot;#7685c8&quot;</span>)</span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rownames</span>(tmp.c_df),tmp.c_df<span class="sc">$</span>.Q,<span class="at">type=</span><span class="st">&quot;o&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;speed&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;polynomials&quot;</span>,<span class="at">main=</span><span class="st">&quot;.Q&quot;</span>,<span class="at">col=</span><span class="st">&quot;#7685c8&quot;</span>)</span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rownames</span>(tmp.c_df),tmp.c_df<span class="sc">$</span>.C,<span class="at">type=</span><span class="st">&quot;o&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;speed&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;polynomials&quot;</span>,<span class="at">main=</span><span class="st">&quot;.C&quot;</span>,<span class="at">col=</span><span class="st">&quot;#7685c8&quot;</span>)</span>
<span id="cb541-6"><a href="#cb541-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rownames</span>(tmp.c_df),tmp.c_df<span class="sc">$</span>X<span class="fl">.4</span>,<span class="at">type=</span><span class="st">&quot;o&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;speed&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;polynomials&quot;</span>,<span class="at">main=</span><span class="st">&quot;^4&quot;</span>,<span class="at">col=</span><span class="st">&quot;#7685c8&quot;</span>)</span>
<span id="cb541-7"><a href="#cb541-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rownames</span>(tmp.c_df),tmp.c_df<span class="sc">$</span>X<span class="fl">.5</span>,<span class="at">type=</span><span class="st">&quot;o&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;speed&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;polynomials&quot;</span>,<span class="at">main=</span><span class="st">&quot;^5&quot;</span>,<span class="at">col=</span><span class="st">&quot;#7685c8&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-219-1.png" width="960" /></p>
<p>데이터를 1차,2차,3차,4차,5차로 변환시키고 차수가 증가함에 따른 변화를 살펴보기 위해 plot을 통해 나타내보았다.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(<span class="fu">crossprod</span>(tmp.c),<span class="dv">13</span>)</span></code></pre></div>
<pre><code>##    .L .Q .C ^4 ^5
## .L  1  0  0  0  0
## .Q  0  1  0  0  0
## .C  0  0  1  0  0
## ^4  0  0  0  1  0
## ^5  0  0  0  0  1</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>min.nonzero <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits=</span><span class="dv">13</span>){</span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> <span class="fu">zapsmall</span>(x,digits)</span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(xx[xx <span class="sc">!=</span> <span class="dv">0</span>])</span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a>tmp.min <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">abs</span>(tmp.c),<span class="dv">2</span>,min.nonzero)</span>
<span id="cb544-7"><a href="#cb544-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-8"><a href="#cb544-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sweep</span>(tmp.c,<span class="dv">2</span>,tmp.min, <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>##     .L .Q    .C ^4  ^5
## 100 -5  5 -1.25  1  -1
## 120 -3 -1  1.75 -3   5
## 140 -1 -4  1.00  2 -10
## 160  1 -4 -1.00  2  10
## 180  3 -1 -1.75 -3  -5
## 200  5  5  1.25  1   1</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fabricwear.aov,</span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">split=</span><span class="fu">list</span>(<span class="at">speed=</span><span class="fu">list</span>(<span class="at">speed.L=</span><span class="dv">1</span>,<span class="at">speed.Q=</span><span class="dv">2</span>,</span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">speed.C=</span><span class="dv">3</span>,<span class="at">rest=</span><span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>)))</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq  F value   Pr(&gt;F)    
## speed             5   4872     974  297.705  &lt; 2e-16 ***
##   speed: speed.L  1   4327    4327 1321.903  &lt; 2e-16 ***
##   speed: speed.Q  1    513     513  156.760 9.12e-16 ***
##   speed: speed.C  1      7       7    2.105   0.1543    
##   speed: rest     2     25      13    3.878   0.0285 *  
## Residuals        42    137       3                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(fabricwear.aov)</span></code></pre></div>
<pre><code>## 
## Call:
## aov(formula = wear ~ speed, data = fabricwear)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.4875 -0.6531  0.1813  0.8250  2.7125 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  34.9292     0.2611 133.760  &lt; 2e-16 ***
## speed.L      23.2562     0.6396  36.358  &lt; 2e-16 ***
## speed.Q       8.0086     0.6396  12.520 9.12e-16 ***
## speed.C       0.9280     0.6396   1.451   0.1543    
## speed^4      -1.6772     0.6396  -2.622   0.0121 *  
## speed^5      -0.6000     0.6396  -0.938   0.3536    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.809 on 42 degrees of freedom
## Multiple R-squared:  0.9726, Adjusted R-squared:  0.9693 
## F-statistic: 297.7 on 5 and 42 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>앞서, 차수 변환을 시켜준 데이터에 대하여 분산분석을 진행해 보았다.<br />
분산분석결과, 1차,2차,4차의 다항식은 유의한 평균차이가 적어도 한 집단 이상 존재한다는 결과를 얻을 수 있었다.<br />
3차,5차의 다항식은 P-value가 유의수준 0.05보다 높으므로 집단 간 유의한 평균차이가 존재하지 않는다.</p>
</div>
<div id="example-hot-dog-data" class="section level2">
<h2>10.3 Example-Hot Dog Data</h2>
<div id="data-description-4" class="section level3">
<h3>10.3.1 Data Description</h3>
<ul>
<li>Type: 핫도그의 유형</li>
<li>Calories: 핫도그의 칼로리</li>
<li>Sodium: 핫도그 당 나트륨 밀리그램</li>
</ul>
</div>
<div id="concomitant-explanatory-variable-_-ancova" class="section level3">
<h3>10.3.2 Concomitant Explanatory Variable _ ANCOVA</h3>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hotdog)</span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(Sodium<span class="sc">~</span>Type,<span class="at">data=</span>hotdog,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">box.rectangle=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),<span class="at">box.umbrella=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),<span class="at">box.dot=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-222-1.png" width="960" /></p>
<p>탐색적 자료분석을 위한 boxplot 결과, 핫도그에 들어가느 고기 종류에 따른 나트륨은 큰 평균차이가 존재하지 않는 것 처럼 보인다.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;col3x2&quot;</span>)</span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a>hotdog.key <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Type&quot;</span>, <span class="at">border=</span><span class="cn">TRUE</span>, <span class="at">space=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">text=</span><span class="fu">list</span>(<span class="fu">levels</span>(hotdog<span class="sc">$</span>Type),</span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">15</span><span class="sc">:</span><span class="dv">17</span>,</span>
<span id="cb551-7"><a href="#cb551-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb551-8"><a href="#cb551-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lines=</span><span class="fu">list</span>(<span class="at">lty=</span><span class="dv">1</span>,</span>
<span id="cb551-9"><a href="#cb551-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">lwd=</span><span class="fu">trellis.par.get</span>(<span class="st">&quot;superpose.line&quot;</span>)<span class="sc">$</span>lwd[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb551-10"><a href="#cb551-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb551-11"><a href="#cb551-11" aria-hidden="true" tabindex="-1"></a>TxC <span class="ot">&lt;-</span> <span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Type, <span class="at">x=</span>Calories, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2,</span>
<span id="cb551-12"><a href="#cb551-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main=</span><span class="st">&quot;Sodium ~ Type, x=Calories&quot;</span>,</span>
<span id="cb551-13"><a href="#cb551-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb551-14"><a href="#cb551-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb551-15"><a href="#cb551-15" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(TxC, <span class="at">key=</span>hotdog.key)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-223-1.png" width="960" /></p>
<p>핫도그의 고기 유형에 따른 나트륨을 비교하고 칼로리를 공변량으로 지정한 결과를 <code>ancovaplot</code>을 통해 살펴보았다.</p>
<p>그림으로만 확인해봤을때, 평균차이는 존재하지 않는 것처럼 보인다.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aovStatementAndAnova</span>(TxC)</span></code></pre></div>
<pre><code>## &gt; anova(aov(Sodium ~ Type, data = hotdog))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Type       2  31739 15869.4  1.7778 0.1793
## Residuals 51 455249  8926.4</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(Sodium<span class="sc">~</span>Type,<span class="at">data=</span>hotdog))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Type       2  31739 15869.4  1.7778 0.1793
## Residuals 51 455249  8926.4</code></pre>
<p>분산분석을 진행한 결과 또한, 유의확률이 유의수준 0.05보다 큰 값을 가지므로 고기의 유형에 따른 칼로리의 평균 차이는 존재하지 않는다고 할 수 있다.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a>CgT <span class="ot">&lt;-</span> <span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Calories, <span class="at">groups=</span>Type, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2,</span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main=</span><span class="st">&quot;Sodium ~ Calories, groups=Type&quot;</span>,</span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(CgT, <span class="at">key=</span>hotdog.key)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-225-1.png" width="960" /></p>
<p>그룹변수를 Type으로 지정하고, 종속변수가 Sodium이고 독립변수가 Calories에 대한 <code>ancovaplot</code>을 그래프로 나타내보았다.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aovStatementAndAnova</span>(CgT, <span class="at">warn=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## &gt; anova(aov(Sodium ~ Calories, data = hotdog))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Calories   1 106270  106270  14.515 0.0003693 ***
## Residuals 52 380718    7321                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(Sodium <span class="sc">~</span> Calories, <span class="at">data=</span>hotdog))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Calories   1 106270  106270  14.515 0.0003693 ***
## Residuals 52 380718    7321                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Type을 Group으로 지정하고 반응변수를 Sodium으로 했을 때, 유의확률이 유의수준 0.05보다 작으므로, Calories 변수에 따른 유의한 평균차이가 적어도 한 집단 이상 있는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>hotdog.key <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Type&quot;</span>, <span class="at">border=</span><span class="cn">TRUE</span>, <span class="at">space=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">text=</span><span class="fu">list</span>(<span class="fu">levels</span>(hotdog<span class="sc">$</span>Type),</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">15</span><span class="sc">:</span><span class="dv">17</span>,</span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb563-6"><a href="#cb563-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lines=</span><span class="fu">list</span>(<span class="at">lty=</span><span class="dv">1</span>,</span>
<span id="cb563-7"><a href="#cb563-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">lwd=</span><span class="fu">trellis.par.get</span>(<span class="st">&quot;superpose.line&quot;</span>)<span class="sc">$</span>lwd[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb563-8"><a href="#cb563-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb563-9"><a href="#cb563-9" aria-hidden="true" tabindex="-1"></a>CpT <span class="ot">&lt;-</span> <span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Calories<span class="sc">+</span>Type, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2,</span>
<span id="cb563-10"><a href="#cb563-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main=</span><span class="st">&quot;Sodium ~ Calories + Type&quot;</span>,</span>
<span id="cb563-11"><a href="#cb563-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb563-12"><a href="#cb563-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb563-13"><a href="#cb563-13" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(CpT, <span class="at">key=</span>hotdog.key)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-227-1.png" width="960" /> 종속변수를 Sodium으로하고 독립변수는 Calories, Type으로 지정한 후, <code>ancovaplot</code>을 그려 보았다.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aovStatementAndAnova</span>(CpT)</span></code></pre></div>
<pre><code>## &gt; anova(aov(Sodium ~ Calories + Type, data = hotdog))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Calories   1 106270  106270  34.654 3.281e-07 ***
## Type       2 227386  113693  37.074 1.336e-10 ***
## Residuals 50 153331    3067                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a>CpT.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Sodium <span class="sc">~</span> Calories <span class="sc">+</span> Type, <span class="at">data=</span>hotdog)</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(CpT.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Calories   1 106270  106270  34.654 3.281e-07 ***
## Type       2 227386  113693  37.074 1.336e-10 ***
## Residuals 50 153331    3067                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석결과, 종속변수 Sodium에 대해서 <strong>Calories,Type</strong>모두 유의한 것으로 보아 두 변수 모두 적어도 한 집단 간 유의한 평균차이가 존재한다는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a>hotdog.key <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Type&quot;</span>, <span class="at">border=</span><span class="cn">TRUE</span>, <span class="at">space=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">text=</span><span class="fu">list</span>(<span class="fu">levels</span>(hotdog<span class="sc">$</span>Type),</span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb569-4"><a href="#cb569-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">15</span><span class="sc">:</span><span class="dv">17</span>,</span>
<span id="cb569-5"><a href="#cb569-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb569-6"><a href="#cb569-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lines=</span><span class="fu">list</span>(<span class="at">lty=</span><span class="dv">1</span>,</span>
<span id="cb569-7"><a href="#cb569-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">lwd=</span><span class="fu">trellis.par.get</span>(<span class="st">&quot;superpose.line&quot;</span>)<span class="sc">$</span>lwd[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb569-8"><a href="#cb569-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">col=</span>col3x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb569-9"><a href="#cb569-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-10"><a href="#cb569-10" aria-hidden="true" tabindex="-1"></a>hotdog<span class="sc">$</span>Sodium.Calories <span class="ot">&lt;-</span></span>
<span id="cb569-11"><a href="#cb569-11" aria-hidden="true" tabindex="-1"></a>   hotdog<span class="sc">$</span>Sodium <span class="sc">-</span> <span class="fu">predict.lm</span>(CpT.aov, <span class="at">type=</span><span class="st">&quot;terms&quot;</span>, <span class="at">terms=</span><span class="st">&quot;Calories&quot;</span>)</span>
<span id="cb569-12"><a href="#cb569-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-13"><a href="#cb569-13" aria-hidden="true" tabindex="-1"></a>T.C <span class="ot">&lt;-</span> <span class="fu">ancovaplot</span>(Sodium.Calories <span class="sc">~</span> Type, <span class="at">x=</span>Calories, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2,</span>
<span id="cb569-14"><a href="#cb569-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main=</span><span class="st">&quot;Sodium.Calories ~ Type, x=Calories&quot;</span>,</span>
<span id="cb569-15"><a href="#cb569-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb569-16"><a href="#cb569-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb569-17"><a href="#cb569-17" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(T.C, <span class="at">key=</span>hotdog.key)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-229-1.png" width="960" /> <strong>hotdog$Sodium.Calories</strong> 변수에 Sodium 변수 - (Calories + Type)을 이용한 회귀예측값을 계산하여 넣어주었다.<br />
그 다음, Sodium.Calories변수를 종속변수로 지정하고 Type을 독립변수로 지정한 후, Calories를 공변량으로 지정해주었다.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aovStatementAndAnova</span>(T.C)</span></code></pre></div>
<pre><code>## &gt; anova(aov(Sodium.Calories ~ Type, data = hotdog))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium.Calories
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Type       2 368463  184232  61.278 2.737e-14 ***
## Residuals 51 153331    3006                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(Sodium.Calories <span class="sc">~</span> Type, <span class="at">data=</span>hotdog))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium.Calories
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Type       2 368463  184232  61.278 2.737e-14 ***
## Residuals 51 153331    3006                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>위의 Formula를 분산분석에 적용했을 때, Type 주효과는 유의한 것을 확인할 수 있다.<br />
따라서, Type 집단에 따라서 적어도 한 집단 간 유의한 평균 차이가 발생하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>CpT.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(CpT.aov)</span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>CpT.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Sodium ~ Calories + Type, data = hotdog) 
## Estimated Quantile = 2.410308 
## 95% family-wise confidence level
## $mca
##               estimate   stderr    lower     upper   height
## Poultry-Meat 171.46894 23.13185 115.7140 227.22384 460.7693
## Poultry-Beef 182.76147 22.18564 129.2873 236.23568 455.1230
## Meat-Beef     11.29252 18.27834 -32.7639  55.34894 369.3885
## $none
##         estimate   stderr    lower    upper   height
## Poultry 546.5037 16.06743 507.7763 585.2312 546.5037
## Meat    375.0348 14.12817 340.9816 409.0880 375.0348
## Beef    363.7423 12.94391 332.5435 394.9411 363.7423</code></pre>
<p>차이가 발생하는 집단을 찾기 위해 다중비교를 진행하였다.<br />
<strong>Poultry-Meat</strong>, <strong>Poultry-Beef</strong>의 집단이 신뢰구간 0을 포함하지 않으므로 유의한 차이를 보이는 집단이라고 할 수 있다.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(CpT.mmc)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-232-1.png" width="960" /></p>
<p><code>mmcplot</code>을 통해서도 다중비교의 결과를 그림을 통해서 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a>CsT <span class="ot">&lt;-</span> <span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Calories <span class="sc">*</span> Type, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2,</span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main=</span><span class="st">&quot;Sodium ~ Calories * Type&quot;</span>,</span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>),</span>
<span id="cb578-4"><a href="#cb578-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb578-5"><a href="#cb578-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(CsT, <span class="at">key=</span>hotdog.key)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-233-1.png" width="960" /></p>
<p>Sodium변수를 종속변수로 지정한 후, Calories,Type를 독립변수로 지정하였고 *를 이용하여 교호작용 또한 고려하여 <code>ancovaplot</code>을 통해 그림을 그려보았다.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aovStatementAndAnova</span>(CsT)</span></code></pre></div>
<pre><code>## &gt; anova(aov(Sodium ~ Calories * Type, data = hotdog))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Calories       1 106270  106270 35.6885 2.747e-07 ***
## Type           2 227386  113693 38.1815 1.195e-10 ***
## Calories:Type  2  10402    5201  1.7466    0.1853    
## Residuals     48 142930    2978                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(Sodium <span class="sc">~</span> Calories <span class="sc">*</span> Type,<span class="at">data=</span>hotdog))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sodium
##               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Calories       1 106270  106270 35.6885 2.747e-07 ***
## Type           2 227386  113693 38.1815 1.195e-10 ***
## Calories:Type  2  10402    5201  1.7466    0.1853    
## Residuals     48 142930    2978                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, 주효과들은 유의하다는 결과가 나왔지만, 두 주효과의 교호작용은 유의하지 않은 것을 확인할 수 있다.</p>
</div>
<div id="tests-of-equality-of-regression-lines" class="section level3">
<h3>10.3.3 Tests of Equality of Regression Lines</h3>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a>removeAnnotation <span class="ot">&lt;-</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(x) {</span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">update</span>(x,</span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">main=</span><span class="fu">list</span>(x<span class="sc">$</span>main, <span class="at">cex=</span><span class="fl">1.1</span>),</span>
<span id="cb584-5"><a href="#cb584-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab=</span><span class="cn">NULL</span>,</span>
<span id="cb584-6"><a href="#cb584-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab=</span><span class="cn">NULL</span>,</span>
<span id="cb584-7"><a href="#cb584-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend=</span><span class="cn">NULL</span>,</span>
<span id="cb584-8"><a href="#cb584-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="dv">0</span>, <span class="at">tck=</span><span class="dv">0</span>),</span>
<span id="cb584-9"><a href="#cb584-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">9</span>, <span class="at">lines=</span><span class="fl">1.1</span>))</span>
<span id="cb584-10"><a href="#cb584-10" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb584-11"><a href="#cb584-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-12"><a href="#cb584-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 x 3, with empty spots</span></span>
<span id="cb584-13"><a href="#cb584-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(.<span class="dv">03</span>, .<span class="dv">31</span>,  .<span class="dv">53</span>, .<span class="dv">62</span>), <span class="at">more=</span><span class="cn">TRUE</span>, <span class="fu">removeAnnotation</span>(CgT))</span>
<span id="cb584-14"><a href="#cb584-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(.<span class="dv">50</span>, .<span class="dv">00</span>, <span class="fl">1.00</span>, .<span class="dv">31</span>), <span class="at">more=</span><span class="cn">TRUE</span>, <span class="fu">removeAnnotation</span>(TxC))</span>
<span id="cb584-15"><a href="#cb584-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(.<span class="dv">50</span>, .<span class="dv">31</span>, <span class="fl">1.00</span>, .<span class="dv">62</span>), <span class="at">more=</span><span class="cn">TRUE</span>, <span class="fu">removeAnnotation</span>(CpT))</span>
<span id="cb584-16"><a href="#cb584-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">position=</span><span class="fu">c</span>(.<span class="dv">50</span>, .<span class="dv">62</span>, <span class="fl">1.00</span>, .<span class="dv">93</span>), <span class="at">more=</span><span class="cn">TRUE</span>, <span class="fu">removeAnnotation</span>(CsT))</span>
<span id="cb584-17"><a href="#cb584-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-18"><a href="#cb584-18" aria-hidden="true" tabindex="-1"></a><span class="do">## column labeling</span></span>
<span id="cb584-19"><a href="#cb584-19" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="at">x=</span><span class="fu">c</span>(.<span class="dv">29</span>, .<span class="dv">75</span>), <span class="at">y=</span>.<span class="dv">02</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">14</span>),</span>
<span id="cb584-20"><a href="#cb584-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">&quot;constant intercept&quot;</span> <span class="sc">~</span><span class="er">~</span> alpha),</span>
<span id="cb584-21"><a href="#cb584-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(<span class="st">&quot;variable intercept&quot;</span> <span class="sc">~</span><span class="er">~</span> alpha)))</span>
<span id="cb584-22"><a href="#cb584-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-23"><a href="#cb584-23" aria-hidden="true" tabindex="-1"></a><span class="do">## row labeling</span></span>
<span id="cb584-24"><a href="#cb584-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="at">x=</span>.<span class="dv">02</span>, <span class="at">y=</span><span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">45</span>, .<span class="dv">75</span>), <span class="at">rot=</span><span class="dv">90</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">14</span>),</span>
<span id="cb584-25"><a href="#cb584-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">&quot;zero slope&quot;</span> <span class="sc">~</span><span class="er">~</span> beta<span class="sc">==</span><span class="dv">0</span>),</span>
<span id="cb584-26"><a href="#cb584-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(<span class="st">&quot;constant slope&quot;</span> <span class="sc">~</span><span class="er">~</span> beta),</span>
<span id="cb584-27"><a href="#cb584-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(<span class="st">&quot;variable slope&quot;</span> <span class="sc">~</span><span class="er">~</span> beta)))</span>
<span id="cb584-28"><a href="#cb584-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-29"><a href="#cb584-29" aria-hidden="true" tabindex="-1"></a><span class="do">## main title</span></span>
<span id="cb584-30"><a href="#cb584-30" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="at">x=</span>.<span class="dv">5</span>, <span class="at">y=</span>.<span class="dv">98</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>),</span>
<span id="cb584-31"><a href="#cb584-31" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Composite graph illustrating four models with a factor and a covariate&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-235-1.png" width="960" /></p>
</div>
</div>
<div id="ancovaplot-function" class="section level2">
<h2>10.4 ancovaplot Function</h2>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hotdog,<span class="at">package =</span> <span class="st">&quot;HH&quot;</span>)</span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(col3x2,<span class="at">pacakge=</span><span class="st">&quot;HH&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in data(col3x2, pacakge = &quot;HH&quot;): data set &#39;HH&#39; not found</code></pre>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="do">## constant line across all groups</span></span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="do">## y ~ x</span></span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Calories,<span class="at">groups=</span>Type,<span class="at">data=</span>hotdog,<span class="at">col=</span>col3x2)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-236-1.png" width="960" /></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="do">## different horizontal line in each group</span></span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true" tabindex="-1"></a><span class="do">## y ~ a</span></span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Type, <span class="at">x =</span> Calories, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-236-2.png" width="960" /></p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="do">## constant slope, different intercepts</span></span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a><span class="do">## y ~ x + a or y ~ a + x</span></span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Calories <span class="sc">+</span> Type, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-236-3.png" width="960" /></p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="do">## different slopes, and differnet intercepts</span></span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="do">## y ~ x * a or y ~ a * x</span></span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ancovaplot</span>(Sodium <span class="sc">~</span> Calories <span class="sc">*</span> Type, <span class="at">data=</span>hotdog, <span class="at">col=</span>col3x2)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-236-4.png" width="960" /></p>
<p><code>ancovaplot</code>또한 Formula를 +,* 등의 기호를 사용하여 다양한 조합을 그림으로 나타낼 수 있다.</p>
</div>
<div id="references-of-chapter10" class="section level2">
<h2>References of Chapter10</h2>
<p><a href="https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&amp;blogId=y4769&amp;logNo=220627663821">ANCOVA의 개념</a></p>
<hr />
</div>
<div id="summary-of-chapter10" class="section level2">
<h2>Summary of Chapter10</h2>
<ul>
<li><p><strong>더미 변수(Dummy variable)</strong>은 독립변수를 0과 1로 변환한 변수를 말한다. 예를 들어, 성별에 대한 데이터가 “M”,“F”인 경우, 문자열이기 때문에 데이터로 사용할 수가 없다. 따라서, 이러한 문자열에 대하여 숫자로 변환해주는 작업을 <strong>더미변수변환</strong>라고 할 수 있다.</p></li>
<li><p>문자열을 더미변수로 바꿔주는 과정에서 대응되는 더미를 잘못 만들어주거나, 원하는 가변수로 변하지 않은 상태에서 분석을 진행하면 이상한 모형이 도출될수도 있기 때문에 항상 더미변수화를 진행한 후에는 올바르게 변수변환이 되었는지 확인하는 것이 필요하다.</p></li>
<li><p>앞선 챕터에서 독립변수와 종속변수의 인과관계를 살펴보는 <strong>회귀분석</strong>과 종속변수에 대해서 독립변수의 집단 간 유의한 차이가 발생하는지에 대해 알아보기 위한 <strong>분산분석</strong>에 대해서 알아보았다.</p></li>
<li><p><strong>공분산분석(ANCOVA)</strong>는 회귀분석과 분산분석을 섞은 개념이라고 할 수 있다. 외생변수를 공변량으로 처리한 후, 독립변수의 각 집단 사이의 종속변수 값에 대해서 차이가 있는지를 확인하는 방법이다.</p></li>
<li><p><strong>공변량</strong>은 종속변수에 영향을 미칠 수 있으나 독립변수로 설정되지 않은 변수를 말하며, 잡음을 통제하는 과정이라고 말할 수 있다.</p></li>
<li><p>공분산분석 또한 분산분석, 회귀분석의 기본 가정사항인 <strong>정규성</strong>, <strong>등분산성</strong>, <strong>독립성</strong>을 가정한다.</p></li>
<li><p>R에서 공분산분석을 진행하고자 하는 경우, <code>ancovaplot</code>을 이용하여 시각적인 방법을 이용하거나, <code>lm</code>함수를 이용하여 공변량을 지정하고 회귀모형을 적합시킨 후에, <code>anova</code>함수를 이용하여 분산분석을 진행함으로써 공분산분석의 결과를 얻을 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chapter12-two-way-analysis-of-variance" class="section level1">
<h1>Chapter12 Two-Way Analysis of Variance</h1>
<p>앞 챕터의 일원분산분석(One-Way Anova)는 설명변수가 1개, 종속변수가 1개 일 때 모집단에 대한 평균을 비교하는 방법이었다.<br />
일원분산분석에서 종속변수는 연속형 자료 이어야하고, 설명변수는 대체로 3개 이상의 집단을 갖는 범주형 변수이어야 했다.</p>
<p><strong>이원분산분석(Two-way Anova)</strong>는 One-way Anova와 달리, 설명변수가 2개, 종속변수가 1개 일 때 모집단에 대한 평균을 비교하는 방법이다.<br />
일반적으로, 설명변수 2개를 <strong>주효과</strong>라고 일컫는다.<br />
이때, One-Way Anova와 동일하게 설명변수는 범주형 자료이어야 한다.</p>
<p>또한, 이원분산분석은 일원분산분석과는 주효과간 차이와 더불어, <strong>교호작용</strong>이라는 추가적인 효과를 고려한다.<br />
<strong>교호작용</strong>은 두 주효과가 서로 상호간에 영향을 주고 받으면서 나타나는 반응효과를 말한다.</p>
<p>기본 가정사항은 <strong>독립성</strong>, <strong>정규성</strong>, <strong>등분산성</strong>으로 일원분산분석과 같은 기본 가정사항을 가진다.</p>
<p>주효과 A를 지하철 이용 방법, 주효과 B를 지하철역, 반응변수를 승객의 수라고 하자.<br />
이원분산분석의 귀무가설은 다음과 같다.</p>
<p><strong>주효과 A에 대한 귀무가설</strong> H0: 지하철 이용 방법에 따른 승객의 수의 차이가 없을 것이다.<br />
H1: 지하철 이용 방법에 따른 승객의 수의 차이가 있을 것이다.</p>
<p><strong>주효과 B에 대한 귀무가설</strong> H0: 지하철 역에 따른 승객의 수의 차이가 없을 것이다.<br />
H1: 지하철 역에 따른 승객의 수의 차이가 있을 것이다.</p>
<p><strong>교호작용에 대한 귀무가설</strong> H0: 지하철이용 방법과 지하철 역의 교호작용 효과가 없을 것이다.<br />
H1: 지하철이용 방법과 지하철 역의 교호작용 효과가 있을 것이다.</p>
<hr />
<div id="example-display-panel-data" class="section level2">
<h2>12.1 Example-Display Panel Data</h2>
<div id="analysis-goals" class="section level3">
<h3>12.1.1 Analysis Goals</h3>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(display)</span></code></pre></div>
<p><strong>display</strong> 데이터는 아래와 같이 구성 돼있다.</p>
<ul>
<li>time: 초를 기준으로한 시간. <strong>(반응변수)</strong><br />
</li>
<li>panel: 3개의 범주로 구성된 테스트 중인 패널. <strong>(설명변수)</strong><br />
</li>
<li>emergenc: 4개의 범주로 구성된 시뮬레이션 된 비상상황. <strong>(설명변수)</strong></li>
<li>panel.ordered: 반응 평균의 순서와 맞도록 수준이 정렬된 패널요인의 반복.</li>
</ul>
<hr />
<p>anova Formula에서 <code>변수*변수</code>의 형태로 지정을 해주게 되면, 그 두 변수의 주효과와 더불어 교호작용의 유의성까지 확인할 수 있다.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a>displayf.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(time<span class="sc">~</span>emergenc<span class="sc">*</span>panel,<span class="at">data=</span>display)</span></code></pre></div>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(displayf.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: time
##                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## emergenc        3 1052.46  350.82 60.5731 1.612e-07 ***
## panel           2  232.75  116.38 20.0935 0.0001478 ***
## emergenc:panel  6   28.92    4.82  0.8321 0.5675015    
## Residuals      12   69.50    5.79                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, 2개의 주효과는 유의확률이 유의수준 0.05보다 작으므로 유의하다.<br />
따라서, 2개의 주효과 모두 적어도 한 집단 간 유의한 차이가 발생하는 것을 알 수 있다.</p>
<p>교호작용의 경우, <strong>emergenc:panel</strong>의 형태로 표시되며, 유의확률이 유의수준 0.05보다 크므로 유의하지 않다.<br />
따라서 두 개의 주효과의 교호작용 효과는 유의하지 않음을 알 수 있다.</p>
<hr />
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(time <span class="sc">~</span> panel.ordered <span class="sc">*</span> emergenc, <span class="at">data=</span>display)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-240-1.png" width="960" /></p>
<p><code>interaction2wt</code>을 통해 교호작용 그림을 그리게되면 위와같은 결과를 얻을 수 있다.<br />
먼저, 각 독립변수의 범주별 반응변수에 대한 boxplot을 확인할 수 있다. 이를 통해, 주효과의 집단에 따라 주효과의 변화를 살펴 볼 수 있다.<br />
또한, 왼쪽위와 오른쪽 아래 패널은 교호작용 그래프를 나타낸다.<br />
왼쪽 위의 그래프는 거의 평행하고 오른쪽 아래의 교호작용의 plot은 교차점이 있지만 선마다 거의 평행을 이룸을 볼 수 있다.<br />
이를 통해, 우리는 교호작용의 효과가 유의하지 않음을 확인할 수 있다.</p>
<hr />
<p>또 다른 교호작용 효과 확인 방법으로는 <code>interaction.plot</code>함수는 교호작용에 대한 plot만을 그릴 수 있다.</p>
<p><code>interaction.plot(x.factor,trace.factor,reponse)</code>를 이용하여 그린다.</p>
<ul>
<li>x.factor: x축에 올 독립변수<br />
</li>
<li>trace.factor: y축에 올 또 다른 독립변수</li>
<li>reponse: 반응변수</li>
</ul>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(<span class="at">x.factor =</span> display<span class="sc">$</span>panel.ordered,<span class="at">trace.factor=</span>display<span class="sc">$</span>emergenc,<span class="at">response=</span>display<span class="sc">$</span>time,</span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab=</span><span class="st">&quot;emergenc&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;panel.ordered&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-241-1.png" width="960" /></p>
<p>interaction.plot의 결과, 앞에서 우리가 그려봤던 상호작용 plot 그림과 동일한 그림을 얻을 수 있다.</p>
<hr />
<p><code>mmc</code>함수에서 <code>foucs</code>옵션은 독립변수 중 어느 변수를 기준으로 다중비교 분석을 진행할지 결정하는 옵션이다.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a>displayf.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(displayf.aov,<span class="at">focus=</span><span class="st">&quot;panel&quot;</span>)</span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a>displayf.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = time ~ emergenc * panel, data = display) 
## Estimated Quantile = 2.667402 
## 95% family-wise confidence level
## $mca
##     estimate   stderr     lower     upper  height
## 3-1    5.375 1.203294  2.165331  8.584669 22.9375
## 3-2    7.375 1.203294  4.165331 10.584669 21.9375
## 1-2    2.000 1.203294 -1.209669  5.209669 19.2500
## $none
##   estimate    stderr    lower    upper height
## 3   25.625 0.8508574 23.35542 27.89458 25.625
## 1   20.250 0.8508574 17.98042 22.51958 20.250
## 2   18.250 0.8508574 15.98042 20.51958 18.250</code></pre>
<p>panel 집단에 대한 다중비교 분석결과, 3-1,3-2 집단은 신뢰구간이 0을 포함하지 않으므로 집단 간 차이가 있음을 알수 있다.</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(displayf.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-243-1.png" width="960" /></p>
<p><code>mmcplot</code>을 통해 유의한 차이가 있는 집단이 붉은색으로 지정된 것을 시각적으로 확인할 수 있다.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(displayf.mmc,<span class="at">type=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-244-1.png" width="960" /></p>
<p><code>type=none</code>으로 지절하는 경우, 각 집단의 종속변수에 대한 신뢰구간에 대한 그림을 그릴 수 있다.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true" tabindex="-1"></a>displayr.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(time<span class="sc">~</span><span class="fu">Error</span>(emergenc<span class="sc">/</span>panel)<span class="sc">+</span>panel,<span class="at">data=</span>display)</span>
<span id="cb601-2"><a href="#cb601-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(displayr.aov)</span></code></pre></div>
<pre><code>## 
## Error: emergenc
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals  3   1052   350.8               
## 
## Error: emergenc:panel
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## panel      2 232.75  116.38   24.15 0.00135 **
## Residuals  6  28.92    4.82                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error: Within
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals 12   69.5   5.792</code></pre>
<p>위의 anova의 Formula는 우리가 알고있는 형태와 많이 다른 것을 확읺라 수 있다.<br />
<strong>Error(emergenc/panel)+panel</strong>의 의미는 emergenc 변수는 random 인자로, panel 인자는 fixed 인자로 설정한다는 것이다.<br />
또한, Error가 분수의 꼴로 돼있으므로 panel변수가 emergenc 내에서 nested한다는 의미도 가지고 있다.</p>
</div>
</div>
<div id="example-the-blood-plasma-data" class="section level2">
<h2>12.2 Example-The Blood Plasma Data</h2>
<div id="analysis" class="section level3">
<h3>12.2.1 Analysis</h3>
<p><br></p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(plasma)</span></code></pre></div>
<p><strong>plasma</strong> 데이터는 위와 같이 구성 돼있다.</p>
<ul>
<li>plasma: 플라즈마의 시트레이트 농도(마이크로몰/리터 단위) <strong>(반응변수)</strong><br />
</li>
<li>time: 5개의 범주를 갖는 시간. <strong>(설명변수)</strong><br />
</li>
<li>id: 10개의 범주로 구성된 요인. 과목당 하나씩 있다. <strong>(설명변수)</strong></li>
</ul>
<hr />
<p>데이터를 살펴보기 위해 x축을 time으로하고 y축을 plasma로 한 다음 id의 범주별 그래프를 그린 결과는 아래와 같다.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(plasma <span class="sc">~</span> time <span class="sc">|</span> id, <span class="at">data=</span>plasma, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span>.<span class="dv">5</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-247-1.png" width="960" /></p>
<p>아래의 Formula는 id를 random effect, time은 fixed effect로 지정한 후, 분산분석을 진행한다는 의미이다.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true" tabindex="-1"></a>plasma.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(plasma <span class="sc">~</span> <span class="fu">Error</span>(id)<span class="sc">+</span>time,<span class="at">data=</span>plasma)</span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plasma.aov)</span></code></pre></div>
<pre><code>## 
## Error: id
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals  9  10593    1177               
## 
## Error: Within
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## time       4   2804   701.0   4.754 0.00349 **
## Residuals 36   5308   147.5                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(plasma <span class="sc">~</span> time<span class="sc">*</span> id, <span class="at">data=</span>plasma)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-249-1.png" width="960" /></p>
<p>plasma데이터의 교호작용 그림의 결과이다. 교호작용 패널의 그래프를 보면 선간의 교차점이 꽤 많은 것을 알 수 있다.<br />
이를 통해, 두 독립변수 간 교호작용 효과가 존재할수도 있다는 추정을 해볼 수 있다.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a>plasma<span class="sc">$</span>time <span class="ot">&lt;-</span></span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">factor</span>(plasma<span class="sc">$</span>time,<span class="at">levels=</span><span class="fu">unique</span>(plasma<span class="sc">$</span>time),<span class="at">ordered=</span><span class="cn">FALSE</span>)</span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true" tabindex="-1"></a>plasma.aov2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(plasma <span class="sc">~</span> id <span class="sc">+</span> time, <span class="at">data=</span>plasma)</span>
<span id="cb608-4"><a href="#cb608-4" aria-hidden="true" tabindex="-1"></a>plasma.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(plasma.aov2,<span class="at">focus=</span><span class="st">&quot;time&quot;</span>)</span>
<span id="cb608-5"><a href="#cb608-5" aria-hidden="true" tabindex="-1"></a>plasma.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = plasma ~ id + time, data = plasma) 
## Estimated Quantile = 2.870877 
## 95% family-wise confidence level
## $mca
##          estimate   stderr        lower    upper height
## 11am-2pm      7.6 5.430613  -7.99062001 23.19062 124.10
## 11am-8pm      8.2 5.430613  -7.39062001 23.79062 123.80
## 11am-8am      9.4 5.430613  -6.19062001 24.99062 123.20
## 2pm-8pm       0.6 5.430613 -14.99062001 16.19062 120.00
## 2pm-8am       1.8 5.430613 -13.79062001 17.39062 119.40
## 8pm-8am       1.2 5.430613 -14.39062001 16.79062 119.10
## 11am-5pm     23.1 5.430613   7.50937999 38.69062 116.35
## 2pm-5pm      15.5 5.430613  -0.09062001 31.09062 112.55
## 8pm-5pm      14.9 5.430613  -0.69062001 30.49062 112.25
## 8am-5pm      13.7 5.430613  -1.89062001 29.29062 111.65
## $none
##      estimate   stderr     lower    upper height
## 11am    127.9 3.840023 116.87577 138.9242  127.9
## 2pm     120.3 3.840023 109.27577 131.3242  120.3
## 8pm     119.7 3.840023 108.67577 130.7242  119.7
## 8am     118.5 3.840023 107.47577 129.5242  118.5
## 5pm     104.8 3.840023  93.77577 115.8242  104.8</code></pre>
<p><strong>다중비교</strong>를 진행한 결과, 11am과 5pm 집단만이 신뢰구간 0을 포함하지 않는다.<br />
따라서, 11am-5pm 집단간 차이만이 유의한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(plasma.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-251-1.png" width="960" /></p>
<p>다중비교의 결과를 plot을 통해 나타낸 결과, 11am-5pm 집단 간 차이가 유의하여 붉은색으로 지정된 것을 확인할 수 있다.</p>
</div>
</div>
<div id="introduction-to-nesting" class="section level2">
<h2>12.3 Introduction to Nesting</h2>
<div id="example-workstation-data" class="section level3">
<h3>12.3.1 Example-Workstation Data</h3>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;workstation&quot;</span>)</span></code></pre></div>
<p><strong>station</strong> 데이터는 위와 같이 구성 돼있다.</p>
<ul>
<li>metohd: 1시간 동안 생산된 장치의 갯수 <strong>(반응변수)</strong><br />
</li>
<li>station: 2개의 범주로 구성된 지하철역. <strong>(설명변수)</strong><br />
</li>
<li>devices: 3개의 범주로 구성된 조립 방법. <strong>(설명변수)</strong></li>
</ul>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(devices<span class="sc">~</span>station<span class="sc">|</span>method,<span class="at">data=</span>workstation)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-253-1.png" width="960" /></p>
<p>boxplot을 살펴본결과, station에 따라 평균이 달라지는 것을 알 수 있고 metohd의 범주에 따라서도 boxplot의 평균이 달라지는 것을 확인할 수 있다.</p>
</div>
<div id="analysis-goals-1" class="section level3">
<h3>12.3.2 Analysis Goals</h3>
<p>아래의 anova formula는 station 변수가 method 변수에 대해서 nested 된 것을 가르키며, 그에 따른 분산분석을 진행하는 것이다.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a>workstation.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(devices<span class="sc">~</span>method<span class="sc">/</span>station,</span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>workstation)</span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(workstation.aov)</span></code></pre></div>
<pre><code>##                Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## method          2 1545.3   772.6  51.452 2.09e-09 ***
## method:station  3  210.2    70.1   4.666   0.0105 *  
## Residuals      24  360.4    15.0                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, metohd의 주효과는 유의한 차이가 있는 것을 알 수 있고, station을 method에 대해서 netsted 했을 때의 두 변수간 교호작용은 유의한 것으로 확인되는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(workstation.aov,<span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 23.06667 
## 
##  method 
## method
##    1    2    3 
## 14.8 22.1 32.3 
## 
##  method:station 
##       station
## method 1    2   
##      1 11.8 17.8
##      2 19.2 25.0
##      3 30.4 34.2
## 
## Standard errors for differences of means
##         method method:station
##          1.733          2.451
## replic.     10              5</code></pre>
<p><code>model.tables</code>를 통해 station과 method에 대한 그룹의 평균과 더불어, 전체 평균에 대한 정보를 알 수 있다.<br />
또한, <code>se=TRUE</code>옵션을 추가하여 standard errors에 대한 정보까지 확인할 수 있다.</p>
</div>
</div>
<div id="example-the-rhizobium-data" class="section level2">
<h2>12.4 Example-The Rhizobium Data</h2>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;rhiz.alfalfa&quot;</span>)</span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(rhiz.alfalfa<span class="sc">$</span>comb)</span></code></pre></div>
<pre><code>## [1] alfalfa        alfalfa+clover
## Levels: alfalfa alfalfa+clover</code></pre>
<p><strong>rhiz.alfala</strong>는 clover에서 자라는 박테리아에 대한 정보로 구성된 데이터이다.<br />
<strong>rhiz.alfalfa</strong> 데이터의 2-way 독립변수는 아래 와 같이 구성 돼있다.</p>
<ul>
<li>strain: 실험에 사용되는 박테리아의 종류. 6개의 범주로 구성됐다. <strong>(반응변수)</strong><br />
</li>
<li>comb: 2개의 범주로 구성된 순수 박테리아와 혼합된 박테리아. <strong>(설명변수)</strong></li>
</ul>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(weight<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb619-3"><a href="#cb619-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(nitro<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb619-4"><a href="#cb619-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(Npg<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb619-5"><a href="#cb619-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-6"><a href="#cb619-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb619-7"><a href="#cb619-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb619-8"><a href="#cb619-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-257-1.png" width="960" /></p>
<p>comb변수를 group으로 rhiz.alfalfa의 종속변수들에 대한 boxplot을 그린 결과이다.</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;rhiz.clover&quot;</span>)</span></code></pre></div>
<p><strong>rhiz.clover</strong>는 clover에서 자라는 박테리아에 대한 정보로 구성된 데이터이다.<br />
독립변수와 종속변수는 <strong>rhiz.alfala</strong>데이터와 같다.<br />
단, strain에 대한 독립변수의 level은 다르게 구성됐다.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(weight<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(nitro<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb621-3"><a href="#cb621-3" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(Npg<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb621-4"><a href="#cb621-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb621-5"><a href="#cb621-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb621-6"><a href="#cb621-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p5,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb621-7"><a href="#cb621-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p6,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-259-1.png" width="960" /></p>
<p>comb변수를 group으로 rhiz.clover의 종속변수들에 대한 boxplot을 그린 결과이다.</p>
<div id="alfalfa-analysis" class="section level3">
<h3>12.4.1 Alfalfa Analysis</h3>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="do">## unset position(rhiz.alfalfa$comb) for glht</span></span>
<span id="cb622-2"><a href="#cb622-2" aria-hidden="true" tabindex="-1"></a>rhiz.alfalfa.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb622-3"><a href="#cb622-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb622-4"><a href="#cb622-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.alfalfa.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## strain       5  46.22   9.244   4.565 0.00174 **
## comb         1   0.57   0.573   0.283 0.59714   
## strain:comb  5   8.44   1.687   0.833 0.53275   
## Residuals   48  97.21   2.025                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, <strong>strain</strong>변수는 적어도 한 집단 간 차이가 유의하다는 결론이 나왔고 comb변수와 교호작용 효과는 유의하지 않은 것을 알 수 있다.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a>alf.means <span class="ot">&lt;-</span> <span class="fu">model.tables</span>(rhiz.alfalfa.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>,<span class="at">cterms =</span> <span class="st">&quot;strain&quot;</span>)</span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true" tabindex="-1"></a>alf.means</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 30.73547 
## 
##  strain 
## strain
##  3DOa1  3DOa7 3DOa10 3DOa12 3DOa15 a.comp 
##  30.00  29.89  30.00  30.82  31.43  32.27 
## 
## Standard errors for differences of means
##         strain
##         0.6364
## replic.     10</code></pre>
<p><code>model.tables</code>를 통해 집단 간 평균과 standard error에 대한 결과를 얻을 수 있다.<br />
<code>cterms</code> 옵션을 이용하여 <strong>strain</strong>변수에 대한 정보만을 확인한다.<br />
a.comp 범주가 평균이 가장 높은 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a>old.fin <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>fin</span>
<span id="cb626-2"><a href="#cb626-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">fin=</span><span class="fu">c</span>(old.fin[<span class="dv">1</span>], <span class="fl">2.5</span>))</span>
<span id="cb626-3"><a href="#cb626-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-4"><a href="#cb626-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.01</span>,<span class="dv">1</span>,.<span class="dv">99</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">x=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">29.5</span>, <span class="fl">32.7</span>),<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(.<span class="dv">85</span>,<span class="fl">1.10</span>), <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb626-5"><a href="#cb626-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb626-6"><a href="#cb626-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rug</span>(alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain, <span class="at">ticksize=</span><span class="sc">-</span>.<span class="dv">1</span>)</span>
<span id="cb626-7"><a href="#cb626-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>)</span>
<span id="cb626-8"><a href="#cb626-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Npg&quot;</span>, <span class="dv">3</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb626-9"><a href="#cb626-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-10"><a href="#cb626-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-11"><a href="#cb626-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">29.7</span>,<span class="fl">31.5</span>), <span class="at">y=</span><span class="fu">c</span>(.<span class="dv">95</span>,.<span class="dv">95</span>))</span>
<span id="cb626-12"><a href="#cb626-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">30.5</span>,<span class="fl">32.5</span>), <span class="at">y=</span><span class="fu">c</span>(.<span class="dv">90</span>,.<span class="dv">90</span>))</span>
<span id="cb626-13"><a href="#cb626-13" aria-hidden="true" tabindex="-1"></a>strain.labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">dimnames</span>(alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain)[[<span class="dv">1</span>]],</span>
<span id="cb626-14"><a href="#cb626-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">format</span>(alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain, <span class="at">digits=</span><span class="dv">6</span>),</span>
<span id="cb626-15"><a href="#cb626-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sep=</span><span class="st">&quot;: &quot;</span>)</span>
<span id="cb626-16"><a href="#cb626-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-17"><a href="#cb626-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">6</span>)], <span class="at">labels=</span>strain.labels[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,  <span class="dv">6</span>)], <span class="at">line=</span><span class="dv">1</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">45</span>)</span>
<span id="cb626-18"><a href="#cb626-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="fu">c</span>(    <span class="dv">5</span>  )], <span class="at">labels=</span>strain.labels[<span class="fu">c</span>(    <span class="dv">5</span>  )], <span class="at">line=</span><span class="dv">2</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">45</span>)</span>
<span id="cb626-19"><a href="#cb626-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="dv">3</span>         ], <span class="at">labels=</span>strain.labels[<span class="dv">3</span>         ], <span class="at">line=</span><span class="dv">2</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">45</span>)</span>
<span id="cb626-20"><a href="#cb626-20" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="dv">1</span>         ], <span class="at">labels=</span>strain.labels[<span class="dv">1</span>         ], <span class="at">line=</span><span class="dv">3</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">4</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-262-1.png" width="960" /></p>
<p><code>model.tables</code>의 결과를 <code>plot,lines,axis</code>함수를 통하여 시각적으로 나타낼 수도 있다.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">fin=</span>old.fin)</span></code></pre></div>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a>rhiz.alfalfa.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.alfalfa.aov,<span class="at">focus=</span><span class="st">&quot;strain&quot;</span>)</span>
<span id="cb628-2"><a href="#cb628-2" aria-hidden="true" tabindex="-1"></a>rhiz.alfalfa.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Npg ~ strain * comb, data = rhiz.alfalfa) 
## Estimated Quantile = 2.968645 
## 95% family-wise confidence level
## $mca
##                 estimate    stderr      lower    upper   height
## a.comp-3DOa15 0.83028658 0.6364341 -1.0590605 2.719634 31.84986
## a.comp-3DOa12 1.44791050 0.6364341 -0.4414366 3.337258 31.54105
## a.comp-3DOa1  2.26191405 0.6364341  0.3725669 4.151261 31.13405
## a.comp-3DOa10 2.26529871 0.6364341  0.3759516 4.154646 31.13235
## 3DOa15-3DOa12 0.61762392 0.6364341 -1.2717232 2.506971 31.12590
## a.comp-3DOa7  2.37176042 0.6364341  0.4824133 4.261108 31.07912
## 3DOa15-3DOa1  1.43162747 0.6364341 -0.4577196 3.320975 30.71890
## 3DOa15-3DOa10 1.43501213 0.6364341 -0.4543350 3.324359 30.71721
## 3DOa15-3DOa7  1.54147383 0.6364341 -0.3478733 3.430821 30.66398
## 3DOa12-3DOa1  0.81400355 0.6364341 -1.0753436 2.703351 30.41009
## 3DOa12-3DOa10 0.81738821 0.6364341 -1.0719589 2.706735 30.40840
## 3DOa12-3DOa7  0.92384991 0.6364341 -0.9654972 2.813197 30.35517
## 3DOa1-3DOa10  0.00338466 0.6364341 -1.8859625 1.892732 30.00140
## 3DOa1-3DOa7   0.10984636 0.6364341 -1.7795008 1.999193 29.94817
## 3DOa10-3DOa7  0.10646170 0.6364341 -1.7828854 1.995809 29.94647
## $none
##        estimate    stderr    lower    upper   height
## a.comp 32.26500 0.4500269 30.92903 33.60097 32.26500
## 3DOa15 31.43472 0.4500269 30.09875 32.77069 31.43472
## 3DOa12 30.81709 0.4500269 29.48112 32.15306 30.81709
## 3DOa1  30.00309 0.4500269 28.66712 31.33906 30.00309
## 3DOa10 29.99970 0.4500269 28.66373 31.33567 29.99970
## 3DOa7  29.89324 0.4500269 28.55727 31.22921 29.89324</code></pre>
<p>다중비교를 진행한 결과, <strong>a.comp-3DOa1</strong>, <strong>a.comp-3DOa10</strong>, <strong>a.comp-3DOa7</strong>, 집단의 평균차이 신뢰구간이 0을 포함하지 않으므로 집단 간 차이가 유의한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(rhiz.alfalfa.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-265-1.png" width="960" /></p>
<p><code>mmcplot</code>을 이용하여 시각적으로 조금 더 쉽게 살펴볼 수 있다.</p>
<hr />
<p>다중비교 후, 원하는 집단 간 차이를 살펴보기 위해 cbind를 이용하여 contrast matrix를 만들어 준 후, 다시 한 번 다중비교 분석을 진행하였다.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a>alf.comp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;1,7,10-c&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb631-2"><a href="#cb631-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;1,10-7&quot;</span>  <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb631-3"><a href="#cb631-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;1-10&quot;</span>    <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb631-4"><a href="#cb631-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;15-12&quot;</span>   <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb631-5"><a href="#cb631-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;1,7,10,c-12,15&quot;</span><span class="ot">=</span><span class="fu">c</span>( <span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb631-6"><a href="#cb631-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(alf.comp)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(rhiz.alfalfa.mmc<span class="sc">$</span>none<span class="sc">$</span>lmat)[[<span class="dv">2</span>]]</span>
<span id="cb631-7"><a href="#cb631-7" aria-hidden="true" tabindex="-1"></a>alf.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.alfalfa.aov, <span class="at">focus=</span><span class="st">&quot;strain&quot;</span>,</span>
<span id="cb631-8"><a href="#cb631-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">focus.lmat=</span>alf.comp)</span>
<span id="cb631-9"><a href="#cb631-9" aria-hidden="true" tabindex="-1"></a>alf.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Npg ~ strain * comb, data = rhiz.alfalfa) 
## Estimated Quantile = 2.967775 
## 95% family-wise confidence level
## $mca
##                 estimate    stderr      lower    upper   height
## a.comp-3DOa15 0.83028658 0.6364341 -1.0585064 2.719080 31.84986
## a.comp-3DOa12 1.44791050 0.6364341 -0.4408825 3.336703 31.54105
## a.comp-3DOa1  2.26191405 0.6364341  0.3731211 4.150707 31.13405
## a.comp-3DOa10 2.26529871 0.6364341  0.3765057 4.154092 31.13235
## 3DOa15-3DOa12 0.61762392 0.6364341 -1.2711691 2.506417 31.12590
## a.comp-3DOa7  2.37176042 0.6364341  0.4829674 4.260553 31.07912
## 3DOa15-3DOa1  1.43162747 0.6364341 -0.4571655 3.320420 30.71890
## 3DOa15-3DOa10 1.43501213 0.6364341 -0.4537809 3.323805 30.71721
## 3DOa15-3DOa7  1.54147383 0.6364341 -0.3473192 3.430267 30.66398
## 3DOa12-3DOa1  0.81400355 0.6364341 -1.0747894 2.702797 30.41009
## 3DOa12-3DOa10 0.81738821 0.6364341 -1.0714048 2.706181 30.40840
## 3DOa12-3DOa7  0.92384991 0.6364341 -0.9649431 2.812643 30.35517
## 3DOa1-3DOa10  0.00338466 0.6364341 -1.8854083 1.892178 30.00140
## 3DOa1-3DOa7   0.10984636 0.6364341 -1.7789466 1.998639 29.94817
## 3DOa10-3DOa7  0.10646170 0.6364341 -1.7823313 1.995255 29.94647
## $none
##        estimate    stderr    lower    upper   height
## a.comp 32.26500 0.4500269 30.92942 33.60058 32.26500
## 3DOa15 31.43472 0.4500269 30.09914 32.77029 31.43472
## 3DOa12 30.81709 0.4500269 29.48151 32.15267 30.81709
## 3DOa1  30.00309 0.4500269 28.66751 31.33867 30.00309
## 3DOa10 29.99970 0.4500269 28.66413 31.33528 29.99970
## 3DOa7  29.89324 0.4500269 28.55766 31.22882 29.89324
## $lmat
##                  estimate    stderr      lower    upper   height
## 15-12          0.61762392 0.6364341 -1.2711691 2.506417 31.12590
## c-1,7,10       2.29965773 0.5196463  0.7574647 3.841851 31.11517
## 12,15-1,7,10,c 0.58564475 0.3897347 -0.5710000 1.742290 30.83308
## 1-10           0.00338466 0.6364341 -1.8854083 1.892178 30.00140
## 1,10-7         0.10815403 0.5511681 -1.5275887 1.743897 29.94732</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a>alf.both_style <span class="ot">&lt;-</span> <span class="fu">mmcplot</span>(alf.mmc, <span class="at">h=</span><span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">55</span>), <span class="at">type=</span><span class="st">&quot;lmat&quot;</span>, <span class="at">style=</span><span class="st">&quot;both&quot;</span>,</span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub=</span><span class="fu">list</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">         The MMC panel shows informative overprinting.  Please see Tiebreaker panel and caption.&quot;</span>, <span class="at">cex=</span>.<span class="dv">75</span>))</span>
<span id="cb633-3"><a href="#cb633-3" aria-hidden="true" tabindex="-1"></a>alf.both_style</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-266-1.png" width="960" /></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a>alf.both2_style <span class="ot">&lt;-</span> alf.both_style</span>
<span id="cb634-2"><a href="#cb634-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-3"><a href="#cb634-3" aria-hidden="true" tabindex="-1"></a>alf.both2_style<span class="sc">$</span>par.settings<span class="sc">$</span>layout.heights<span class="sc">$</span>panel <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">25</span>)</span>
<span id="cb634-4"><a href="#cb634-4" aria-hidden="true" tabindex="-1"></a>alf.both2_style     </span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-266-2.png" width="960" /></p>
<p>분석결과, <strong>c(a.comp) - (3DOa1, 3DOa7, 3DOa10)</strong>의 집단 간 차이만 유의한 것을 확인할 수 있다.</p>
</div>
<div id="clover-analysis" class="section level3">
<h3>12.4.2 Clover Analysis</h3>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-3"><a href="#cb635-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## strain       5  642.3  128.45   9.916 1.47e-06 ***
## comb         1    6.9    6.88   0.531  0.46955    
## strain:comb  5  228.2   45.65   3.524  0.00857 ** 
## Residuals   48  621.8   12.95                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>rhiz.clover</strong>데이터에 대한 분산분석 결과, strain이 유의한 것을 확인할 수 있고 <strong>rhiz.alfala</strong> 데이터와 달리 교호작용이 유의한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(rhiz.clover.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 26.00674 
## 
##  strain 
## strain
##  3DOk1  3DOk5  3DOk4  3DOk7 3DOk13 k.comp 
##  28.72  31.86  22.66  23.95  23.39  25.45 
## 
##  comb 
## comb
##         clover clover+alfalfa 
##         26.345         25.668 
## 
##  strain:comb 
##         comb
## strain   clover clover+alfalfa
##   3DOk1  29.04  28.41         
##   3DOk5  36.29  27.44         
##   3DOk4  21.35  23.98         
##   3DOk7  22.93  24.96         
##   3DOk13 22.49  24.30         
##   k.comp 25.97  24.92         
## 
## Standard errors for differences of means
##         strain   comb strain:comb
##         1.6096 0.9293      2.2763
## replic.     10     30           5</code></pre>
<p>교호작용 효과가 유의하므로 <code>cterms</code>옵션을 사용하지 않고 주효과와 교호작용에 대한 model table을 확인한다.</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.clover.aov,<span class="at">focus=</span><span class="st">&quot;strain&quot;</span>)</span>
<span id="cb639-2"><a href="#cb639-2" aria-hidden="true" tabindex="-1"></a>rhiz.clover.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Npg ~ strain * comb, data = rhiz.clover) 
## Estimated Quantile = 2.968362 
## 95% family-wise confidence level
## $mca
##                estimate   stderr        lower     upper   height
## 3DOk5-3DOk1   3.1387117 1.609592 -1.639141117  7.916565 30.29328
## 3DOk5-k.comp  6.4147051 1.609592  1.636852280 11.192558 28.65528
## 3DOk5-3DOk7   7.9142754 1.609592  3.136422530 12.692128 27.90549
## 3DOk5-3DOk13  8.4695956 1.609592  3.691742741 13.247448 27.62783
## 3DOk5-3DOk4   9.1980737 1.609592  4.420220814 13.975927 27.26360
## 3DOk1-k.comp  3.2759934 1.609592 -1.501859454  8.053846 27.08592
## 3DOk1-3DOk7   4.7755636 1.609592 -0.002289204  9.553416 26.33614
## 3DOk1-3DOk13  5.3308839 1.609592  0.553031007 10.108737 26.05848
## 3DOk1-3DOk4   6.0593619 1.609592  1.281509080 10.837215 25.69424
## k.comp-3DOk7  1.4995703 1.609592 -3.278282600  6.277423 24.69814
## k.comp-3DOk13 2.0548905 1.609592 -2.722962389  6.832743 24.42048
## k.comp-3DOk4  2.7833685 1.609592 -1.994484316  7.561221 24.05624
## 3DOk7-3DOk13  0.5553202 1.609592 -4.222532639  5.333173 23.67070
## 3DOk7-3DOk4   1.2837983 1.609592 -3.494054566  6.061651 23.30646
## 3DOk13-3DOk4  0.7284781 1.609592 -4.049374777  5.506331 23.02880
## $none
##        estimate   stderr    lower    upper   height
## 3DOk5  31.86263 1.138154 28.48418 35.24108 31.86263
## 3DOk1  28.72392 1.138154 25.34547 32.10237 28.72392
## k.comp 25.44793 1.138154 22.06948 28.82638 25.44793
## 3DOk7  23.94836 1.138154 20.56991 27.32681 23.94836
## 3DOk13 23.39304 1.138154 20.01458 26.77149 23.39304
## 3DOk4  22.66456 1.138154 19.28611 26.04301 22.66456</code></pre>
<p>집단 간 차이를 확인하기 위해 다중비교를 진행한 결과, 차이가 유의한 집단은 다음과 같다.<br />
<strong>3DOk5-k.comp</strong>, <strong>3DOk5-3DOk7</strong>, <strong>3DOk5-3DOk13</strong>, <strong>3DOk5-3DOk4</strong>, <strong>3DOk1-3DOk13</strong>, <strong>3DOk1-3DOk4</strong></p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(rhiz.clover.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-270-1.png" width="960" /></p>
<p><code>mmcplot</code>을 통해서도 집단 간 유의한 차이가 있는 그룹을 확인할 수 있다.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.clover,<span class="at">par.settings=</span><span class="fu">list</span>(</span>
<span id="cb642-2"><a href="#cb642-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.symbol=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb642-3"><a href="#cb642-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">box.dot=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb642-4"><a href="#cb642-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">6</span>) </span>
<span id="cb642-5"><a href="#cb642-5" aria-hidden="true" tabindex="-1"></a>                 ))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-271-1.png" width="960" /></p>
<p>교호작용 plot에서 <code>par.settings</code>옵션을 통해 box와 plot의 symbol을 지정해줄 수 있다.</p>
<p>boxplot을 통해 각 범주 데이터의 이상치를 확인할 수 있다.<br />
또한, 교호작용이 유의하므로 교호작용 패널의 선들이 교차점을 가지고 대체로 평행하지 않은 형태를 보이는 것을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.clover,<span class="at">simple=</span><span class="cn">TRUE</span>,<span class="at">par.settings=</span><span class="fu">list</span>(</span>
<span id="cb643-2"><a href="#cb643-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.symbol=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb643-3"><a href="#cb643-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">box.dot=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb643-4"><a href="#cb643-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">6</span>)))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-272-1.png" width="960" /></p>
<p><code>simple=TRUE</code>라는 옵션을 지정하게 되면 범주에 따라서 pch옵션을 자동으로 다르게 해준다. 따라서, 범주간 데이터를 구별하는데 더 유용하다.</p>
<hr />
<p>아래의 anova formula는 <strong>strain</strong>변수가 <strong>comb</strong>변수에 nested 된 formula 이다.</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.nest.aov <span class="ot">&lt;-</span></span>
<span id="cb644-2"><a href="#cb644-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(Npg<span class="sc">~</span>comb<span class="sc">/</span>strain,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb644-3"><a href="#cb644-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.nest.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## comb         1    6.9    6.88   0.531   0.47    
## comb:strain 10  870.5   87.05   6.720  2e-06 ***
## Residuals   48  621.8   12.95                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>nested를 진행한 분산분석의 결과, 주효과 comb는 유의하지 않고, 교호작용의 효과만 유의한 것을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true" tabindex="-1"></a>old.width <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">width=</span><span class="dv">35</span>)</span>
<span id="cb646-2"><a href="#cb646-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">coef</span>(rhiz.clover.nest.aov))</span></code></pre></div>
<pre><code>##  [1] &quot;(Intercept)&quot;                    
##  [2] &quot;combclover+alfalfa&quot;             
##  [3] &quot;combclover:strain3DOk5&quot;         
##  [4] &quot;combclover+alfalfa:strain3DOk5&quot; 
##  [5] &quot;combclover:strain3DOk4&quot;         
##  [6] &quot;combclover+alfalfa:strain3DOk4&quot; 
##  [7] &quot;combclover:strain3DOk7&quot;         
##  [8] &quot;combclover+alfalfa:strain3DOk7&quot; 
##  [9] &quot;combclover:strain3DOk13&quot;        
## [10] &quot;combclover+alfalfa:strain3DOk13&quot;
## [11] &quot;combclover:straink.comp&quot;        
## [12] &quot;combclover+alfalfa:straink.comp&quot;</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(old.width)</span></code></pre></div>
<p>nested된 anova 결과의 계수를 살펴보면 위와 같다.</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.nest.aov,</span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">split=</span><span class="fu">list</span>(<span class="st">&quot;comb:strain&quot;</span><span class="ot">=</span></span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(<span class="at">clover=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>),</span>
<span id="cb649-4"><a href="#cb649-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;clover+alf&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>))))</span></code></pre></div>
<pre><code>##                           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## comb                       1    6.9    6.88   0.531    0.470    
## comb:strain               10  870.5   87.05   6.720 2.00e-06 ***
##   comb:strain: clover      5  788.4  157.68  12.172 1.22e-07 ***
##   comb:strain: clover+alf  5   82.1   16.42   1.268    0.293    
## Residuals                 48  621.8   12.95                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>split을 통해 범주를 나눈 후, 그 범주에 따른 교호작용 또한 살펴볼 수 있다.</p>
<hr />
<p>rhiz.clover의 독립변수 간 교호작용이 유의했으므로 inetr 변수에 두 변수의 교호작용을 넣어 준후 분석을 진행해본다.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover<span class="sc">$</span>inter <span class="ot">&lt;-</span> <span class="fu">with</span>(rhiz.clover, <span class="fu">interaction</span>(comb, strain))</span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(rhiz.clover<span class="sc">$</span>inter)</span></code></pre></div>
<pre><code>##  [1] &quot;clover.3DOk1&quot;          &quot;clover+alfalfa.3DOk1&quot; 
##  [3] &quot;clover.3DOk5&quot;          &quot;clover+alfalfa.3DOk5&quot; 
##  [5] &quot;clover.3DOk4&quot;          &quot;clover+alfalfa.3DOk4&quot; 
##  [7] &quot;clover.3DOk7&quot;          &quot;clover+alfalfa.3DOk7&quot; 
##  [9] &quot;clover.3DOk13&quot;         &quot;clover+alfalfa.3DOk13&quot;
## [11] &quot;clover.k.comp&quot;         &quot;clover+alfalfa.k.comp&quot;</code></pre>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.inter.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg <span class="sc">~</span> inter, <span class="at">data=</span>rhiz.clover)</span>
<span id="cb653-2"><a href="#cb653-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.inter.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## inter       11  877.4   79.76   6.157 3.46e-06 ***
## Residuals   48  621.8   12.95                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a>cs12.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.clover.inter.aov, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">inter=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb655-2"><a href="#cb655-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(cs12.mmc,</span>
<span id="cb655-3"><a href="#cb655-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">&quot;clover and clover+alfalfa comparisons&quot;</span>,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-277-1.png" width="960" /></p>
<p>교호작용에 대한 다중 비교 plot을 그리면 위와 같다.<br />
유의한 집단간 차이가 보이지만, 너무 많은 집단간 차이가 출력되어 한 눈에 알아 볼 수 없다.</p>
<p>교호작용 분석을 진행할 때에는 적절한 제약조건이 필요하다는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at the contrasts, their generated dummy variables  </span></span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true" tabindex="-1"></a><span class="do">## and their regression coefficients</span></span>
<span id="cb656-3"><a href="#cb656-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Abbreviate their names for presentation,</span></span>
<span id="cb656-4"><a href="#cb656-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-5"><a href="#cb656-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">abbreviate</span>(<span class="fu">names</span>(<span class="fu">coef</span>(rhiz.clover.nest.aov)))</span>
<span id="cb656-6"><a href="#cb656-6" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre><code>##                     (Intercept)              combclover+alfalfa 
##                          &quot;(In)&quot;                          &quot;cmb+&quot; 
##          combclover:strain3DOk5  combclover+alfalfa:strain3DOk5 
##                        &quot;c:3DO5&quot;                       &quot;c+:3DO5&quot; 
##          combclover:strain3DOk4  combclover+alfalfa:strain3DOk4 
##                        &quot;c:3DO4&quot;                       &quot;c+:3DO4&quot; 
##          combclover:strain3DOk7  combclover+alfalfa:strain3DOk7 
##                        &quot;c:3DO7&quot;                       &quot;c+:3DO7&quot; 
##         combclover:strain3DOk13 combclover+alfalfa:strain3DOk13 
##                        &quot;c:3DO1&quot;                       &quot;c+:3DO1&quot; 
##         combclover:straink.comp combclover+alfalfa:straink.comp 
##                          &quot;cm:.&quot;                          &quot;c+:.&quot;</code></pre>
<p>contrasts를 통해 R 프로그램 내에서 더미변수가 어떻게 지정됐는지 확인할 수 있다.</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(rhiz.clover<span class="sc">$</span>comb)</span></code></pre></div>
<pre><code>##                clover+alfalfa
## clover                      0
## clover+alfalfa              1</code></pre>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(rhiz.clover<span class="sc">$</span>strain)</span></code></pre></div>
<pre><code>##        3DOk5 3DOk4 3DOk7 3DOk13 k.comp
## 3DOk1      0     0     0      0      0
## 3DOk5      1     0     0      0      0
## 3DOk4      0     1     0      0      0
## 3DOk7      0     0     1      0      0
## 3DOk13     0     0     0      1      0
## k.comp     0     0     0      0      1</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a>cnx <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg<span class="sc">~</span> comb<span class="sc">/</span>strain, <span class="at">data=</span>rhiz.clover,<span class="at">x=</span><span class="cn">TRUE</span>)<span class="sc">$</span>x</span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-3"><a href="#cb662-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(cnx)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> tmp</span>
<span id="cb662-4"><a href="#cb662-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-5"><a href="#cb662-5" aria-hidden="true" tabindex="-1"></a><span class="do">## cnx</span></span>
<span id="cb662-6"><a href="#cb662-6" aria-hidden="true" tabindex="-1"></a>cnx[<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">60</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>)]</span></code></pre></div>
<pre><code>##    (In) cmb+ c:3DO5 c:3DO4 c:3DO7 c:3DO1 cm:.
## 1     1    0      0      0      0      0    0
## 6     1    0      1      0      0      0    0
## 11    1    0      0      1      0      0    0
## 16    1    0      0      0      1      0    0
## 21    1    0      0      0      0      1    0
## 26    1    0      0      0      0      0    1
## 31    1    1      0      0      0      0    0
## 36    1    1      0      0      0      0    0
## 41    1    1      0      0      0      0    0
## 46    1    1      0      0      0      0    0
## 51    1    1      0      0      0      0    0
## 56    1    1      0      0      0      0    0</code></pre>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a>cnx[<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">60</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>)]</span></code></pre></div>
<pre><code>##    c+:3DO5 c+:3DO4 c+:3DO7 c+:3DO1 c+:.
## 1        0       0       0       0    0
## 6        0       0       0       0    0
## 11       0       0       0       0    0
## 16       0       0       0       0    0
## 21       0       0       0       0    0
## 26       0       0       0       0    0
## 31       0       0       0       0    0
## 36       1       0       0       0    0
## 41       0       1       0       0    0
## 46       0       0       1       0    0
## 51       0       0       0       1    0
## 56       0       0       0       0    1</code></pre>
<p>앞서 분산분석의 결과로 얻어진 회귀계수를 더미변수로에 함께 배치되도록 지정해주었다.<br />
cnx를 통해 살펴본 결과, 우리가 지정한 회귀계수가 더미변수 안에 적절하게 들어간 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a>cnxb <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">coef</span>(<span class="fu">summary.lm</span>(rhiz.clover.aov)),<span class="dv">3</span>)</span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(cnxb)[[<span class="dv">1</span>]]<span class="ot">&lt;-</span>tmp</span>
<span id="cb666-3"><a href="#cb666-3" aria-hidden="true" tabindex="-1"></a>cnxb[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>),]</span></code></pre></div>
<pre><code>##         Estimate Std. Error t value Pr(&gt;|t|)
## (In)      29.042      1.610  18.043    0.000
## cmb+       7.243      2.276   3.182    0.003
## c:3DO5    -7.688      2.276  -3.378    0.001
## c:3DO4    -6.556      2.276  -2.880    0.006
## c+:3DO4   -3.070      2.276  -1.349    0.184
## c:3DO7    -0.637      2.276  -0.280    0.781
## cm:.       2.451      3.219   0.761    0.450
## c+:3DO5   -6.110      2.276  -2.684    0.010
## c+:3DO4   -3.070      2.276  -1.349    0.184
## c+:3DO7   -8.210      3.219  -2.550    0.014
## c+:3DO1    2.668      3.219   0.829    0.411
## c+:.      -0.413      3.219  -0.128    0.899</code></pre>
<p>clover 데이터의 실험에서 더미변수와 회귀계수를 함께 배치한 뒤 분석한 선형회귀분석 결과는 위와 같이 나온다.</p>
</div>
</div>
<div id="example-animal-feed-data" class="section level2">
<h2>12.5 Example-Animal Feed Data</h2>
<div id="analysis-1" class="section level3">
<h3>12.5.1 Analysis</h3>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(feed)</span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true" tabindex="-1"></a>feed.int.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(retained<span class="sc">~</span>temp<span class="sc">*</span>supp,<span class="at">data=</span>feed)</span>
<span id="cb668-3"><a href="#cb668-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(feed.int.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: retained
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## temp       2 1479.2  739.60 26.0423 1.321e-05 ***
## supp       4 3862.1  965.53 33.9977 2.334e-07 ***
## temp:supp  8  243.5   30.43  1.0716    0.4313    
## Residuals 15  426.0   28.40                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>feed 데이터의 분산 분석 결과, <strong>temp, supp</strong> 독립변수는 유의확률이 유의수준 0.05보다 작으므로 적어도 집단 간 차이가 한 집단 이상에서 유의한 차이가 있다는 것을 알 수 있다.<br />
교호작용의 유의확률은 유의수준 0.05보다 크므로 유의하지 않은 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="#cb670-1" aria-hidden="true" tabindex="-1"></a>feed.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(retained <span class="sc">~</span> temp <span class="sc">+</span> supp,<span class="at">data=</span>feed)</span>
<span id="cb670-2"><a href="#cb670-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(feed.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: retained
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## temp       2 1479.2  739.60  25.410 1.499e-06 ***
## supp       4 3862.1  965.53  33.172 3.037e-09 ***
## Residuals 23  669.5   29.11                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(feed.aov,<span class="at">split=</span></span>
<span id="cb672-2"><a href="#cb672-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">temp=</span><span class="fu">list</span>(<span class="at">linear=</span><span class="dv">1</span>,<span class="at">quadratic=</span><span class="dv">2</span>),</span>
<span id="cb672-3"><a href="#cb672-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">supp=</span><span class="fu">list</span>(<span class="at">linear=</span><span class="dv">1</span>,<span class="at">quadratic=</span><span class="dv">2</span>,<span class="at">rest=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)))</span></code></pre></div>
<pre><code>##                   Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## temp               2   1479   739.6  25.409 1.50e-06 ***
##   temp: linear     1    370   369.8  12.705  0.00165 ** 
##   temp: quadratic  1   1109  1109.4  38.114 2.68e-06 ***
## supp               4   3862   965.5  33.172 3.04e-09 ***
##   supp: linear     1   2912  2912.1 100.046 7.61e-10 ***
##   supp: quadratic  1    947   946.7  32.525 8.30e-06 ***
##   supp: rest       2      3     1.7   0.058  0.94418    
## Residuals         23    669    29.1                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>feed 데이터의 contrasts를 고차 방정식을 적용하여 anova 분석을 다시 한 번 진행해보았다.<br />
1차, 2차는 모두 유의하게 나온 것을 알 수 있었지만 rest(나머지) 방정식에서는 더 이상 유의하지 않은 것을 알 수 있다.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(feed.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##      
## 68.8 
## 
##  temp 
## temp
##   40   80  120 
## 60.2 77.4 68.8 
## 
##  supp 
## supp
##     2     4     6     8    10 
## 48.33 64.67 76.00 79.00 76.00 
## 
## Standard errors for differences of means
##          temp  supp
##         2.413 3.115
## replic.    10     6</code></pre>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="#cb676-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(retained <span class="sc">~</span> supp <span class="sc">*</span> temp, <span class="at">data=</span>feed)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-285-1.png" width="960" /></p>
<p>교호작용의 패널은 거의 평행한 모양에 가깝기 때문에 앞서 살펴본 것 처럼, 교호작용이 유의하지 않은 것을 다시 한 번 확인할 수 있다.</p>
</div>
</div>
<div id="appendix-r-markdown-theme" class="section level2">
<h2>12.6 Appendix: R Markdown Theme</h2>
<div id="change-of-theme" class="section level3">
<h3>12.6.1 Change of Theme</h3>
<p>R markdown은 다양한 theme를 가지고 있다.<br />
theme는 다음과 같이 설정할 수 있다.</p>
<p>Ouput:<br />
html_document:<br />
theme: <strong>theme</strong>이름</p>
<p>사용할 수 있는 Theme의 종류는 아래의 링크에서 볼 수 있다.<br />
<a href="https://rfriend.tistory.com/311" class="uri">https://rfriend.tistory.com/311</a></p>
</div>
<div id="change-of-background" class="section level3">
<h3>12.6.2 Change of Background</h3>
<p>theme가 아닌 Markdown의 background를 변경을 원할수도 있다.<br />
Markdown의 경우 HTML을 기반으로 하기때문에 이러한 스타일의 변경은 css를 수정해주어야한다.</p>
<p>html에서 내용을 가지고 있는 부분은 <strong>body</strong>이다.<br />
이러한 <strong>body</strong>의 배경색을 변경해주면 markdown의 배경색을 변경할 수 있다.<br />
변경방법의 코드는 아래와 같다.</p>
<p><code>&lt;body style="background-color:grey;"&gt;</code></p>
<p>기본 색깔이 아닌 Color Hex를 지정하여 배경색을 지정해줄 수도 있다.<br />
<code>&lt;body style="background-color:#FFFFE6;"&gt;</code></p>
</div>
</div>
<div id="references-of-chapter-12" class="section level2 unnumbered">
<h2 class="unnumbered">References of Chapter 12</h2>
<p><a href="https://rfriend.tistory.com/136">이원분산분석의 정의</a><br />
<a href="http://contents2.kocw.or.kr/KOCW/document/2016/chungang/parkjunseong2/9.pdf">이원분산분석의 특징</a><br />
<a href="https://stackoverflow.com/questions/37497948/aov-error-term-in-r-whats-the-difference-bw-errorid-and-errorid-timevar/42664178">Nested of Two-Anova</a><br />
<a href="https://rfriend.tistory.com/311">R markdown theme</a> <a href="https://stackoverflow.com/questions/65541245/how-do-i-change-the-entire-background-color-in-an-rmarkdown-html-document">R background color</a></p>
<hr />
</div>
<div id="summary-of-chapter12" class="section level2">
<h2>Summary of Chapter12</h2>
<ul>
<li><p>우리는 Chapter6에서 설명변수의 집단에 따른 평균적인 차이가 존재하는지에 대해 분석하는 <strong>One-Way-ANOVA</strong>방법에 대해서 살펴보았다. 회귀에서도 단순선형회귀, 다중선형회귀가 있는 것 처럼, 분산분석 또한 설명변수가 2개 이상인 경우에 사용하는 분석방법이 있다.</p></li>
<li><p>(집단을 3개 이상 가지는)설명변수가 2개 이상인 경우에는 일원분산 분석이 아닌 <strong>이원분산분석(Two-way ANOVA)</strong>를 이용하여 집단간 평균의 차이가 존재하는지에 대해서 검정을 진행해야 한다.</p></li>
<li><p>이원분산분석을 통해 집단간 평균의 차이를 살펴보고자 할 때, 사용하는 2개 이상의 설명변수들을 <strong>주효과</strong>라고 하며, 이러한 주효과들이 서로 영향을 받으면서 나타는 효과를 <strong>교호작용</strong>이라고 한다. 일원분산분석과 달리 이원분산분석은 교호작용을 반드시 분석을 진행할 때 고려해 주어야한다.</p></li>
<li><p>이원분산분석 역시 일원분산분석과 같이 <strong>정규성</strong>, <strong>독립성</strong>, <strong>등분산성</strong> 3가지의 기본 가정을 가지고 분석을 진행한다.</p></li>
<li><p>R에서는 <code>aov</code>함수를 이용하여 분산분석을 진행할 수 있다고 했는데, 이원분산분석 또한 <code>aov</code>함수를 이용하여 진행할 수 있다. <code>(반응변수 ~ 설명변수 * 설명변수,data)</code>의 형태로 Formula를 지정하게 되면 <strong>이원분산분석</strong>과 더불어 주효과 간 교호작용의 유의성 까지 확인할 수 있다.</p></li>
<li><p><code>aov</code>에 사용되는 formula를 <code>interactionw2t</code>함수에 지정하게 되면 각 주효과에 따른 반응변수의 <em>boxplot</em>과 교호작용 plot까지 확인할 수 있기 때문에 데이터 탐색에 꽤나 유용하게 사용할 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap13-design-of-experiments---factorial-desings" class="section level1">
<h1>Chap13 Design of Experiments - Factorial Desings</h1>
<p><strong>삼원분산분석(Three-way ANOVA)</strong>는 앞서 우리가 살펴본 이원분산분석(Two-Way ANOVA)과 달리 <strong>독립변수가 3개</strong> 이상인 분산분석을 일컫는다.<br />
앞서 우리가 진행했던 이원분산분석에서는 두 독립변수간의 교호작용만을 고려했다.</p>
<p>하지만, 삼원분산분석의 경우, 독립변수가 3개 이상이기 때문에 두 독립변수간 교호작용이 3개 이상이 나올 수 있다.<br />
또한, 독립변수 3개에 대한 교호작용도 살펴봐야한다.</p>
<p>주효과와 교호작용에 대한 귀무가설과 대립가설은 앞서 살펴본 분산분석들과 동일하다.</p>
<p><strong>주효과의 대립가설</strong></p>
<ul>
<li>H0: 독립변수 A에 따른 종속변수 B에 대하여 평균차이가 없다.<br />
</li>
<li>H1: 독립변수 A에 따른 종속변수 B에 대하여 평균차이가 있다.</li>
</ul>
<p><strong>교호작용의 대립가설</strong></p>
<ul>
<li>H0: 독립변수간 교호작용 효과가 존재하지 않는다.<br />
</li>
<li>H1: 독립변수간 교호작용 효과가 존재한다.</li>
</ul>
<div id="a-three-way-anova---muscle-data" class="section level2">
<h2>13.1 A Three-Way ANOVA - Muscle Data</h2>
<p><code>cc176</code>은 근육 데이터로 구성된 데이터로, <code>HH</code>패키지 안에 내장돼있다.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cc176&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="#cb678-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(wt.d<span class="sc">~</span>wt.n<span class="sc">|</span>n.treats<span class="sc">*</span>current,<span class="at">data=</span>cc176,<span class="at">group=</span>minutes,</span>
<span id="cb678-2"><a href="#cb678-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel=</span><span class="cf">function</span>(x,y,...) {</span>
<span id="cb678-3"><a href="#cb678-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.superpose</span>(x,y,...)</span>
<span id="cb678-4"><a href="#cb678-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.abline</span>(<span class="fu">lm</span>(cc176<span class="sc">$</span>wt.d <span class="sc">~</span> cc176<span class="sc">$</span>wt.n))})</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-287-1.png" width="960" /></p>
<p><code>cc176</code>의 <strong>group(n.treats,current)</strong>에 대한 EDA를 진행하기 위해 <code>xyplot</code>함수를 사용하여 그림을 그렸다.<br />
또한, 공변량에 대해 회귀직선을 표시했으며, 회귀직선이 양의 기울기를 가지는 것으로 보아 변수간 효과가 있는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="do">## y=wt.d with x=wt.n as covariate</span></span>
<span id="cb679-2"><a href="#cb679-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (get essentially the same ANOVA as the approximate (y-bx)^2)</span></span>
<span id="cb679-3"><a href="#cb679-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ANOVA table in Cochran and Cox)</span></span>
<span id="cb679-4"><a href="#cb679-4" aria-hidden="true" tabindex="-1"></a>cc176.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.d<span class="sc">~</span>rep<span class="sc">+</span>wt.n<span class="sc">+</span>n.treats<span class="sc">*</span>minutes<span class="sc">*</span>current,<span class="at">data=</span>cc176)</span>
<span id="cb679-5"><a href="#cb679-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cc176.aov)</span></code></pre></div>
<pre><code>##                          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## rep                       1  605.0   605.0  12.582 0.000909 ***
## wt.n                      1 1334.1  1334.1  27.744 3.57e-06 ***
## n.treats                  2  438.9   219.4   4.563 0.015566 *  
## minutes                   3  183.9    61.3   1.275 0.294092    
## current                   3 2114.4   704.8  14.657 7.82e-07 ***
## n.treats:minutes          6  198.4    33.1   0.688 0.660507    
## n.treats:current          6  491.5    81.9   1.704 0.141632    
## minutes:current           9  382.6    42.5   0.884 0.546266    
## n.treats:minutes:current 18 1021.6    56.8   1.180 0.315421    
## Residuals                46 2212.0    48.1                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>3개의 변수(<strong>n.treats</strong>,<strong>minutes</strong>,<strong>current</strong>)를 교호작용으로 지정하여 분산분석을 진행하였다.</p>
<p>분산분석 결과, minutes를 제외한 모든 주효과는 유의확률이 유의수준보다 작으므로, ’유의한 차이가 존재하는 집단이 적어도 한 집단 이상이다.’는 결과를 얻을 수 있었다.</p>
<p>교호작용의 결과를 살펴본 결과, 유의한 교호작용은 존재하지 않았다.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(wt.d<span class="sc">~</span>n.treats<span class="sc">*</span>minutes<span class="sc">*</span>current,<span class="at">data=</span>cc176)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-289-1.png" width="960" /></p>
<p><code>interaction2wt</code> 함수를 통해 3개의 교호작용에 대한 plotㅇ르 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="#cb682-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cc176.aov,</span>
<span id="cb682-2"><a href="#cb682-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">split=</span><span class="fu">list</span>(<span class="at">n.treats=</span><span class="fu">list</span>(<span class="at">n.treats.lin=</span><span class="dv">1</span>,</span>
<span id="cb682-3"><a href="#cb682-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n.treats.quad=</span><span class="dv">2</span>)),</span>
<span id="cb682-4"><a href="#cb682-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">expand.split=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##                           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## rep                        1  605.0   605.0  12.582 0.000909 ***
## wt.n                       1 1334.1  1334.1  27.744 3.57e-06 ***
## n.treats                   2  438.9   219.4   4.563 0.015566 *  
##   n.treats: n.treats.lin   1  438.2   438.2   9.114 0.004129 ** 
##   n.treats: n.treats.quad  1    0.6     0.6   0.013 0.910476    
## minutes                    3  183.9    61.3   1.275 0.294092    
## current                    3 2114.4   704.8  14.657 7.82e-07 ***
## n.treats:minutes           6  198.4    33.1   0.688 0.660507    
## n.treats:current           6  491.5    81.9   1.704 0.141632    
## minutes:current            9  382.6    42.5   0.884 0.546266    
## n.treats:minutes:current  18 1021.6    56.8   1.180 0.315421    
## Residuals                 46 2212.0    48.1                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>n.treats</strong> 변수에 대하여 2차 방정식을 적용하여 결과를 살펴보았다.</p>
<p><strong>n.treats</strong>를 2차로 변환하게 되면 유의하지 않게 변하는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true" tabindex="-1"></a><span class="do">## adjust y for x</span></span>
<span id="cb684-3"><a href="#cb684-3" aria-hidden="true" tabindex="-1"></a>cc176<span class="sc">$</span>y.adj <span class="ot">&lt;-</span> cc176<span class="sc">$</span>wt.d <span class="sc">-</span></span>
<span id="cb684-4"><a href="#cb684-4" aria-hidden="true" tabindex="-1"></a>  (cc176<span class="sc">$</span>wt.n <span class="sc">-</span> <span class="fu">mean</span>(cc176<span class="sc">$</span>wt.n))<span class="sc">*</span><span class="fu">coef</span>(cc176.aov)[<span class="st">&quot;wt.n&quot;</span>]</span></code></pre></div>
<p>cc176의 y변수인 <code>wt.d</code>에 대하여 분산분석을 통해 얻어진 평균과 회귀계수를 통해 값을 조정해주었다.</p>
<hr />
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1" aria-hidden="true" tabindex="-1"></a><span class="do">## duplicate CC Table 5.17</span></span>
<span id="cb685-2"><a href="#cb685-2" aria-hidden="true" tabindex="-1"></a>cc176.means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(cc176<span class="sc">$</span>y.adj,</span>
<span id="cb685-3"><a href="#cb685-3" aria-hidden="true" tabindex="-1"></a>                      cc176[,<span class="fu">c</span>(<span class="st">&quot;current&quot;</span>,<span class="st">&quot;n.treats&quot;</span>)],mean)</span>
<span id="cb685-4"><a href="#cb685-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb685-5"><a href="#cb685-5" aria-hidden="true" tabindex="-1"></a>cc176.means</span></code></pre></div>
<pre><code>##           n.treats
## current           1        3        6
##   galvanic 56.03380 59.08068 65.28547
##   faradic  59.94734 55.79464 57.27463
##   60.cycle 63.25526 63.92297 68.57735
##   25.cycle 64.47088 71.78380 73.19818</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="#cb687-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(cc176.means,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">mean</span>(x))</span></code></pre></div>
<pre><code>## galvanic  faradic 60.cycle 25.cycle 
## 60.13332 57.67220 65.25186 69.81762</code></pre>
<p><code>tapply</code>를 통해 <strong>current</strong>, <strong>n.treats</strong>에 따른 조정된 y의 평균 값을 살펴볼 수 있다.</p>
<p><code>apply</code>를 사용하여 옵션을 1로 지정하면 (행에 대한 함수 적용) <strong>current</strong>에 따른 평균만을 얻을수도 있다.</p>
<hr />
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="#cb689-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(y.adj<span class="sc">~</span>current<span class="sc">*</span>n.treats,<span class="at">data=</span>cc176)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-293-1.png" width="960" /></p>
<p>조정된 y값에 대해서 <strong>ntreats, current</strong>의 교호작용 그림을 그려주었다.</p>
<p>교호작용 패널들에서 교차점이 몇 개 보이지만, 대부분 평행을 이루기 때문에 교호작용은 유의하지 않은 것을 알 수 있다.</p>
<hr />
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(y.adj<span class="sc">~</span>current,<span class="at">data=</span>cc176,<span class="at">main=</span><span class="st">&quot;Boxplots for adjusted weights&quot;</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb690-2"><a href="#cb690-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">box.rectangle=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb690-3"><a href="#cb690-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">box.umbrella=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-294-1.png" width="960" /></p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(y.adj<span class="sc">~</span>minutes<span class="sc">|</span>n.treats<span class="sc">*</span>current,<span class="at">data=</span>cc176,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb691-2"><a href="#cb691-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">box.rectangle=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb691-3"><a href="#cb691-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">box.umbrella=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-295-1.png" width="960" /></p>
<p>조정된 값 y에 대한 minutes의 boxplot을 그려주었다.<br />
<strong>ntreats,current</strong>을 그룹변수로 하여 두 개의 그룹변수에 따라 <strong>boxplot</strong>을 나누어 그려주었다.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a>cc176t <span class="ot">&lt;-</span> cc176</span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(cc176t))</span>
<span id="cb692-3"><a href="#cb692-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.factor</span>(cc176t[[i]]))</span>
<span id="cb692-4"><a href="#cb692-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">contrasts</span>(cc176t[[i]]) <span class="ot">&lt;-</span></span>
<span id="cb692-5"><a href="#cb692-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contr.treatment</span>(<span class="fu">length</span>(<span class="fu">levels</span>(cc176t[[i]])))</span>
<span id="cb692-6"><a href="#cb692-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(cc176t,class)</span></code></pre></div>
<pre><code>## $wt.d
## [1] &quot;numeric&quot;
## 
## $wt.n
## [1] &quot;numeric&quot;
## 
## $n.treats
## [1] &quot;positioned&quot; &quot;ordered&quot;    &quot;factor&quot;    
## 
## $current
## [1] &quot;positioned&quot; &quot;ordered&quot;    &quot;factor&quot;    
## 
## $minutes
## [1] &quot;positioned&quot; &quot;ordered&quot;    &quot;factor&quot;    
## 
## $rep
## [1] &quot;factor&quot;
## 
## $y.adj
## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a>cc176t.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.d <span class="sc">~</span> rep <span class="sc">+</span> wt.n <span class="sc">+</span> n.treats <span class="sc">+</span></span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true" tabindex="-1"></a>                    wt.n<span class="sc">*</span>current,<span class="at">data=</span>cc176t)</span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cc176t.aov)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## rep           1    605   605.0  14.192 0.000304 ***
## wt.n          1   1334  1334.1  31.293 2.65e-07 ***
## n.treats      2    439   219.4   5.147 0.007763 ** 
## current       3   2114   704.7  16.531 1.51e-08 ***
## wt.n:current  3    867   288.8   6.775 0.000376 ***
## Residuals    85   3624    42.6                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>앞서 진행한 분산분석과 다르게 주효과왁 교호작용을 지정해주었다.<br />
주효과는 모두 유의확률이 유의수준보다 작으므로 유의한 집단이 적어도 하나 존재하는 것을 알 수 있다.<br />
교호작용인 <strong>wt.n:current</strong> 또한 유의확률이 0.000376으로 두 변수의 교호작용은 유의한 것을 알 수 있다.</p>
<hr />
<p><strong>current</strong> 변수에 대한 다중비교를 진행하고 원하는 집단 간 차이를 살펴보기 위해 <strong>contrast matrix</strong>를 만들어 주었다.</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a>cc176<span class="sc">$</span>current <span class="ot">&lt;-</span> <span class="fu">factor</span>(cc176<span class="sc">$</span>current,<span class="at">levels=</span><span class="fu">unique</span>(cc176<span class="sc">$</span>current),<span class="at">ordered=</span><span class="cn">FALSE</span>)</span>
<span id="cb696-2"><a href="#cb696-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cc176<span class="sc">$</span>current)</span></code></pre></div>
<pre><code>## [1] galvanic faradic  60.cycle 25.cycle
## Levels: galvanic faradic 60.cycle 25.cycle</code></pre>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a>current.lmat <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="st">&quot;gf-cc&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb698-2"><a href="#cb698-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;25-60&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb698-3"><a href="#cb698-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;g-f&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb698-4"><a href="#cb698-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(current.lmat)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">levels</span>(cc176<span class="sc">$</span>current)</span>
<span id="cb698-5"><a href="#cb698-5" aria-hidden="true" tabindex="-1"></a>cc176_current.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y.adj<span class="sc">~</span>current,<span class="at">data=</span>cc176)</span>
<span id="cb698-6"><a href="#cb698-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mmc</span>(cc176_current.aov,<span class="at">focus=</span><span class="st">&quot;current&quot;</span>,<span class="at">focus.lmat =</span> current.lmat)</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = y.adj ~ current, data = cc176) 
## Estimated Quantile = 2.619305 
## 95% family-wise confidence level
## $mca
##                    estimate   stderr      lower     upper   height
## 25.cycle-60.cycle  4.565762 2.123892 -0.9973578 10.128882 67.53474
## 25.cycle-galvanic  9.684305 2.123892  4.1211848 15.247425 64.97547
## 25.cycle-faradic  12.145417 2.123892  6.5822966 17.708536 63.74491
## 60.cycle-galvanic  5.118543 2.123892 -0.4445773 10.681663 62.69259
## 60.cycle-faradic   7.579654 2.123892  2.0165345 13.142774 61.46203
## galvanic-faradic   2.461112 2.123892 -3.1020081  8.024232 58.90276
## $none
##          estimate   stderr    lower    upper   height
## 25.cycle 69.81762 1.501818 65.88390 73.75134 69.81762
## 60.cycle 65.25186 1.501818 61.31814 69.18558 65.25186
## galvanic 60.13332 1.501818 56.19960 64.06704 60.13332
## faradic  57.67220 1.501818 53.73848 61.60592 57.67220
## $lmat
##       estimate   stderr      lower     upper   height
## 25-60 4.565762 2.123892 -0.9973578 10.128882 67.53474
## gf-cc 8.631980 1.501818  4.6982598 12.565699 63.21875
## g-f   2.461112 2.123892 -3.1020081  8.024232 58.90276</code></pre>
<p><strong>current</strong>변수에 따른 다중비교 결과와 우리가 설정한 집단 간 평균차이 결과를 볼 수 있다.</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(<span class="fu">mmc</span>(cc176_current.aov,<span class="at">focus=</span><span class="st">&quot;current&quot;</span>,<span class="at">focus.lmat =</span> current.lmat))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-298-1.png" width="960" /></p>
<p><code>mmcplolt</code>을 통해서 살펴본 결과 평균차이가 유의하게 나타나는 집단은 다음과 같다.<br />
<strong>25.cycle-galavnic</strong>, <strong>25.cycle-faradic</strong>, <strong>60.cycle-faradic</strong></p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(<span class="fu">mmc</span>(cc176_current.aov,<span class="at">focus=</span><span class="st">&quot;current&quot;</span>,<span class="at">focus.lmat =</span> current.lmat),<span class="at">type=</span><span class="st">&quot;lmat&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-299-1.png" width="960" /></p>
<p><code>type=lmat</code>옵션을 이용하여 우리가 설정한 집단 간 차이를 살펴본 결과, 유의한 차이가 나타나는 집단은 <strong>gf-cc</strong> 하나뿐 이었다.</p>
<div id="example---latin-square" class="section level3">
<h3>13.1.1 Example - Latin Square</h3>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tires)</span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="fu">bwplot</span>(wear<span class="sc">~</span>car,<span class="at">data=</span>tires,<span class="at">main=</span><span class="st">&quot;car&quot;</span>)</span>
<span id="cb702-4"><a href="#cb702-4" aria-hidden="true" tabindex="-1"></a>b2<span class="ot">&lt;-</span><span class="fu">bwplot</span>(wear<span class="sc">~</span>position,<span class="at">data=</span>tires,<span class="at">main=</span><span class="st">&quot;position&quot;</span>)</span>
<span id="cb702-5"><a href="#cb702-5" aria-hidden="true" tabindex="-1"></a>b3<span class="ot">&lt;-</span><span class="fu">bwplot</span>(wear<span class="sc">~</span>brand,<span class="at">data=</span>tires,<span class="at">main=</span><span class="st">&quot;tires&quot;</span>)</span>
<span id="cb702-6"><a href="#cb702-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-7"><a href="#cb702-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-8"><a href="#cb702-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b1,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb702-9"><a href="#cb702-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b2,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb702-10"><a href="#cb702-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b3,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">more=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-300-1.png" width="960" /></p>
<p><strong>tires</strong>데이터에 대한 시각적 탐색을 위해 <code>boxplot</code>을 그렸다.<br />
<strong>car</strong> 변수의 경우, 숫자가 커질수록 wear의 값이 낮아지는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true" tabindex="-1"></a>tires.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wear<span class="sc">~</span> car<span class="sc">+</span>position<span class="sc">+</span>brand,<span class="at">data=</span>tires)</span>
<span id="cb703-2"><a href="#cb703-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tires.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## car          3  38.69  12.896  14.395 0.00378 **
## position     3   6.19   2.062   2.302 0.17695   
## brand        3  30.69  10.229  11.419 0.00683 **
## Residuals    6   5.38   0.896                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><code>tires</code>데이터에 대한 분산분석 진행결과, <strong>position</strong> 변수를 제외한 두 <strong>car,brand</strong> 주효과 변수가 유의한 것을 알 수 있다.<br />
따라서, 두 주효과 집단에서는 유의한 차이가 발생하는 집단이 적어도 하나 존재한다.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(tires<span class="sc">$</span>wear,tires<span class="sc">$</span>car,<span class="cf">function</span>(x) <span class="fu">mean</span>(x))</span></code></pre></div>
<pre><code>##     1     2     3     4 
## 14.00 12.75 11.75  9.75</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(tires<span class="sc">$</span>wear,tires<span class="sc">$</span>position,<span class="cf">function</span>(x) <span class="fu">mean</span>(x))</span></code></pre></div>
<pre><code>##     1     2     3     4 
## 11.00 12.50 12.50 12.25</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(tires<span class="sc">$</span>wear,tires<span class="sc">$</span>brand,<span class="cf">function</span>(x) <span class="fu">mean</span>(x))</span></code></pre></div>
<pre><code>##     1     2     3     4 
## 14.25 12.25 10.75 11.00</code></pre>
<p><code>tapply</code>함수를 적용하여 <strong>tires</strong>의 각 변수에 대한 평균을 구해주었다.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a>tires.mmc.brand <span class="ot">&lt;-</span> <span class="fu">mmc</span>(tires.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">brand=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb711-2"><a href="#cb711-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-3"><a href="#cb711-3" aria-hidden="true" tabindex="-1"></a>tires.mmc.brand</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = wear ~ car + position + brand, data = tires) 
## Estimated Quantile = 3.461199 
## 95% family-wise confidence level
## $mca
##     estimate    stderr      lower    upper height
## 1-2     2.00 0.6692658 -0.3164619 4.316462 13.250
## 1-4     3.25 0.6692658  0.9335381 5.566462 12.625
## 1-3     3.50 0.6692658  1.1835381 5.816462 12.500
## 2-4     1.25 0.6692658 -1.0664619 3.566462 11.625
## 2-3     1.50 0.6692658 -0.8164619 3.816462 11.500
## 4-3     0.25 0.6692658 -2.0664619 2.566462 10.875
## $none
##   estimate    stderr     lower    upper height
## 1    14.25 0.4732424 12.612014 15.88799  14.25
## 2    12.25 0.4732424 10.612014 13.88799  12.25
## 4    11.00 0.4732424  9.362014 12.63799  11.00
## 3    10.75 0.4732424  9.112014 12.38799  10.75</code></pre>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(tires.mmc.brand)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-303-1.png" width="960" /></p>
<p><strong>brand</strong>변수에 대한 다중비교를 진행하였다.<br />
1-4, 1-3집단이 신뢰구간 0을 포함하지 않고 다중비교 plot에서 붉은색으로 지정된 것으로 보아 유의한 차이가 있는 집단인 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="#cb714-1" aria-hidden="true" tabindex="-1"></a>brand.lmat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;1-43&quot;</span> <span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb714-2"><a href="#cb714-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;4-3&quot;</span> <span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb714-3"><a href="#cb714-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;143-2&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb714-4"><a href="#cb714-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-5"><a href="#cb714-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(brand.lmat)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">levels</span>(tires<span class="sc">$</span>brand)</span>
<span id="cb714-6"><a href="#cb714-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-7"><a href="#cb714-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-8"><a href="#cb714-8" aria-hidden="true" tabindex="-1"></a>tires.mmc.brand2 <span class="ot">&lt;-</span> <span class="fu">mmc</span>(tires.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">brand=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb714-9"><a href="#cb714-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">focus.lmat =</span> brand.lmat)</span>
<span id="cb714-10"><a href="#cb714-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-11"><a href="#cb714-11" aria-hidden="true" tabindex="-1"></a>tires.mmc.brand2</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = wear ~ car + position + brand, data = tires) 
## Estimated Quantile = 3.466618 
## 95% family-wise confidence level
## $mca
##     estimate    stderr      lower    upper height
## 1-2     2.00 0.6692658 -0.3200888 4.320089 13.250
## 1-4     3.25 0.6692658  0.9299112 5.570089 12.625
## 1-3     3.50 0.6692658  1.1799112 5.820089 12.500
## 2-4     1.25 0.6692658 -1.0700888 3.570089 11.625
## 2-3     1.50 0.6692658 -0.8200888 3.820089 11.500
## 4-3     0.25 0.6692658 -2.0700888 2.570089 10.875
## $none
##   estimate    stderr     lower    upper height
## 1    14.25 0.4732424 12.609449 15.89055  14.25
## 2    12.25 0.4732424 10.609449 13.89055  12.25
## 4    11.00 0.4732424  9.359449 12.64055  11.00
## 3    10.75 0.4732424  9.109449 12.39055  10.75
## $lmat
##       estimate    stderr     lower    upper  height
## 1-43     3.375 0.5796012  1.365744 5.384256 12.5625
## 2-143    0.250 0.5464532 -1.644345 2.144345 12.1250
## 4-3      0.250 0.6692658 -2.070089 2.570089 10.8750</code></pre>
<p>원하는 집단 간 차이를 살펴보기 위해 contrast matrix를 만들어 주었다.<br />
<strong>1-43</strong> 집단만이 신뢰구간 0을 포함하지 않으므로 유의한 차이가 있는 집단인 것을 알 수 있다.</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(tires.mmc.brand2,<span class="at">type=</span><span class="st">&quot;lmat&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-305-1.png" width="960" /></p>
<p><code>mmcplot</code>에서도 유의한 집단 간 차익가 있는 <strong>1-43</strong> 집단이 붉은색으로 지정된 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a>tires.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wear <span class="sc">~</span> car <span class="sc">+</span> position <span class="sc">+</span> brand, <span class="at">data=</span>tires)</span>
<span id="cb717-2"><a href="#cb717-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-3"><a href="#cb717-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tires.aov,<span class="at">split=</span><span class="fu">list</span>(<span class="at">brand=</span><span class="fu">list</span>(<span class="st">&quot;1-43&quot;</span><span class="ot">=</span><span class="dv">1</span>,<span class="at">rest=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## car            3  38.69  12.896  14.395 0.00378 **
## position       3   6.19   2.062   2.302 0.17695   
## brand          3  30.69  10.229  11.419 0.00683 **
##   brand: 1-43  1   0.19   0.187   0.209 0.66341   
##   brand: rest  2  30.50  15.250  17.023 0.00336 **
## Residuals      6   5.38   0.896                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="example-the-filemcoat-data" class="section level3">
<h3>13.1.2 Example = The filemcoat Data</h3>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(filmcoat)</span></code></pre></div>
<p><strong>filmcoat</strong>는 다음과 같은 데이터로 구성돼있다.<br />
* temprt: 3개의 수준으로 구성된 온도.<br />
* pressure: 3개의 수준으로 구성된 압력.<br />
* coat: 필름의 두께</p>
</div>
<div id="data-analysis" class="section level3">
<h3>13.1.3 Data analysis</h3>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="#cb720-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(coat<span class="sc">~</span>pressure<span class="sc">|</span>pressure<span class="sc">+</span>temprt,<span class="at">data=</span>filmcoat)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-308-1.png" width="960" /></p>
<p>시각적 탐색을 위해 <strong>filmcoat</strong>에 대한 <code>bwplot</code>을 이용하여 <strong>boxplot</strong>을 그려주었다.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb721-2"><a href="#cb721-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acast</span>(filmcoat,temprt<span class="sc">~</span>pressure,mean,<span class="at">value.var=</span><span class="st">&quot;coat&quot;</span>,<span class="at">margins=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##           p.low    p.med   p.high    (all)
## t.low  41.33333 44.33333 45.33333 43.66667
## t.med  35.66667 38.33333 40.00000 38.00000
## t.high 37.33333 34.66667 41.00000 37.66667
## (all)  38.11111 39.11111 42.11111 39.77778</code></pre>
<p><code>acast</code>함수를 이용하여 <strong>filmcoat</strong>데이터에 대한 평균을 한 눈에 보기 쉽게 정리할 수 있다.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a>film.aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(coat <span class="sc">~</span> temprt<span class="sc">*</span>pressure,<span class="at">data=</span>filmcoat)</span>
<span id="cb723-2"><a href="#cb723-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(film.aov1)</span></code></pre></div>
<pre><code>##                 Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## temprt           2 204.67  102.33  47.638 6.46e-08 ***
## pressure         2  78.00   39.00  18.155 4.83e-05 ***
## temprt:pressure  4  37.33    9.33   4.345   0.0124 *  
## Residuals       18  38.67    2.15                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>filmcoat</strong>에 대한 분산분석을 진행한 결과, 주효과와 교호작용이 모두 유의한 결과를 나타내는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(coat<span class="sc">~</span>temprt<span class="sc">*</span>pressure,<span class="at">data=</span>filmcoat,<span class="at">simple=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-311-1.png" width="960" /></p>
<p><strong>filmcoat</strong>의 교호작용 패널을 살펴보면 직선이 평행하지 않으며 교차점을 가지는 것으로 보아 교호작용이 어느정도 유의함을 알 수 있다.</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="#cb726-1" aria-hidden="true" tabindex="-1"></a>film.mmc1 <span class="ot">&lt;-</span> <span class="fu">mmc</span>(film.aov1,<span class="at">focus=</span><span class="st">&quot;pressure&quot;</span>)</span>
<span id="cb726-2"><a href="#cb726-2" aria-hidden="true" tabindex="-1"></a>film.mmc1</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = coat ~ temprt * pressure, data = filmcoat) 
## Estimated Quantile = 2.551162 
## 95% family-wise confidence level
## $mca
##              estimate   stderr     lower    upper   height
## p.high-p.med        3 0.690917  1.237359 4.762641 40.61111
## p.high-p.low        4 0.690917  2.237359 5.762641 40.11111
## p.med-p.low         1 0.690917 -0.762641 2.762641 38.61111
## $none
##        estimate    stderr    lower    upper   height
## p.high 42.11111 0.4885521 40.86474 43.35749 42.11111
## p.med  39.11111 0.4885521 37.86474 40.35749 39.11111
## p.low  38.11111 0.4885521 36.86474 39.35749 38.11111</code></pre>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="#cb728-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(film.mmc1,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-313-1.png" width="960" /></p>
<p><code>pressure</code>변수에 대한 다중비교를 진행한 결과, <strong>p.high-p.med,p.high-p.low</strong>의 집단 간 평균차이가 유의한 것을 알 수 있었다.</p>
</div>
</div>
<div id="nested-factorial-experiment" class="section level2">
<h2>13.2 Nested Factorial Experiment</h2>
<div id="example-gunload-data" class="section level3">
<h3>13.2.1 Example-Gunload Data</h3>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gunload)</span>
<span id="cb729-2"><a href="#cb729-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(rounds<span class="sc">~</span>method<span class="sc">|</span>method<span class="sc">+</span>group,<span class="at">data=</span>gunload)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-314-1.png" width="960" /></p>
<p><strong>gunload</strong>데이터에 대해서 <strong>method,group</strong> 그룹 변수로 <strong>rouns</strong>를 종속변수로 지정하여 <code>boxplot</code>을 그렸다.</p>
</div>
<div id="example-turkey-data-continnued" class="section level3">
<h3>13.2.2 Example-Turkey Data (Continnued)</h3>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>gunload.aov <span class="ot">&lt;-</span></span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(rounds <span class="sc">~</span> method<span class="sc">*</span>group <span class="sc">+</span> <span class="fu">Error</span>((team <span class="sc">%in%</span> group)<span class="sc">/</span>method),<span class="at">data=</span>gunload)</span></code></pre></div>
<pre><code>## Warning in aov(rounds ~ method * group + Error((team %in% group)/
## method), : Error() model is singular</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gunload.aov)</span></code></pre></div>
<pre><code>## 
## Error: team:group
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## group      2  16.05   8.026   1.227  0.358
## Residuals  6  39.26   6.543               
## 
## Error: team:group:method
##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## method        1  652.0   652.0 364.841 1.33e-06 ***
## method:group  2    1.2     0.6   0.332     0.73    
## Residuals     6   10.7     1.8                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error: Within
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals 18  41.59   2.311</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(gunload.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 19.33333 
## 
##  method 
## method
##    new    old 
## 23.589 15.078 
## 
##  group 
## group
##  slight average   heavy 
##  20.125  19.383  18.492 
## 
##  method:group 
##       group
## method slight average heavy 
##    new 24.350 23.433  22.983
##    old 15.900 15.333  14.000</code></pre>
<p>gunload데이터에 대한 분산분석을 진행하였다.<br />
분산분석 진행에 대해서 Error term이 의미하는 바는, team을 제외한 주효과는 모두 <strong>Random인자</strong>로 설정하겠다는 의미이다.</p>
<p>또한, Error가 분수의 형태로 돼있으므로 metohd -&gt; group -&gt; team의 형태로 nested 된다는 것을 나타낸다.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(turkey)</span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true" tabindex="-1"></a>turkey[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">25</span>),]</span></code></pre></div>
<pre><code>##       diet wt.gain
## 1  control     4.1
## 7       A1     5.2
## 13      A2     6.3
## 19      B1     6.5
## 25      B2     9.5</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a>turkey<span class="sc">$</span>trt.vs.control <span class="ot">&lt;-</span></span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;control&quot;</span>,<span class="st">&quot;treatment&quot;</span>),<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">24</span>)))</span>
<span id="cb738-3"><a href="#cb738-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>trt.vs.control) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb738-4"><a href="#cb738-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-5"><a href="#cb738-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-6"><a href="#cb738-6" aria-hidden="true" tabindex="-1"></a>turkey<span class="sc">$</span>additive <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;control&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>),<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">12</span>)),</span>
<span id="cb738-7"><a href="#cb738-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;control&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>))</span>
<span id="cb738-8"><a href="#cb738-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-9"><a href="#cb738-9" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>additive) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb738-10"><a href="#cb738-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-11"><a href="#cb738-11" aria-hidden="true" tabindex="-1"></a>turkey<span class="sc">$</span>amount <span class="ot">&lt;-</span> <span class="fu">factor</span>((<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>))))</span>
<span id="cb738-12"><a href="#cb738-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-13"><a href="#cb738-13" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>amount) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb738-14"><a href="#cb738-14" aria-hidden="true" tabindex="-1"></a>turkey[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">25</span>),]</span></code></pre></div>
<pre><code>##       diet wt.gain trt.vs.control additive amount
## 1  control     4.1        control  control      0
## 7       A1     5.2      treatment        A      1
## 13      A2     6.3      treatment        A      2
## 19      B1     6.5      treatment        B      1
## 25      B2     9.5      treatment        B      2</code></pre>
<p><code>trt.vs.control</code>변수는 <strong>diet</strong>변수가 <strong>control</strong>이면 control, 나머지에 대해서는 <strong>treatment</strong>를 반환한다.</p>
<p><code>additive</code>의 경우 <strong>control</strong> = control, <strong>A</strong> = A, <strong>B</strong> = B를 반환한다.</p>
<p><code>amount</code>변수는 <strong>control</strong> = 0, <em>diet</em> 변수의 마지막 숫자가 1이면 1, 2면 2를 반환한다.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="#cb740-1" aria-hidden="true" tabindex="-1"></a>turkey3.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain <span class="sc">~</span> trt.vs.control <span class="sc">/</span> (additive<span class="sc">*</span>amount),<span class="at">data=</span>turkey,<span class="at">x=</span><span class="cn">TRUE</span>)</span>
<span id="cb740-2"><a href="#cb740-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey3.aov)</span></code></pre></div>
<pre><code>##                                Df Sum Sq Mean Sq F value   Pr(&gt;F)
## trt.vs.control                  1  56.58   56.58 179.395 6.58e-13
## trt.vs.control:additive         1  22.81   22.81  72.337 7.56e-09
## trt.vs.control:amount           1  22.43   22.43  71.105 8.88e-09
## trt.vs.control:additive:amount  1   1.21    1.21   3.852   0.0609
## Residuals                      25   7.88    0.32                 
##                                   
## trt.vs.control                 ***
## trt.vs.control:additive        ***
## trt.vs.control:amount          ***
## trt.vs.control:additive:amount .  
## Residuals                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>앞서 우리가 설정한 변수와 control, treatment에 대해서 분산분석을 진행하였다.<br />
control과 treatment 집단 간은 유의한 차이가 있음을 알 수 있고 <strong>additive,amount</strong> 또한 집단 간 유의한 차이가 있는 것을 확인할 수 있다. 교호작용의 유의확률은 0.0609로 유의수준 0.05보다 높으므로 유의하지 않다.<br />
하지만, 0.05에 매우 가까운 값을 가지므로 유의수준에 따라 유의하다고 해석할 수도 있다.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">na.print=</span><span class="st">&quot;&quot;</span>,<span class="fu">tapply</span>(turkey<span class="sc">$</span>wt.gain,turkey[,<span class="fu">c</span>(<span class="st">&quot;additive&quot;</span>,<span class="st">&quot;amount&quot;</span>)],mean))</span></code></pre></div>
<pre><code>##          amount
## additive         0   1        2
##   control 3.783333             
##   A                5.5 6.983333
##   B                7.0 9.383333</code></pre>
<p><em>treatment</em>에 따른 <strong>amount,additive</strong>에 대한 평균을 <code>tapply</code> 함수를 이용하여 구해주었다.</p>
</div>
</div>
<div id="specification-of-model-formulas" class="section level2">
<h2>13.3 Specification of Model Formulas</h2>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(abc)</span>
<span id="cb744-2"><a href="#cb744-2" aria-hidden="true" tabindex="-1"></a>abc</span></code></pre></div>
<pre><code>##     A B  AB BwA     y
## r.w r w r.w   c -0.02
## r.x r x r.x   d  1.19
## r.y r y r.y   e -0.02
## r.z r z r.z   f  0.23
## s.w s w s.w   g  0.67
## s.x s x s.x   h  1.95
## s.y s y s.y   i -0.71
## s.z s z s.z   j -0.40
## t.w t w t.w   k -0.56
## t.x t x t.x   l  0.01
## t.y t y t.y   m  0.13
## t.z t z t.z   n  1.19</code></pre>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true" tabindex="-1"></a>abc.oneway <span class="ot">&lt;-</span> <span class="fu">with</span>(abc,<span class="fu">matrix</span>(y,<span class="dv">4</span>,<span class="dv">3</span>,<span class="at">dimnames=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">A=</span><span class="fu">unique</span>(A))))</span>
<span id="cb746-2"><a href="#cb746-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-3"><a href="#cb746-3" aria-hidden="true" tabindex="-1"></a>abc.oneway</span></code></pre></div>
<pre><code>##    A
##         r     s     t
##   1 -0.02  0.67 -0.56
##   2  1.19  1.95  0.01
##   3 -0.02 -0.71  0.13
##   4  0.23 -0.40  1.19</code></pre>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="#cb748-1" aria-hidden="true" tabindex="-1"></a>abc.crossed <span class="ot">&lt;-</span> <span class="fu">with</span>(abc,<span class="fu">matrix</span>(y,<span class="dv">3</span>,<span class="dv">4</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb748-2"><a href="#cb748-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">dimnames=</span><span class="fu">list</span>(<span class="at">A=</span><span class="fu">unique</span>(A),<span class="at">B=</span><span class="fu">unique</span>(B))))</span>
<span id="cb748-3"><a href="#cb748-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb748-4"><a href="#cb748-4" aria-hidden="true" tabindex="-1"></a>abc.crossed</span></code></pre></div>
<pre><code>##    B
## A       w    x     y     z
##   r -0.02 1.19 -0.02  0.23
##   s  0.67 1.95 -0.71 -0.40
##   t -0.56 0.01  0.13  1.19</code></pre>
<p>abc데이터에 대해서 <strong>abc.oneway</strong>데이터는 일원분산분석 형태의 matrix를 가지고 있다.<br />
<strong>abc.crossed</strong>는 이원분산분석 형태의 교차 matrix 형태를 가지고 있다.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="#cb750-1" aria-hidden="true" tabindex="-1"></a>abc.nested <span class="ot">&lt;-</span> <span class="fu">with</span>(abc,<span class="fu">matrix</span>(<span class="fu">c</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>),</span>
<span id="cb750-2"><a href="#cb750-2" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">4</span>),y[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb750-3"><a href="#cb750-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">4</span>),</span>
<span id="cb750-4"><a href="#cb750-4" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>),y[<span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>],<span class="dv">3</span>,<span class="dv">12</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">dimnames=</span><span class="fu">list</span>(<span class="at">A=</span><span class="fu">unique</span>(A),<span class="at">BwA=</span>BwA))))</span>
<span id="cb750-5"><a href="#cb750-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-6"><a href="#cb750-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(abc.nested,<span class="at">na.print=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>##       [,1]     
##  [1,] -0.02    
##  [2,] 1.19     
##  [3,] -0.02    
##  [4,] 0.23     
##  [5,]          
##  [6,]          
##  [7,]          
##  [8,]          
##  [9,]          
## [10,]          
## [11,]          
## [12,]          
## [13,]          
## [14,]          
## [15,]          
## [16,]          
## [17,] 0.67     
## [18,] 1.95     
## [19,] -0.71    
## [20,] -0.4     
## [21,]          
## [22,]          
## [23,]          
## [24,]          
## [25,]          
## [26,]          
## [27,]          
## [28,]          
## [29,]          
## [30,]          
## [31,]          
## [32,]          
## [33,] -0.56    
## [34,] 0.01     
## [35,] 0.13     
## [36,] 1.19     
## [37,] 3        
## [38,] 12       
## [39,] TRUE     
## [40,] factor,3 
## [41,] factor,12</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true" tabindex="-1"></a>abc.double.indexed <span class="ot">&lt;-</span> abc[,<span class="st">&quot;y&quot;</span>,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb752-2"><a href="#cb752-2" aria-hidden="true" tabindex="-1"></a>abc.double.indexed</span></code></pre></div>
<pre><code>##         y
## r.w -0.02
## r.x  1.19
## r.y -0.02
## r.z  0.23
## s.w  0.67
## s.x  1.95
## s.y -0.71
## s.z -0.40
## t.w -0.56
## t.x  0.01
## t.y  0.13
## t.z  1.19</code></pre>
<p><strong>abc.nested</strong>는 nested된 형태의 matrix를 보여준다.<br />
<strong>abc.double.indexed</strong>는 A와 B 변수의 값 두 개를 index로 가지고 있는 것을 나타낸다.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true" tabindex="-1"></a><span class="do">## one-way</span></span>
<span id="cb754-2"><a href="#cb754-2" aria-hidden="true" tabindex="-1"></a>abc.A.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> A, <span class="at">data =</span> abc)</span>
<span id="cb754-3"><a href="#cb754-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(abc.A.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## A          2 0.0781 0.03903  0.0506 0.9509
## Residuals  9 6.9377 0.77085</code></pre>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(abc.A.aov)</span></code></pre></div>
<pre><code>## (Intercept)          As          At 
##      0.3450      0.0325     -0.1525</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>A)</span></code></pre></div>
<pre><code>##   s t
## r 0 0
## s 1 0
## t 0 1</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(abc.A.aov)</span></code></pre></div>
<pre><code>##     (Intercept) As At
## r.w           1  0  0
## r.x           1  0  0
## r.y           1  0  0
## r.z           1  0  0
## s.w           1  1  0
## s.x           1  1  0
## s.y           1  1  0
## s.z           1  1  0
## t.w           1  0  1
## t.x           1  0  1
## t.y           1  0  1
## t.z           1  0  1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$A
## [1] &quot;contr.treatment&quot;</code></pre>
<p><strong>abc.oneway</strong>에 대해서 분산분석을 진행한 결과, 유의확률이 유의수준보다 크므로 유의한 차이가 발생하는 집단이 없는 것을 알 수 있다.</p>
<p><strong>contrasts</strong>를 통해 dummy변수가 어떻게 처리 됐는지 알 수 있으며, model.matrix를 통해 contrast matrix의 조합을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="do">## crossed: no interaction</span></span>
<span id="cb762-2"><a href="#cb762-2" aria-hidden="true" tabindex="-1"></a>abc.ApB.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> A<span class="sc">+</span>B, <span class="at">data =</span> abc)</span>
<span id="cb762-3"><a href="#cb762-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(abc.ApB.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## A          2 0.0781 0.03903  0.0547 0.9472
## B          3 2.6607 0.88690  1.2442 0.3736
## Residuals  6 4.2770 0.71283</code></pre>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(abc.ApB.aov)</span></code></pre></div>
<pre><code>## (Intercept)          As          At          Bx          By 
##      0.0700      0.0325     -0.1525      1.0200     -0.2300 
##          Bz 
##      0.3100</code></pre>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>A)</span></code></pre></div>
<pre><code>##   s t
## r 0 0
## s 1 0
## t 0 1</code></pre>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>B)</span></code></pre></div>
<pre><code>##   x y z
## w 0 0 0
## x 1 0 0
## y 0 1 0
## z 0 0 1</code></pre>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(abc.ApB.aov)</span></code></pre></div>
<pre><code>##     (Intercept) As At Bx By Bz
## r.w           1  0  0  0  0  0
## r.x           1  0  0  1  0  0
## r.y           1  0  0  0  1  0
## r.z           1  0  0  0  0  1
## s.w           1  1  0  0  0  0
## s.x           1  1  0  1  0  0
## s.y           1  1  0  0  1  0
## s.z           1  1  0  0  0  1
## t.w           1  0  1  0  0  0
## t.x           1  0  1  1  0  0
## t.y           1  0  1  0  1  0
## t.z           1  0  1  0  0  1
## attr(,&quot;assign&quot;)
## [1] 0 1 1 2 2 2
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$A
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$B
## [1] &quot;contr.treatment&quot;</code></pre>
<p><strong>abc.corossed</strong>에 대해서 분산분석을 진행한 결과, 두 변수 모두 유의확률이 유의수준보다 크므로 유의한 차이가 발생하는 집단이 없는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="#cb772-1" aria-hidden="true" tabindex="-1"></a><span class="do">## crossed: with interaction</span></span>
<span id="cb772-2"><a href="#cb772-2" aria-hidden="true" tabindex="-1"></a>abc.AsB.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> A<span class="sc">*</span>B, <span class="at">data =</span> abc)</span>
<span id="cb772-3"><a href="#cb772-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(abc.AsB.aov)</span></code></pre></div>
<pre><code>## Warning in anova.lm(abc.AsB.aov): ANOVA F-tests on an essentially
## perfect fit are unreliable</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## A          2 0.0781 0.03903               
## B          3 2.6607 0.88690               
## A:B        6 4.2770 0.71283               
## Residuals  0 0.0000</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(abc.AsB.aov)</span></code></pre></div>
<pre><code>##   (Intercept)            As            At            Bx 
## -2.000000e-02  6.900000e-01 -5.400000e-01  1.210000e+00 
##            By            Bz         As:Bx         At:Bx 
##  7.850462e-17  2.500000e-01  7.000000e-02 -6.400000e-01 
##         As:By         At:By         As:Bz         At:Bz 
## -1.380000e+00  6.900000e-01 -1.320000e+00  1.500000e+00</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>A)</span></code></pre></div>
<pre><code>##   s t
## r 0 0
## s 1 0
## t 0 1</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>B)</span></code></pre></div>
<pre><code>##   x y z
## w 0 0 0
## x 1 0 0
## y 0 1 0
## z 0 0 1</code></pre>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>AB)</span></code></pre></div>
<pre><code>##     r.x r.y r.z s.w s.x s.y s.z t.w t.x t.y t.z
## r.w   0   0   0   0   0   0   0   0   0   0   0
## r.x   1   0   0   0   0   0   0   0   0   0   0
## r.y   0   1   0   0   0   0   0   0   0   0   0
## r.z   0   0   1   0   0   0   0   0   0   0   0
## s.w   0   0   0   1   0   0   0   0   0   0   0
## s.x   0   0   0   0   1   0   0   0   0   0   0
## s.y   0   0   0   0   0   1   0   0   0   0   0
## s.z   0   0   0   0   0   0   1   0   0   0   0
## t.w   0   0   0   0   0   0   0   1   0   0   0
## t.x   0   0   0   0   0   0   0   0   1   0   0
## t.y   0   0   0   0   0   0   0   0   0   1   0
## t.z   0   0   0   0   0   0   0   0   0   0   1</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(abc.AsB.aov)</span></code></pre></div>
<pre><code>##     (Intercept) As At Bx By Bz As:Bx At:Bx As:By At:By As:Bz At:Bz
## r.w           1  0  0  0  0  0     0     0     0     0     0     0
## r.x           1  0  0  1  0  0     0     0     0     0     0     0
## r.y           1  0  0  0  1  0     0     0     0     0     0     0
## r.z           1  0  0  0  0  1     0     0     0     0     0     0
## s.w           1  1  0  0  0  0     0     0     0     0     0     0
## s.x           1  1  0  1  0  0     1     0     0     0     0     0
## s.y           1  1  0  0  1  0     0     0     1     0     0     0
## s.z           1  1  0  0  0  1     0     0     0     0     1     0
## t.w           1  0  1  0  0  0     0     0     0     0     0     0
## t.x           1  0  1  1  0  0     0     1     0     0     0     0
## t.y           1  0  1  0  1  0     0     0     0     1     0     0
## t.z           1  0  1  0  0  1     0     0     0     0     0     1
## attr(,&quot;assign&quot;)
##  [1] 0 1 1 2 2 2 3 3 3 3 3 3
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$A
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$B
## [1] &quot;contr.treatment&quot;</code></pre>
<p>crossed의 경우 뒤에 Formula에 <em>+</em>가 아닌 <code>*</code>를 사용함으로써 교호작용을 함께 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="do">## nested</span></span>
<span id="cb785-2"><a href="#cb785-2" aria-hidden="true" tabindex="-1"></a>abc.BwA.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> A<span class="sc">/</span>B, <span class="at">data =</span> abc)</span>
<span id="cb785-3"><a href="#cb785-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(abc.BwA.aov)</span></code></pre></div>
<pre><code>## Warning in anova.lm(abc.BwA.aov): ANOVA F-tests on an essentially
## perfect fit are unreliable</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## A          2 0.0781 0.03903               
## A:B        9 6.9377 0.77085               
## Residuals  0 0.0000</code></pre>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(abc.BwA.aov)</span></code></pre></div>
<pre><code>##   (Intercept)            As            At         Ar:Bx 
## -2.000000e-02  6.900000e-01 -5.400000e-01  1.210000e+00 
##         As:Bx         At:Bx         Ar:By         As:By 
##  1.280000e+00  5.700000e-01  2.362077e-16 -1.380000e+00 
##         At:By         Ar:Bz         As:Bz         At:Bz 
##  6.900000e-01  2.500000e-01 -1.070000e+00  1.750000e+00</code></pre>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="#cb790-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>A)</span></code></pre></div>
<pre><code>##   s t
## r 0 0
## s 1 0
## t 0 1</code></pre>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(<span class="fu">interaction</span>(abc<span class="sc">$</span>A,abc<span class="sc">$</span>B))</span></code></pre></div>
<pre><code>##     s.w t.w r.x s.x t.x r.y s.y t.y r.z s.z t.z
## r.w   0   0   0   0   0   0   0   0   0   0   0
## s.w   1   0   0   0   0   0   0   0   0   0   0
## t.w   0   1   0   0   0   0   0   0   0   0   0
## r.x   0   0   1   0   0   0   0   0   0   0   0
## s.x   0   0   0   1   0   0   0   0   0   0   0
## t.x   0   0   0   0   1   0   0   0   0   0   0
## r.y   0   0   0   0   0   1   0   0   0   0   0
## s.y   0   0   0   0   0   0   1   0   0   0   0
## t.y   0   0   0   0   0   0   0   1   0   0   0
## r.z   0   0   0   0   0   0   0   0   1   0   0
## s.z   0   0   0   0   0   0   0   0   0   1   0
## t.z   0   0   0   0   0   0   0   0   0   0   1</code></pre>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(abc.BwA.aov)</span></code></pre></div>
<pre><code>##     (Intercept) As At Ar:Bx As:Bx At:Bx Ar:By As:By At:By Ar:Bz
## r.w           1  0  0     0     0     0     0     0     0     0
## r.x           1  0  0     1     0     0     0     0     0     0
## r.y           1  0  0     0     0     0     1     0     0     0
## r.z           1  0  0     0     0     0     0     0     0     1
## s.w           1  1  0     0     0     0     0     0     0     0
## s.x           1  1  0     0     1     0     0     0     0     0
## s.y           1  1  0     0     0     0     0     1     0     0
## s.z           1  1  0     0     0     0     0     0     0     0
## t.w           1  0  1     0     0     0     0     0     0     0
## t.x           1  0  1     0     0     1     0     0     0     0
## t.y           1  0  1     0     0     0     0     0     1     0
## t.z           1  0  1     0     0     0     0     0     0     0
##     As:Bz At:Bz
## r.w     0     0
## r.x     0     0
## r.y     0     0
## r.z     0     0
## s.w     0     0
## s.x     0     0
## s.y     0     0
## s.z     1     0
## t.w     0     0
## t.x     0     0
## t.y     0     0
## t.z     0     1
## attr(,&quot;assign&quot;)
##  [1] 0 1 1 2 2 2 2 2 2 2 2 2
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$A
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$B
## [1] &quot;contr.treatment&quot;</code></pre>
<p><strong>nested</strong>의 경우, <strong>/</strong>형태의 Formula를 사용함으로써 nested된 분산분석의 결과를 살펴볼볼 수 있다.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="do">## doublyindexed</span></span>
<span id="cb796-2"><a href="#cb796-2" aria-hidden="true" tabindex="-1"></a>abc.AB.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> AB, <span class="at">data =</span> abc)</span>
<span id="cb796-3"><a href="#cb796-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(abc.AB.aov)</span></code></pre></div>
<pre><code>## Warning in anova.lm(abc.AB.aov): ANOVA F-tests on an essentially
## perfect fit are unreliable</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## AB        11 7.0157 0.63779               
## Residuals  0 0.0000</code></pre>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="#cb799-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(abc.AB.aov)</span></code></pre></div>
<pre><code>##   (Intercept)         ABr.x         ABr.y         ABr.z 
## -2.000000e-02  1.210000e+00  3.638787e-18  2.500000e-01 
##         ABs.w         ABs.x         ABs.y         ABs.z 
##  6.900000e-01  1.970000e+00 -6.900000e-01 -3.800000e-01 
##         ABt.w         ABt.x         ABt.y         ABt.z 
## -5.400000e-01  3.000000e-02  1.500000e-01  1.210000e+00</code></pre>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(abc<span class="sc">$</span>B)</span></code></pre></div>
<pre><code>##   x y z
## w 0 0 0
## x 1 0 0
## y 0 1 0
## z 0 0 1</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(abc.AB.aov)</span></code></pre></div>
<pre><code>##     (Intercept) ABr.x ABr.y ABr.z ABs.w ABs.x ABs.y ABs.z ABt.w
## r.w           1     0     0     0     0     0     0     0     0
## r.x           1     1     0     0     0     0     0     0     0
## r.y           1     0     1     0     0     0     0     0     0
## r.z           1     0     0     1     0     0     0     0     0
## s.w           1     0     0     0     1     0     0     0     0
## s.x           1     0     0     0     0     1     0     0     0
## s.y           1     0     0     0     0     0     1     0     0
## s.z           1     0     0     0     0     0     0     1     0
## t.w           1     0     0     0     0     0     0     0     1
## t.x           1     0     0     0     0     0     0     0     0
## t.y           1     0     0     0     0     0     0     0     0
## t.z           1     0     0     0     0     0     0     0     0
##     ABt.x ABt.y ABt.z
## r.w     0     0     0
## r.x     0     0     0
## r.y     0     0     0
## r.z     0     0     0
## s.w     0     0     0
## s.x     0     0     0
## s.y     0     0     0
## s.z     0     0     0
## t.w     0     0     0
## t.x     1     0     0
## t.y     0     1     0
## t.z     0     0     1
## attr(,&quot;assign&quot;)
##  [1] 0 1 1 1 1 1 1 1 1 1 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$AB
## [1] &quot;contr.treatment&quot;</code></pre>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(<span class="sc">~</span>A,<span class="at">data=</span>abc,</span>
<span id="cb805-2"><a href="#cb805-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">contrasts=</span><span class="fu">list</span>(<span class="at">A=</span>contr.treatment))</span></code></pre></div>
<pre><code>##     (Intercept) A2 A3
## r.w           1  0  0
## r.x           1  0  0
## r.y           1  0  0
## r.z           1  0  0
## s.w           1  1  0
## s.x           1  1  0
## s.y           1  1  0
## s.z           1  1  0
## t.w           1  0  1
## t.x           1  0  1
## t.y           1  0  1
## t.z           1  0  1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$A
##   2 3
## r 0 0
## s 1 0
## t 0 1</code></pre>
<p><code>model.matrix</code>의 option인 <code>contr.treatment</code>를 사용한 결과, <strong>ABC</strong>데이터의 A변수에 대한 contrast matrix를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="#cb807-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(<span class="sc">~</span>A,<span class="at">data=</span>abc,<span class="at">contrasts=</span><span class="fu">list</span>(<span class="at">A=</span>contr.sum))</span></code></pre></div>
<pre><code>##     (Intercept) A1 A2
## r.w           1  1  0
## r.x           1  1  0
## r.y           1  1  0
## r.z           1  1  0
## s.w           1  0  1
## s.x           1  0  1
## s.y           1  0  1
## s.z           1  0  1
## t.w           1 -1 -1
## t.x           1 -1 -1
## t.y           1 -1 -1
## t.z           1 -1 -1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$A
##   [,1] [,2]
## r    1    0
## s    0    1
## t   -1   -1</code></pre>
<p><code>contr.sum</code>을 지정해준 결과, 절편을 제외한 matrix의 열에 대하여 누적 합이 0이 되도록 조합을 만들어준다.</p>
<div id="crossing-of-two-factor" class="section level3">
<h3>13.3.1 Crossing of Two Factor</h3>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="#cb809-1" aria-hidden="true" tabindex="-1"></a>old.width <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">width=</span><span class="dv">70</span>)</span>
<span id="cb809-2"><a href="#cb809-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-3"><a href="#cb809-3" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>A<span class="sc">*</span>B,<span class="at">data=</span>abc,</span>
<span id="cb809-4"><a href="#cb809-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">contrasts=</span><span class="fu">list</span>(<span class="at">A=</span>contr.helmert,</span>
<span id="cb809-5"><a href="#cb809-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">B=</span>contr.helmert))</span>
<span id="cb809-6"><a href="#cb809-6" aria-hidden="true" tabindex="-1"></a>mm[,]</span></code></pre></div>
<pre><code>##     (Intercept) A1 A2 B1 B2 B3 A1:B1 A2:B1 A1:B2 A2:B2 A1:B3 A2:B3
## r.w           1 -1 -1 -1 -1 -1     1     1     1     1     1     1
## r.x           1 -1 -1  1 -1 -1    -1    -1     1     1     1     1
## r.y           1 -1 -1  0  2 -1     0     0    -2    -2     1     1
## r.z           1 -1 -1  0  0  3     0     0     0     0    -3    -3
## s.w           1  1 -1 -1 -1 -1    -1     1    -1     1    -1     1
## s.x           1  1 -1  1 -1 -1     1    -1    -1     1    -1     1
## s.y           1  1 -1  0  2 -1     0     0     2    -2    -1     1
## s.z           1  1 -1  0  0  3     0     0     0     0     3    -3
## t.w           1  0  2 -1 -1 -1     0    -2     0    -2     0    -2
## t.x           1  0  2  1 -1 -1     0     2     0    -2     0    -2
## t.y           1  0  2  0  2 -1     0     0     0     4     0    -2
## t.z           1  0  2  0  0  3     0     0     0     0     0     6</code></pre>
<p><code>contr.helmert</code>을 지정해준 결과, 각 조합에 대한 contrast matrix의 행의 합이 0이 되도록 만들어진 것을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(AA <span class="ot">&lt;-</span> mm[<span class="st">&quot;s.y&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>)])</span></code></pre></div>
<pre><code>## A1 A2 
##  1 -1</code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BBB <span class="ot">&lt;-</span> mm[<span class="st">&quot;s.y&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;B1&quot;</span>,<span class="st">&quot;B2&quot;</span>,<span class="st">&quot;B3&quot;</span>)])</span></code></pre></div>
<pre><code>## B1 B2 B3 
##  0  2 -1</code></pre>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="#cb815-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outer</span>(AA,BBB)</span></code></pre></div>
<pre><code>##    B1 B2 B3
## A1  0  2 -1
## A2  0 -2  1</code></pre>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="#cb817-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(<span class="fu">outer</span>(AA,BBB))</span></code></pre></div>
<pre><code>## [1]  0  0  2 -2 -1  1</code></pre>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="#cb819-1" aria-hidden="true" tabindex="-1"></a>mm[<span class="st">&quot;s.y&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;A1:B1&quot;</span>,<span class="st">&quot;A2:B1&quot;</span>,<span class="st">&quot;A1:B2&quot;</span>,<span class="st">&quot;A2:B2&quot;</span>,<span class="st">&quot;A1:B3&quot;</span>,<span class="st">&quot;A2:B3&quot;</span>)]</span></code></pre></div>
<pre><code>## A1:B1 A2:B1 A1:B2 A2:B2 A1:B3 A2:B3 
##     0     0     2    -2    -1     1</code></pre>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(old.width)</span></code></pre></div>
</div>
</div>
<div id="sequential-and-conditional-tests" class="section level2">
<h2>13.4 Sequential and Conditional Tests</h2>
<p>자료에 2개 이상의 종속변수가 존재하는 경우, 아래와 같은 분석방법을 통해서 실험을 진행할 수 있다.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(<span class="fu">dimnames</span>(<span class="fu">coef</span>(<span class="fu">summary.lm</span>(turkey3.aov)))[[<span class="dv">1</span>]],<span class="fu">dimnames</span>(turkey3.aov<span class="sc">$</span>x)[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1]  1  2  4  8 12</code></pre>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="#cb824-1" aria-hidden="true" tabindex="-1"></a>turkey[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">25</span>),]</span></code></pre></div>
<pre><code>##       diet wt.gain trt.vs.control additive amount
## 1  control     4.1        control  control      0
## 7       A1     5.2      treatment        A      1
## 13      A2     6.3      treatment        A      2
## 19      B1     6.5      treatment        B      1
## 25      B2     9.5      treatment        B      2</code></pre>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="#cb826-1" aria-hidden="true" tabindex="-1"></a>turkey3.coef <span class="ot">&lt;-</span> <span class="fu">summary.lm</span>(turkey3.aov)<span class="sc">$</span>coef</span>
<span id="cb826-2"><a href="#cb826-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-3"><a href="#cb826-3" aria-hidden="true" tabindex="-1"></a>turkey3.x <span class="ot">&lt;-</span> turkey3.aov<span class="sc">$</span>x</span>
<span id="cb826-4"><a href="#cb826-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-5"><a href="#cb826-5" aria-hidden="true" tabindex="-1"></a>term.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;trt.vs.control&quot;</span>,<span class="st">&quot;additive&quot;</span>,<span class="st">&quot;amount&quot;</span>,<span class="st">&quot;additive:amount&quot;</span>)</span>
<span id="cb826-6"><a href="#cb826-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-7"><a href="#cb826-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(turkey3.coef)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> term.names</span>
<span id="cb826-8"><a href="#cb826-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(turkey3.x)[[<span class="dv">2</span>]][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>)] <span class="ot">&lt;-</span> term.names</span>
<span id="cb826-9"><a href="#cb826-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-10"><a href="#cb826-10" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(turkey3.coef)</span></code></pre></div>
<pre><code>##                 Estimate Std. Error   t value Pr(&gt;|t|)
## (Intercept)      6.53000    0.10253  63.68585   0.0000
## trt.vs.control  -0.68667    0.05127 -13.39386   0.0000
## additive        -0.97500    0.11464  -8.50510   0.0000
## amount          -0.96667    0.11464  -8.43241   0.0000
## additive:amount  0.22500    0.11464   1.96272   0.0609</code></pre>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="#cb828-1" aria-hidden="true" tabindex="-1"></a>turkey3.x[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">25</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>)]</span></code></pre></div>
<pre><code>##    (Intercept) trt.vs.control additive amount additive:amount
## 1            1              4        0      0               0
## 7            1             -1        1      1               1
## 13           1             -1        1     -1              -1
## 19           1             -1       -1      1              -1
## 25           1             -1       -1     -1               1</code></pre>
<div id="example-application-to-clover-data" class="section level3">
<h3>13.4.1 Example-Application to Clover Data</h3>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="#cb830-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;rhiz.clover&quot;</span>)</span>
<span id="cb830-2"><a href="#cb830-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-3"><a href="#cb830-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(Npg<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-331-1.png" width="960" /></p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="#cb831-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover2 <span class="ot">&lt;-</span> rhiz.clover[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>),]</span>
<span id="cb831-2"><a href="#cb831-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(Npg<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover2)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-331-2.png" width="960" /></p>
<p><strong>rhiz.clover</strong>대해서 <strong>comb</strong>를 그룹변수로 하고 <strong>strain</strong>과 <strong>Npg</strong>의 관계를 살펴보기 위해 <code>stripplot</code>함수를 사용하였다.</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="#cb832-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb832-2"><a href="#cb832-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb832-3"><a href="#cb832-3" aria-hidden="true" tabindex="-1"></a><span class="do">## drop two obervation to illustrate Type 2 Eand 3 sums of squares</span></span>
<span id="cb832-4"><a href="#cb832-4" aria-hidden="true" tabindex="-1"></a><span class="do">## I am dropping the non-outlier observations in 300k5</span></span>
<span id="cb832-5"><a href="#cb832-5" aria-hidden="true" tabindex="-1"></a>cloverD <span class="ot">&lt;-</span> rhiz.clover[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>),]</span>
<span id="cb832-6"><a href="#cb832-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb832-7"><a href="#cb832-7" aria-hidden="true" tabindex="-1"></a>old.opt <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">show.signif.stars =</span> <span class="cn">FALSE</span>, <span class="at">digit=</span><span class="dv">3</span>)</span>
<span id="cb832-8"><a href="#cb832-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb832-9"><a href="#cb832-9" aria-hidden="true" tabindex="-1"></a>cloverDsc.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg <span class="sc">~</span> strain<span class="sc">*</span>comb,<span class="at">data=</span>cloverD,<span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">strain=</span>contr.sum,<span class="at">comb=</span>contr.sum))</span>
<span id="cb832-10"><a href="#cb832-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb832-11"><a href="#cb832-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(cloverDsc.aov)[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>)]</span></code></pre></div>
<pre><code>##             Sum Sq Df F value    Pr(&gt;F)
## strain      657.40  5 29.2810 4.237e-13
## comb         20.03  1  4.4614   0.04025
## strain:comb 594.34  5 26.4725 2.272e-12
## Residuals   202.06 45</code></pre>
<p>분산분석 결과, 두 개의 관측치를 제외한 <em>cloverD</em>데이터에 대해서 주효과와 교호작용이 모두 유의한 결과를 가지는 것을 확인할 수 있다.<br />
***</p>
<p><code>Anova</code>함수에서 <code>type = 2</code> 옵션을 지정하게 되면 불균형한 데이터셋에 대해서 Method of Fitting Constants의 test 결과를 확인할 수 있다.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="#cb834-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(cloverDsc.aov,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: Npg
##             Sum Sq Df F value    Pr(&gt;F)
## strain      675.12  5 30.0702 2.700e-13
## comb         20.03  1  4.4614   0.04025
## strain:comb 594.34  5 26.4725 2.272e-12
## Residuals   202.06 45</code></pre>
<hr />
<p><code>type = 3</code> 옵션을 지정할 경우, Weighted Sqaures of Means의 test 결과를 확인할 수 있다.</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(cloverDsc.aov,<span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: Npg
##             Sum Sq Df  F value    Pr(&gt;F)
## (Intercept)  38711  1 8621.083 &lt; 2.2e-16
## strain        1049  5   46.738 &lt; 2.2e-16
## comb            86  1   19.256 6.830e-05
## strain:comb    594  5   26.473 2.272e-12
## Residuals      202 45</code></pre>
<hr />
<p>아래의 분석은 위와 같은 분석이지만 교호작용에 대해서 <strong>comb</strong>변수가 먼저 오도록 설정하였다.<br />
결과가 동일한 것으로 보아 교호작용 Formula를 지정할 때, 순서는 크게 상관없는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="#cb838-1" aria-hidden="true" tabindex="-1"></a>cloverDsc.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg <span class="sc">~</span> comb<span class="sc">*</span>strain,<span class="at">data=</span>cloverD,<span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">strain=</span>contr.sum,<span class="at">comb=</span>contr.sum))</span>
<span id="cb838-2"><a href="#cb838-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb838-3"><a href="#cb838-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(cloverDsc.aov)[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>)]</span></code></pre></div>
<pre><code>##             Sum Sq Df F value    Pr(&gt;F)
## comb          2.32  1  0.5157    0.4764
## strain      675.12  5 30.0702 2.700e-13
## comb:strain 594.34  5 26.4725 2.272e-12
## Residuals   202.06 45</code></pre>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="#cb840-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(cloverDsc.aov,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: Npg
##             Sum Sq Df F value    Pr(&gt;F)
## comb         20.03  1  4.4614   0.04025
## strain      675.12  5 30.0702 2.700e-13
## comb:strain 594.34  5 26.4725 2.272e-12
## Residuals   202.06 45</code></pre>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="#cb842-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(cloverDsc.aov,<span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: Npg
##             Sum Sq Df  F value    Pr(&gt;F)
## (Intercept)  38711  1 8621.083 &lt; 2.2e-16
## comb            86  1   19.256 6.830e-05
## strain        1049  5   46.738 &lt; 2.2e-16
## comb:strain    594  5   26.473 2.272e-12
## Residuals      202 45</code></pre>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="#cb844-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(old.opt)</span></code></pre></div>
</div>
<div id="example-application-to-body-fat-data" class="section level3">
<h3>13.4.2 Example-Application to Body Fat Data</h3>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="#cb845-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb845-2"><a href="#cb845-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;fat&quot;</span>)</span>
<span id="cb845-3"><a href="#cb845-3" aria-hidden="true" tabindex="-1"></a>fat.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bodyfat <span class="sc">~</span> abdomin<span class="sc">+</span>biceps,<span class="at">data=</span>fat)</span>
<span id="cb845-4"><a href="#cb845-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb845-5"><a href="#cb845-5" aria-hidden="true" tabindex="-1"></a><span class="do">## regression coefficients</span></span>
<span id="cb845-6"><a href="#cb845-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fat.lm))</span></code></pre></div>
<pre><code>##                Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) -14.5937363 6.69222199 -2.180701 3.459548e-02
## abdomin       0.6829379 0.07855885  8.693329 4.168613e-11
## biceps       -0.9221544 0.31304822 -2.945726 5.133920e-03</code></pre>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sequential sums of squares (Type 1)</span></span>
<span id="cb847-2"><a href="#cb847-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fat.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: bodyfat
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## abdomin    1 2440.50 2440.50 101.1718 5.581e-13 ***
## biceps     1  209.32  209.32   8.6773  0.005134 ** 
## Residuals 44 1061.38   24.12                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="do">## weighted squares of means (Type 3)</span></span>
<span id="cb849-2"><a href="#cb849-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fat.lm,<span class="at">type=</span><span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: bodyfat
##              Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)  114.71  1  4.7555  0.034595 *  
## abdomin     1823.02  1 75.5740 4.169e-11 ***
## biceps       209.32  1  8.6773  0.005134 ** 
## Residuals   1061.38 44                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="#cb851-1" aria-hidden="true" tabindex="-1"></a><span class="do">## model sum of squares</span></span>
<span id="cb851-2"><a href="#cb851-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(fat<span class="sc">$</span>bodyfat) <span class="sc">*</span> (<span class="fu">nrow</span>(fat)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">sum</span>(fat.lm<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2649.817</code></pre>
</div>
</div>
<div id="apendix-what-is-residual" class="section level2">
<h2>13.5 Apendix: What is Residual?</h2>
<p>흔히, 우리는 잔차와 오차를 많이 헷갈리고 구분하지 못하는 경우가 있다.</p>
<p><strong>오차</strong>는 모집단으로부터 회귀식을 얻었을 때, 회귀식의 예측값과 실제 관측값의 차이를 말한다.<br />
<strong>잔차</strong>는 표본집단으로부터 회귀식을 얻었을 때, 회귀식의 예측값과 실제 관측값의 차이를 말한다.</p>
<p>우리가 분석을 진행함에 있어 모집단의 자료들을 이용하여 분석하는 경우는 드물다.<br />
모집단이 셀 수 없이 큰 집단인 경우가 많기 때문에 대부분의 분석에서 표본을 이용한다.<br />
그렇기 때문에, 우리는 오차보다 잔차라는 용어를 더 많이 접하게 되는 것이다.</p>
<p>이러한 잔차를 통해서도 우리는 유용한 정보를 얻을 수 있다.</p>
<div class="figure">
<img src="https://2.bp.blogspot.com/-sYvS3hNj-FA/VrS-2IE5mjI/AAAAAAAAAgM/CvRpelwTASc/s1600/2016-02-05%2B13%253B31%253B44.PNG" style="width:50.0%" alt="" />
<p class="caption">Residual plot by Anova</p>
</div>
<p>사진 출처: <strong><a href="http://webr4statistics.blogspot.com/2016/02/1.html" class="uri">http://webr4statistics.blogspot.com/2016/02/1.html</a></strong></p>
<p><em>첫 번째 패널</em>은 모형의 <strong>모형의 선형성</strong>을 살펴볼 수 있다.<br />
빨간 실선은 잔차의 추세를 나타내며, 발깐 실선이 점선에서 크게 벗어난다면 예측값에 따라 잔차가 크게 달라지는 것을 말한다.</p>
<p><em>두 번째 패널</em>은 <strong>잔차의 정규성</strong>을 살펴볼 수 있다.<br />
점들이 직선형태에 가까울 수록 정규분포를 따른다고 할 수 있다.</p>
<p><em>세 번째 패널</em>은 <strong>잔차의 등분산성</strong>을 살펴볼 수 있다.<br />
등분산성은 분산이 동일하다는 가정으로 빨간색 실선이 수선을 그리면 등분산성을 만족한다고 할 수 있다.</p>
<p><em>네 번째 패널</em>은 자료의 극단값을 나타내는 그래프이다.<br />
숫자가 옆에 있는 점은 자료 안에서 극단값을 나타내는 행의 번호라고 할 수 있다.</p>
<p><strong>잔차의 독립성</strong>의 경우 R에서 <strong>Durbin-Watson test</strong>를 통해 가정이 성립하는지를 살펴볼 수 있다.</p>
</div>
<div id="references-of-chpater13" class="section level2 unnumbered">
<h2 class="unnumbered">References of Chpater13</h2>
<p><a href="https://bskyvision.com/642">잔차와 오차의 차이</a><br />
<a href="https://mindscale.kr/course/basic-stat-r/residuals/">잔차 분석</a><br />
<a href="https://abluesnake.tistory.com/4">고정효과, 임의효과</a><br />
<a href="http://www.statedu.com/QnA/79640">nested</a></p>
<hr />
</div>
<div id="summary-of-chapter13" class="section level2">
<h2>Summary of Chapter13</h2>
<ul>
<li><p><strong>삼원분산분석(Three-way ANOVA)</strong>는 우리가 살펴본 2개의 분산분석과 달리 설명변수가 3개 이상인 경우의 집단 간 평균 차이를 확인하기 위해 진행되는 분석방법을 말한다.<br />
ㄴ</p></li>
<li><p>우리는 앞선 챕터에서, 이원분산분석을 진행할 때, 설명변수간 교호작용을 고려해야 한다고했다. 따라서, 삼원분산분석의 경우에도 주효과만 살펴보는 것이 아니라 설명변수 간 상호효과를 살펴보기 위해 교호작용을 확인해야 한다.</p></li>
<li><p>단, <strong>삼원분산분석</strong>에서 설명변수가 3개일 경우의 교호작용은 3개, 4개일 경우에는 6개의 교호작용 등 설명변수가 늘어날수록 교호작용도 늘어나기 때문에, 너무 많은 설명변수를 사용하기 보다는 적절한 설명변수를 사용하는 것이 좋다.</p></li>
<li><p><strong>고정효과</strong>는 요인의 수준을 실험자가 직접 지정한 경우를 일컫는다. 이러한 고정 요인이 포함된 모형을 <strong>고정효과 모형(Fixed effects model)</strong> 모델이라고 한다. 요인의 수준을 직접 지정하기 때문에 실험된 요인의 수준에 대해서만 비교가 가능하며, 통계 추론이 실험에 사용된 수준에 제한된다.</p></li>
<li><p><strong>랜덤효과</strong>는 요인의 수준이 임의로 추출된 경우를 의미한다. 이러한 랜덤 요인이 포함된 모형을 <strong>랟넘효과 모형(Random effectss model)</strong>이라고 한다. 고정효과 모형과 달리 요인의 수준이 임의로 추출되기 때문에 해당 요인의 수준으 넘어 모집단으로 해석을 확대할 수 있다.</p></li>
<li><p><strong>혼합효과 모형(Mixed effcets model)</strong>은 고정 요인과 랜덤 요인이 모두 존재하는 모형을 말한다.</p></li>
<li><p><strong>nested</strong>는 실헙계획법의 용어 중 하나로, 2개의 설명변수가 있다고 할 때, 인자의 수준이 독립정으로 정해지는 것이 아닌, 다른 인자의 수준이 정해진 다음에 정해지는 것을 의미한다.</p></li>
<li><p><code>R</code>에서 삼원분산분석 또한 <code>aov</code>함수를 이용하여 분석을 진행할 수 있다. Formula는 <code>(종속변수 ~ 설명변수 + 설명변수 + 설명변수,data)</code>의 형태로 지정하게 되면 주효과에 대한 평균 차이 결과만을 보여주고 <code>(종속변수 ~ 설명변수 * 설명변수 * 설명변수,data)</code>의 형태로 input을 지정하게 되면 주효과와 더불어 주효과간 교호작용 효과를 확인할 수 있다.</p></li>
</ul>
<hr />
</div>
</div>
<div id="chap15-bivariate-statistics-discrete-data" class="section level1">
<h1>Chap15 Bivariate Statistics-Discrete Data</h1>
<div id="mosaic-plot" class="section level2">
<h2>15.1 Mosaic Plot</h2>
<p>모자이크 플랏(mosaic plot)은 교차표를 시각화한 그래프이다.<br />
모자이크 플랏에는 사각형들로 표현이 되며, 사각형의 크기는 데이터의 비율을 의미한다.<br />
R에서는 <code>mosaicplot</code>함수를 이용하여 쉽게 그릴 수 있다.<br />
Formula를 이용하여 교차표의 데이터를 어떤 방식으로 나눌지 지정할 수 있다.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb853-2"><a href="#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb853-3"><a href="#cb853-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb853-4"><a href="#cb853-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(drunk)</span>
<span id="cb853-5"><a href="#cb853-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>age<span class="sc">+</span>sex,<span class="at">data=</span>drunk,<span class="at">main=</span><span class="st">&quot;Mosaic plot of drunk&quot;</span>,<span class="at">color=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-337-1.png" width="960" /></p>
<p>파란색 사각형이 빨간색 사각형의 크기에 비해서 월등하게 큰 것을 확인할 수 있다.<br />
파란색 사각형은 male의 비율, 빨간색 사각형은 Female의 비율을 나타낸다.<br />
남성의 경우, 40~49세의 사각형이 가장 큰 것으로 보아 40~49세가 음주빈도가 가장 높은 연령대인 것을 알 수 있고 여성의 경우, 30~39세의 사각형이 가장 큰 것으로 보아 30~39세가 음주빈도가 가장 높은 연령대인 것을 확인할 수 있다.</p>
<div id="mosaic" class="section level3">
<h3>15.1.1 Mosaic</h3>
<p>Mosaicplot 함수말고도 mosaic 함수를 통해서도 mosaic plot을 그릴 수 있다.<br />
mosaic함수는 <code>vcd</code>패키지를 설치해야 한다.<br />
mosaic함수는 특이하게 shade라는 옵션을 제공한다.<br />
shade 옵션은 관찰빈도와 기대빈도의 관계를 보여주며, 오른쪽 아래 chi-test의 결과에 대한 P-value도 제공한다.</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="#cb854-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Titanic&quot;</span>)</span>
<span id="cb854-2"><a href="#cb854-2" aria-hidden="true" tabindex="-1"></a>Titanic</span></code></pre></div>
<pre><code>## , , Age = Child, Survived = No
## 
##       Sex
## Class  Male Female
##   1st     0      0
##   2nd     0      0
##   3rd    35     17
##   Crew    0      0
## 
## , , Age = Adult, Survived = No
## 
##       Sex
## Class  Male Female
##   1st   118      4
##   2nd   154     13
##   3rd   387     89
##   Crew  670      3
## 
## , , Age = Child, Survived = Yes
## 
##       Sex
## Class  Male Female
##   1st     5      1
##   2nd    11     13
##   3rd    13     14
##   Crew    0      0
## 
## , , Age = Adult, Survived = Yes
## 
##       Sex
## Class  Male Female
##   1st    57    140
##   2nd    14     80
##   3rd    75     76
##   Crew  192     20</code></pre>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="#cb856-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(<span class="sc">~</span>Sex<span class="sc">+</span>Survived,<span class="at">data=</span>Titanic,<span class="at">main=</span><span class="st">&quot;Survive of Titanic&quot;</span>,<span class="at">color=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>),<span class="at">shade=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-338-1.png" width="960" /></p>
<p>P-value가 유의수준 0.05보다 작으므로 귀무가설을 기각한다. 따라서 두 변수는 연관성이 있다고 할 수 있다.(독립X)<br />
파란색으로 사각형이 채워진 경우, 관찰빈도가 기대빈도보다 높다는 의미이고,<br />
빨간색으로 사각형이 채워진 경우, 관찰빈도가 기대빈도보다 낮다는 의미이다.<br />
즉, 남성이 생존하지 못할 관찰빈도가 기대빈도보다 높다는 의미로 해석할 수 있고<br />
여성의 경우 생존하지 못할 관찰빈도가 기대빈도보다 낮다는 의미로 해석할 수 있다.</p>
</div>
<div id="다중-mosaic-plot" class="section level3">
<h3>15.1.2 다중 mosaic plot</h3>
<p>앞서 본 예제처럼 범주가 두 가지인 경우가 아니라 세 가지 이상인 경우도 많다.<br />
이런 경우, 기본옵션만으로 mosaicplot을 그리게 되면 원하는 결과를 얻기 힘들기 때문에 옵션을 지정해 줘야한다.<br />
<code>highlighting</code>옵션은 어떠한 변수를 기준으로 색깔을 나눌것인지를 결정하는 것이다.<br />
<code>highlighting_fill</code> 옵션은 나눠지는 변수들에 대해서 색깔을 지정해주는 옵션이다.<br />
<code>direction</code>옵션은 변수의 축을 어떻게 할지 정해주는 것이다. h = horizontal, v = vertical을 의미한다.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(salk)</span>
<span id="cb857-2"><a href="#cb857-2" aria-hidden="true" tabindex="-1"></a>salk</span></code></pre></div>
<pre><code>##      age vaccine paralyze Freq
## 1    0-4     vac   no.par   20
## 2    0-4     vac      par   14
## 3    0-4  no.vac   no.par   10
## 4    0-4  no.vac      par   24
## 5    5-9     vac   no.par   15
## 6    5-9     vac      par   12
## 7    5-9  no.vac   no.par    3
## 8    5-9  no.vac      par   15
## 9  10-14     vac   no.par    3
## 10 10-14     vac      par    2
## 11 10-14  no.vac   no.par    3
## 12 10-14  no.vac      par    2
## 13 15-19     vac   no.par    7
## 14 15-19     vac      par    4
## 15 15-19  no.vac   no.par    1
## 16 15-19  no.vac      par    6
## 17 20-39     vac   no.par   12
## 18 20-39     vac      par    3
## 19 20-39  no.vac   no.par    7
## 20 20-39  no.vac      par    5
## 21   40+     vac   no.par    1
## 22   40+     vac      par    0
## 23   40+  no.vac   no.par    3
## 24   40+  no.vac      par    2</code></pre>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(<span class="sc">~</span>paralyze<span class="sc">+</span>age<span class="sc">+</span>vaccine,<span class="at">data=</span>salk,<span class="at">highlighting =</span> <span class="st">&quot;vaccine&quot;</span>,<span class="at">highlighting_fill=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>),</span>
<span id="cb859-2"><a href="#cb859-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">direction=</span><span class="fu">c</span>(<span class="st">&quot;h&quot;</span>,<span class="st">&quot;v&quot;</span>,<span class="st">&quot;v&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-339-1.png" width="960" /></p>
<p>우리가 지정한 vaccine의 여부에 따라서 색깔이 나누어졌고, 지정한 컬러로 다중 모자이크 플랏이 만들어졌다.<br />
또한 paralyze 변수의 경우 축을 horizontal으로 지정했기 때문에 옆으로 누워있는 것을 확인할 수 있다.</p>
</div>
</div>
<div id="assoc-function" class="section level2">
<h2>15.2 assoc function</h2>
<p><code>vec</code> 패키지의 assoc를 이용하면 assocplot을 그릴 수 있다.<br />
assocplot 또한 교차표를 그래프를 통해 살펴봄으로써 데이터의 형태를 조금 더 쉽게 볼 수 있다.<br />
assoc함수 또한 Formula를 이용하여 시각화할 데이터를 지정해준다. assoc함수에서 그래프의 색깔을 채우기 위해서는 <code>gp=gpar(fill=c("색깔","색깔"))</code> 옵션을 이용한다.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="#cb860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assoc</span>(age<span class="sc">~</span>sex,<span class="at">data=</span>drunk,<span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>)))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-340-1.png" width="960" /></p>
<p>fill 옵션이 아닌 <code>col</code> 옵션을 이용하면 테두리에 색깔을 채우게 된다.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="#cb861-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assoc</span>(age<span class="sc">~</span>sex,<span class="at">data=</span>drunk,<span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>)))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-341-1.png" width="960" /></p>
<p><code>gp=shading_binary</code> 옵션을 통해 mosaic plot에서도 제공했던 shade 옵션을 사용할 수 있다.<br />
mosaic plot에서와 같이 관찰빈도와 기대빈도의 관계를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assoc</span>(age<span class="sc">~</span>sex,<span class="at">data=</span>drunk,<span class="at">gp=</span><span class="fu">shading_binary</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>)))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-342-1.png" width="960" /></p>
</div>
<div id="cotabplot" class="section level2">
<h2>15.3 cotabplot</h2>
<p>cotabplot을 이용하면 xyplot과 같이 조건부 시각화 그림을 그릴 수 있다.<br />
아래에서는 Formula를 지정한 후 |sex라는 옵션을 지정하여 성별에 따라서 그래프를 나눠서 그렸다.</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="#cb863-1" aria-hidden="true" tabindex="-1"></a>drunk.chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(drunk)</span></code></pre></div>
<pre><code>## Warning in chisq.test(drunk): Chi-squared approximation may be
## incorrect</code></pre>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="#cb865-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cotabplot</span>(<span class="sc">~</span>age<span class="sc">|</span>sex,<span class="at">data=</span>drunk,<span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>)))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-343-1.png" width="960" /></p>
</div>
<div id="chisq.test-in-r" class="section level2">
<h2>15.4 chisq.test in R</h2>
<p>R에서는 chisq.test를 통해 간단하게 독립성 검정을 진행할 수 있다.<br />
H0: 두 변수들은 연관성이 없으며 서로 독립이다.<br />
H1: 두 변수들은 연관성이 있으며 서로 독립이아니다.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="#cb866-1" aria-hidden="true" tabindex="-1"></a>drunk.chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(drunk)</span></code></pre></div>
<pre><code>## Warning in chisq.test(drunk): Chi-squared approximation may be
## incorrect</code></pre>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="#cb868-1" aria-hidden="true" tabindex="-1"></a>drunk.chisq</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  drunk
## X-squared = 15.246, df = 4, p-value = 0.004217</code></pre>
<p>P-value = 0.004217로 유의수준 0.05보다 작으므로 두 변수들은 연관성이 있다고 할 수 있다.</p>
<p>Chi-squared test를 객체에 저장하게 되면 카이제곱 통계랑과 P-value 뿐만 아니라 다른 정보들도 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="co"># observed에는 주어진 교차표의 관찰값들이 들어가있다.</span></span>
<span id="cb870-2"><a href="#cb870-2" aria-hidden="true" tabindex="-1"></a>drunk.chisq<span class="sc">$</span>observed</span></code></pre></div>
<pre><code>##          age
## sex       0-29 30-39 40-49 50-59 &gt;=60
##   males    185   207   260   180   71
##   females    4    13    10     7   10</code></pre>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected에는 주어진 교차표의 기댓값들이 들어가있다.</span></span>
<span id="cb872-2"><a href="#cb872-2" aria-hidden="true" tabindex="-1"></a>drunk.chisq<span class="sc">$</span>expected</span></code></pre></div>
<pre><code>##          age
## sex             0-29     30-39     40-49     50-59      &gt;=60
##   males   180.218585 209.77825 257.45512 178.31151 77.236536
##   females   8.781415  10.22175  12.54488   8.68849  3.763464</code></pre>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="#cb874-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rsiduals에는 주어진 교차표들의 잔차를 포함한다.</span></span>
<span id="cb874-2"><a href="#cb874-2" aria-hidden="true" tabindex="-1"></a>drunk.chisq<span class="sc">$</span>residuals</span></code></pre></div>
<pre><code>##          age
## sex             0-29      30-39      40-49      50-59       &gt;=60
##   males    0.3561694 -0.1918186  0.1586048  0.1264471 -0.7096302
##   females -1.6135194  0.8689768 -0.7185117 -0.5728308  3.2147678</code></pre>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="#cb876-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차^2을 하게되면 각 잔체의 제곱 값을 확인할 수 있다.  </span></span>
<span id="cb876-2"><a href="#cb876-2" aria-hidden="true" tabindex="-1"></a>drunk.chisq<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>##          age
## sex              0-29       30-39       40-49       50-59
##   males    0.12685667  0.03679436  0.02515548  0.01598886
##   females  2.60344482  0.75512067  0.51625904  0.32813508
##          age
## sex              &gt;=60
##   males    0.50357497
##   females 10.33473181</code></pre>
</div>
<div id="two-dimensional-contingency-tables---fishers-exact-test" class="section level2">
<h2>15.5 Two-Dimensional Contingency Tables - Fisher’s Exact Test</h2>
<div id="example-do-juvenile-delinquents-eschew-wearing-eyeglasses" class="section level3">
<h3>15.5.1 Example-Do Juvenile Delinquents Eschew Wearing Eyeglasses?</h3>
<p>앞서 우리는 두 범주형 변수 간에 연관성을 확인하기 위해 카이제곱 검정을 실시하였다.<br />
그러나 만약 교차표에서 기대빈도가 5보다 작은 셀이 20%이상인 경우,<br />
카이제곱 검정보다 Fisher’s exact test를 수행하는 것이 좋다.</p>
<p>H0: 두 변수들은 연관성이 없으며 서로 독립이다.<br />
H1: 두 변수들은 연관성이 있으며 서로 독립이아니다.</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="#cb878-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(glasses)</span>
<span id="cb878-2"><a href="#cb878-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(glasses)</span></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  glasses
## p-value = 0.03497
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.0009525702 0.9912282442
## sample estimates:
## odds ratio 
## 0.06464255</code></pre>
<p>P-value = 0.03497로 유의수준 0.05보다 작으므로 두 변수들은 관련성이 있다고 할 수 있다.</p>
</div>
</div>
<div id="aedotplot" class="section level2">
<h2>15.6 AEdotplot</h2>
<p><code>HH</code> 패키지에 내장돼있는 <code>AEdotplot</code>은 데이터의 다양한 정보들을 패널을 나눔으로써 확인할 수 있게 해준다.<br />
여기서 사용한 AEdata는 암에 관련된 데이터이다.<br />
첫 번째 패널은 그룹별로 발생률을 표시하고 기호를 통해 그룹을 구분해준다.<br />
두 번째 패널은 95% 신뢰구간을 사용하여 암에 대한 상대적 위험을 표시한다.<br />
세 번째 패널에서는 각 치료에 대한 환자 수, 각 치료에 대한 부작용 수 및 상대적 위험이 표시된다.</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="#cb880-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb880-2"><a href="#cb880-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AEdata)</span>
<span id="cb880-3"><a href="#cb880-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AEdotplot</span>(AE<span class="sc">~</span>nAE<span class="sc">/</span>nTRT,<span class="at">groups=</span>TRT,<span class="at">data=</span>AEdata)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-347-1.png" width="960" /></p>
</div>
<div id="stacked-plot" class="section level2">
<h2>15.7 stacked plot</h2>
<p>barplot 함수에 table 데이터를 넣게 되면 자동으로 교차표에 따른 stack plot을 그려준다.<br />
<code>beside=FALSE</code>옵션을 지정하게 되면 Stacked 막대그림,<br />
<code>beside=TRUE</code>옵션을 지정하게 되면 Side형 막대그림을 그릴 수 있다.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="#cb881-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(drunk)</span>
<span id="cb881-2"><a href="#cb881-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(drunk,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>),<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;males&#39;</span>,<span class="st">&#39;females&#39;</span>),</span>
<span id="cb881-3"><a href="#cb881-3" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>,<span class="at">beside=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-348-1.png" width="960" /></p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="#cb882-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(drunk)</span>
<span id="cb882-2"><a href="#cb882-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(drunk,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#7685C8&quot;</span>,<span class="st">&quot;#E99FAD&quot;</span>),<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;males&#39;</span>,<span class="st">&#39;females&#39;</span>),</span>
<span id="cb882-3"><a href="#cb882-3" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>,<span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-349-1.png" width="960" /></p>
</div>
<div id="waffle-plot" class="section level2">
<h2>15.8 Waffle plot</h2>
<p><code>waffle plot</code>또한 각 범주의 빈도수를 시각화 하기에 좋은 방법이다.<br />
시각화 된 결과가 Waffle과 비슷하여 <code>Waffle plot</code>이라는 이름이 붙었다고 한다.</p>
<p>Cyl에 따른 차량의 개수를 파악하기 위해 dplyr함수를 통해 전처리를 진행해주었다.</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="#cb883-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb883-2"><a href="#cb883-2" aria-hidden="true" tabindex="-1"></a>Cyl_freq <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb883-3"><a href="#cb883-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb883-4"><a href="#cb883-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>())</span></code></pre></div>
<p><code>Waffle</code>함수는 빈도수를 가지고 있는 열을 입력해주면 쉽게 그릴 수 있다.<br />
- rows: 가로의 갯수를 지정한다.</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="#cb884-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(waffle)</span></code></pre></div>
<pre><code>## Warning: package &#39;waffle&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="#cb886-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waffle</span>(Cyl_freq<span class="sc">$</span>count,<span class="at">rows=</span><span class="dv">5</span>,<span class="at">title=</span><span class="st">&quot;Waffle plot of cyl&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-351-1.png" width="960" /></p>
<p>범례의 이름을 지정하기 위해서는 데이터를 넣을 때 <code>항목 이름 = 숫자</code>형태로 넣으면 된다.</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="#cb887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(waffle)</span>
<span id="cb887-2"><a href="#cb887-2" aria-hidden="true" tabindex="-1"></a><span class="fu">waffle</span>(<span class="fu">c</span>(<span class="st">&quot;4&quot;</span><span class="ot">=</span><span class="dv">11</span>,<span class="st">&quot;6&quot;</span><span class="ot">=</span><span class="dv">7</span>,<span class="st">&quot;8&quot;</span><span class="ot">=</span><span class="dv">14</span>),<span class="at">rows=</span><span class="dv">5</span>,<span class="at">title=</span><span class="st">&quot;Waffle plot of cyl&quot;</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-352-1.png" width="960" /></p>
<p>waffle plot을 그릴 때 네모난 모양이 아닌 자기가 원하는 그림을 그리고 싶은 경우가 있을 수 있다.<br />
이러한 경우, R과 호환되는 Font-Awesome을 다운 받은 후 R에 추가하는 작업을 거쳐야 한다.</p>
<ol style="list-style-type: decimal">
<li>font를 불러오기 위해 <code>extrafont</code>패키지를 설치한다.<br />
</li>
<li><em><a href="https://github.com/FortAwesome/Font-Awesome/releases/tag/v4.7.0" class="uri">https://github.com/FortAwesome/Font-Awesome/releases/tag/v4.7.0</a></em> 링크에서 fontawesome을 다운받는다.<br />
! 폰트를 다운받은 후 반드시 폰트를 설치해줘야 한다.</li>
</ol>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span></code></pre></div>
<pre><code>## Registering fonts with R</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><code>font_import</code>를 통해 다운받은 폰트를 import한다.<br />
</li>
</ol>
<ul>
<li><em>path</em>: 폰트를 설치한 위치.<br />
</li>
<li><em>pattern</em>: 지정한 경로에 파일이 많을 경우 시간이 오래걸리므로 지정한 이름으로 시작하는 파일만 불러온다.<br />
폰트를 import 한 후 font의 Familyname과 FontName, Fontfile을 살펴본다.</li>
</ul>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="fu">font_import</span>(<span class="at">path=</span><span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">eum20</span><span class="sc">\\</span><span class="st">Downloads&quot;</span>,<span class="at">pattern=</span><span class="st">&quot;fontawesome-&quot;</span>,<span class="at">prompt =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Scanning ttf files in C:\Users\eum20\Downloads ...</code></pre>
<pre><code>## Extracting .afm files from .ttf files...</code></pre>
<pre><code>## C:\Users\eum20\Downloads\Font-Awesome-4.7.0\Font-Awesome-4.7.0\fonts\fontawesome-webfont.ttf : FontAwesome already registered in fonts database. Skipping.
## C:\Users\eum20\Downloads\Font-Awesome-4.7.0\Font-Awesome-4.7.0\src\3.2.1\assets\font-awesome\font\fontawesome-webfont.ttf : FontAwesome already registered in fonts database. Skipping.
## C:\Users\eum20\Downloads\Font-Awesome-4.7.0\Font-Awesome-4.7.0\src\assets\font-awesome\fonts\fontawesome-webfont.ttf : FontAwesome already registered in fonts database. Skipping.
## C:\Users\eum20\Downloads\fontawesome-webfont.ttf : FontAwesome already registered in fonts database. Skipping.
## Found FontName for 0 fonts.
## Scanning afm files in C:/Users/eum20/Documents/R/win-library/4.0/extrafontdb/metrics</code></pre>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="#cb894-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fonttable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb894-2"><a href="#cb894-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb894-3"><a href="#cb894-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;Awesom&quot;</span>, FamilyName)) <span class="sc">%&gt;%</span> </span>
<span id="cb894-4"><a href="#cb894-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FamilyName, FontName, fontfile)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   FamilyName  FontName   fontfile                                  
##   &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;                                     
## 1 FontAwesome FontAweso~ &quot;C:\\Users\\eum20\\Downloads\\Font-Awesom~
## 2 FontAwesome FontAweso~ &quot;C:\\Users\\eum20\\Downloads\\Font-Awesom~
## 3 FontAwesome FontAweso~ &quot;C:\\Users\\eum20\\Downloads\\Font-Awesom~</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><code>load_fontawesome</code>을 이용하여 설치된 폰트를 로드한다. (<em>emojifont</em>패키지를 이용한다.)</li>
</ol>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="#cb896-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emojifont)</span></code></pre></div>
<pre><code>## Warning: package &#39;emojifont&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="#cb898-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load.fontawesome</span>(<span class="at">font =</span> <span class="st">&quot;fontawesome-webfont.ttf&quot;</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><code>showtext</code>패키지에 있는 <code>font_add</code>를 이용하여 폰트를 R에 내장시켜준다.</li>
</ol>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span></code></pre></div>
<pre><code>## Warning: package &#39;showtext&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: sysfonts</code></pre>
<pre><code>## Warning: package &#39;sysfonts&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: showtextdb</code></pre>
<pre><code>## Warning: package &#39;showtextdb&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;showtextdb&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:extrafont&#39;:
## 
##     font_install</code></pre>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="#cb907-1" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add</span>(<span class="at">family =</span> <span class="st">&quot;FontAwesome&quot;</span>, <span class="at">regular =</span> <span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">eum20</span><span class="sc">\\</span><span class="st">Downloads</span><span class="sc">\\</span><span class="st">fontawesome-webfont.ttf&quot;</span>)</span>
<span id="cb907-2"><a href="#cb907-2" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li><code>waffle</code>함수의 <em>use_glyph</em>를 이용하여 원하는 그림을 넣는다.<br />
</li>
</ol>
<ul>
<li><em>use_glyph</em> = 원하는 픽토그램의 모양<br />
</li>
<li><em>glyph_size</em> = 원하는 픽토그램의 사이즈</li>
</ul>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="#cb908-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waffle</span>(<span class="fu">c</span>(<span class="st">&quot;4&quot;</span><span class="ot">=</span><span class="dv">11</span>,<span class="st">&quot;6&quot;</span><span class="ot">=</span><span class="dv">7</span>,<span class="st">&quot;8&quot;</span><span class="ot">=</span><span class="dv">14</span>),<span class="at">rows=</span><span class="dv">4</span>,<span class="at">title=</span><span class="st">&quot;Waffle plot of cyl&quot;</span>,<span class="at">use_glyph=</span><span class="st">&quot;car&quot;</span>,<span class="at">glyph_size=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-357-1.png" width="960" /></p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="#cb909-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waffle</span>(<span class="fu">c</span>(<span class="st">&quot;Red&quot;</span><span class="ot">=</span><span class="dv">18</span>,<span class="st">&quot;Green&quot;</span><span class="ot">=</span><span class="dv">12</span>),<span class="at">rows=</span><span class="dv">5</span>,<span class="at">title=</span><span class="st">&quot;Number of Apple&quot;</span>,<span class="at">use_glyph=</span><span class="st">&quot;apple&quot;</span>,<span class="at">glyph_size=</span><span class="dv">15</span>,</span>
<span id="cb909-2"><a href="#cb909-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">colors=</span><span class="fu">c</span>(<span class="st">&quot;#FF9090&quot;</span>,<span class="st">&quot;#B7F0B1&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-358-1.png" width="960" /></p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="#cb910-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waffle</span>(<span class="fu">c</span>(<span class="st">&quot;Comic&quot;</span><span class="ot">=</span><span class="dv">8</span>,<span class="st">&quot;Horror&quot;</span><span class="ot">=</span><span class="dv">5</span>,<span class="st">&quot;SF&quot;</span><span class="ot">=</span><span class="dv">10</span>,<span class="st">&quot;Romance&quot;</span><span class="ot">=</span><span class="dv">7</span>),<span class="at">rows=</span><span class="dv">5</span>,<span class="at">title=</span><span class="st">&quot;Genre of book&quot;</span>,<span class="at">use_glyph=</span><span class="st">&quot;book&quot;</span>,<span class="at">glyph_size=</span><span class="dv">15</span>,</span>
<span id="cb910-2"><a href="#cb910-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">colors=</span><span class="fu">c</span>(<span class="st">&quot;#FFE08C&quot;</span>,<span class="st">&quot;#7F7EFF&quot;</span>,<span class="st">&quot;#818181&quot;</span>,<span class="st">&quot;#FF8383&quot;</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-359-1.png" width="960" /></p>
<p>앞선 waffle 그림보다 훨씬 그림이 한 눈에 들어오는 것을 확인할 수 있다.</p>
<hr />
<p><code>iron</code> 함수를 이용하면 픽토그램의 모양을 여러개로 지정하여 한 그래프 안에 그릴 수 있다.</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="#cb911-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iron</span>(<span class="fu">waffle</span>(<span class="fu">c</span>(<span class="st">&#39;Female&#39;</span><span class="ot">=</span><span class="dv">10</span>),<span class="at">colors=</span><span class="st">&quot;#FF5A5A&quot;</span>,<span class="at">use_glyph =</span> <span class="st">&quot;female&quot;</span>,<span class="at">glyph_size =</span> <span class="dv">15</span>,<span class="at">rows=</span><span class="dv">1</span>,<span class="at">title=</span><span class="st">&quot;Female &amp; Male&quot;</span>),</span>
<span id="cb911-2"><a href="#cb911-2" aria-hidden="true" tabindex="-1"></a><span class="fu">waffle</span>(<span class="fu">c</span>(<span class="st">&#39;Male&#39;</span><span class="ot">=</span><span class="dv">20</span>),<span class="at">colors=</span><span class="st">&quot;#5AAEFF&quot;</span>,<span class="at">use_glyph =</span> <span class="st">&quot;male&quot;</span>,<span class="at">glyph_size =</span> <span class="dv">15</span>,<span class="at">rows=</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-360-1.png" width="960" /></p>
</div>
<div id="bubble-chart" class="section level2">
<h2>15.9 Bubble chart</h2>
<p><code>Bubble chart</code>는 데이터의 크기에 따라 그래프의 모양을 다르게 해주는 그림이다.<br />
즉, 비중이 높을수록 그래프의 크기가 더욱 커진다.</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="#cb912-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb912-2"><a href="#cb912-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars,<span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>qsec,<span class="at">colour=</span>am))<span class="sc">+</span></span>
<span id="cb912-3"><a href="#cb912-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size=</span><span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb912-4"><a href="#cb912-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>hp),<span class="at">shape=</span><span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb912-5"><a href="#cb912-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bubble chart of mtcars&quot;</span>)<span class="sc">+</span></span>
<span id="cb912-6"><a href="#cb912-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="202140191_엄태훈_기말고사-CSS포함-_files/figure-html/unnamed-chunk-361-1.png" width="960" /></p>
<p>x축은 mtcars의 disp, y축은 mtcars의 qsec로 나타내었다.<br />
차량의 기어가 automatic인지, manual인지에 따라서 색깔을 구분해주었고 (Auto=0,Manual=1)<br />
bubble의 크기는 hp에 따라서 크기를 다르게 하였다.</p>
<hr />
</div>
<div id="summary-of-chapter15" class="section level2">
<h2>Summary of Chapter15</h2>
<ul>
<li><p>R에서는 다양한 형태의 데이터 자료 구조를 만들 수 있는데 대표적으로 많이 사용되는 구조는 행과 열로 이루어진 <strong>data.frame</strong> 구조이다. 우리가 가지고 있는 거의 모든 데이터들은 관측치를 가지고 있는 행과 변수를 나타내는 열로 구성되어 있기 때문에 R에서 <strong>data.frame</strong>구조를 이용하면 데이터를 쉽게 불러오고 분석하기 용이한 구조로 만들 수 있다.</p></li>
<li><p><strong>교차표</strong>는 범주형 변수들의 조합에 따른 빈도를 표로 나타낸 것을 말한다. 이러한 데이터 형태를 R에서는 <strong>table 데이터</strong>라고 한다. table 데이터의 경우 데이터 프레임에 비해서 다루기가 쉽지않기 때문에 적절한 전처리와 분석방법을 이용하는 것이 좋다. 특히, R의 <code>unlist</code>함수를 이용하면 조금 더 쉽게 table 데이터를 처리할 수 있다.</p></li>
<li><p>교차표 같은 경우, 빈도와 범주로 구성돼 있기 때문에 요약된 표를 통해서는 한 눈에 차이를 살펴보기 어렵다. 따라서, 시각화 기법을 이용해 결과를 정리하는 것이 중요하다. 대표적인 예시로는 <code>barplot</code>, <code>pieplot</code>등을 예시로 들 수 있다.</p></li>
<li><p><strong>모자이크 플랏(Mosaic plot)</strong>은 두 개 이상의 다변량 범주형 자료를 시각화 하는 기법 중 하나이다. 범주에 따라서 색깔이 달라지고 빈도에 따라서 사각형의 넓이가 달라지기 때문에 barplot, pieplot에 비해서 데이터가 내포하고 있는 정보를 조금 더 쉽게 얻을 수 있다는 장점이 있다.</p></li>
<li><p>앞에서 살펴본 그림 외에도 교차표를 시각화 할 수 있는 방법과 함수는 상당히 많다. 범주와 빈도를 시각화할 수 있는 많은 방법들을 찾아보고 데이터 특징과 분석 상황에 맞는 적절한 그래프를 그릴 수 있게 연습하는 것이 좋다.</p></li>
<li><p><strong>적합도 검정(Goodness of fit test)</strong>는 관측값들이 어떤 이론적인 특정 분포를 따르고 있는지를 검정하는 것이다. 보통 한 개의 요인을 대상으로 하는 경우가 많다.</p></li>
<li><p><strong>적합도 검정</strong>의 귀무가설과 대립 가설은 다음과 같다.<br />
-&gt; 귀무가설 H0: 관측값의 도수와 가정한 이론 도수가 동일하다. (관측값이 특정 분포를 따른다.)<br />
-&gt; 대립가설 H1: 적어도 하나의 범주 (혹은 계급)의 도수가 가정한 이론도수(기대 관측도수)와 다르다. (관측값이 특정 분포를 따르지 않는다.)</p></li>
<li><p><strong>독립성 검정</strong>은 서로 다른 요인들에 의해 분할되어 있는 경우 그 요인들이 관찰값에 영향을 주고 있는지 아닌지, 요인들이 서로 연관이 있는지 없는지를 검정하는 것을 말한다.</p></li>
<li><p><strong>독립성 검정의</strong> 가설은 다음과 같다. -&gt; 귀무가설 H0: 두 변수 X와 Y는 서로 독립이다.(관련성이 없다.) -&gt; 대립가설 H1: 두 변수 X와 Y는 서로 독립이 아니다.(관련성이 있다.)</p></li>
</ul>
<hr />
</div>
</div>
<div id="reference-of-all-chapters" class="section level1">
<h1>Reference of All chapters</h1>
<p><a href="https://ko.wikipedia.org/wiki/%EC%9C%84%ED%82%A4%EB%B0%B1%EA%B3%BC:%EB%8C%80%EB%AC%B8">위키백과</a><br />
<a href="https://m.blog.naver.com/PostView.nhn?isHttpsRedirect=true&amp;blogId=y4769&amp;logNo=220146051135&amp;proxyReferer=">보건과학통계 SPSS 이야기</a><br />
<a href="https://rfriend.tistory.com/">Rfriend</a></p>
<hr />
<hr />
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
