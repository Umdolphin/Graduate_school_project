<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="202140191 엄태훈" />


<title>통계방법론 Chap12 실습코드</title>

<script src="Chap12_files/header-attrs-2.7/header-attrs.js"></script>
<script src="Chap12_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Chap12_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="Chap12_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Chap12_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Chap12_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="Chap12_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="Chap12_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="Chap12_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="Chap12_files/navigation-1.1/tabsets.js"></script>
<script src="Chap12_files/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">통계방법론 Chap12 실습코드</h1>
<h4 class="author">202140191 엄태훈</h4>
<h4 class="date">2021-05-08(SAT)</h4>

</div>


<body style="background-color:#FFFFE6">
<style type="text/css">
  body{
     font-size: 16px;
     font-family: 맑은 고딕
  }
  td{
     font-size: 16px;
     font-family: 맑은 고딕
  }
  code.r{
    font-size: 16px;
    font-weight: bold;
    font-family: 맑은 고딕
  }
  pre {
    font-size: 14px
    font-family: 맑은 고딕
  }
  h1,h2,h3,h4,h5,h6{
    font-family: 맑은 고딕;
  }
  h1{
    font-size: 22pt;
  }
  h2{
    font-size: 20pt;
  }
  h3{
    font-size: 18pt;
  }
</style>
<p><br></p>
<div id="chapter12-two-way-analysis-of-variance" class="section level1">
<h1>Chapter12 Two-Way Analysis of Variance</h1>
<p>앞 챕터의 일원분산분석(One-Way Anova)는 설명변수가 1개, 종속변수가 1개 일 때 모집단에 대한 평균을 비교하는 방법이었다.<br />
일원분산분석에서 종속변수는 연속형 자료 이어야하고, 설명변수는 대체로 3개 이상의 집단을 갖는 범주형 변수이어야 했다.</p>
<p><strong>이원분산분석(Two-way Anova)</strong>는 One-way Anova와 달리, 설명변수가 2개, 종속변수가 1개 일 때 모집단에 대한 평균을 비교하는 방법이다.<br />
일반적으로, 설명변수 2개를 <strong>주효과</strong>라고 일컫는다.<br />
이때, One-Way Anova와 동일하게 설명변수는 범주형 자료이어야 한다.</p>
<p>또한, 이원분산분석은 일원분산분석과는 주효과간 차이와 더불어, <strong>교호작용</strong>이라는 추가적인 효과를 고려한다.<br />
<strong>교호작용</strong>은 두 주효과가 서로 상호간에 영향을 주고 받으면서 나타나는 반응효과를 말한다.</p>
<p>기본 가정사항은 <strong>독립성</strong>, <strong>정규성</strong>, <strong>등분산성</strong>으로 일원분산분석과 같은 기본 가정사항을 가진다.</p>
<p>주효과 A를 지하철 이용 방법, 주효과 B를 지하철역, 반응변수를 승객의 수라고 하자.<br />
이원분산분석의 귀무가설은 다음과 같다.</p>
<p><strong>주효과 A에 대한 귀무가설</strong> H0: 지하철 이용 방법에 따른 승객의 수의 차이가 없을 것이다.<br />
H1: 지하철 이용 방법에 따른 승객의 수의 차이가 있을 것이다.</p>
<p><strong>주효과 B에 대한 귀무가설</strong> H0: 지하철 역에 따른 승객의 수의 차이가 없을 것이다.<br />
H1: 지하철 역에 따른 승객의 수의 차이가 있을 것이다.</p>
<p><strong>교호작용에 대한 귀무가설</strong> H0: 지하철이용 방법과 지하철 역의 교호작용 효과가 없을 것이다.<br />
H1: 지하철이용 방법과 지하철 역의 교호작용 효과가 있을 것이다.</p>
<hr />
<div id="example-display-panel-data" class="section level2">
<h2>12.1 Example-Display Panel Data</h2>
<div id="analysis-goals" class="section level3">
<h3>12.1.3 Analysis Goals</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span></code></pre></div>
<pre><code>## Warning: package &#39;HH&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: latticeExtra</code></pre>
<pre><code>## Warning: package &#39;latticeExtra&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: multcomp</code></pre>
<pre><code>## Warning: package &#39;multcomp&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## Warning: package &#39;TH.data&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<pre><code>## Loading required package: gridExtra</code></pre>
<pre><code>## Warning: package &#39;gridExtra&#39; was built under R version 4.0.4</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(display)</span></code></pre></div>
<p><strong>display</strong> 데이터는 아래와 같이 구성 돼있다.</p>
<ul>
<li>time: 초를 기준으로한 시간. <strong>(반응변수)</strong><br />
</li>
<li>panel: 3개의 범주로 구성된 테스트 중인 패널. <strong>(설명변수)</strong><br />
</li>
<li>emergenc: 4개의 범주로 구성된 시뮬레이션 된 비상상황. <strong>(설명변수)</strong></li>
<li>panel.ordered: 반응 평균의 순서와 맞도록 수준이 정렬된 패널요인의 반복.</li>
</ul>
<hr />
<p>anova Formula에서 <code>변수*변수</code>의 형태로 지정을 해주게 되면, 그 두 변수의 주효과와 더불어 교호작용의 유의성까지 확인할 수 있다.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>displayf.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(time<span class="sc">~</span>emergenc<span class="sc">*</span>panel,<span class="at">data=</span>display)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(displayf.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: time
##                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## emergenc        3 1052.46  350.82 60.5731 1.612e-07 ***
## panel           2  232.75  116.38 20.0935 0.0001478 ***
## emergenc:panel  6   28.92    4.82  0.8321 0.5675015    
## Residuals      12   69.50    5.79                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, 2개의 주효과는 유의확률이 유의수준 0.05보다 작으므로 유의하다.<br />
따라서, 2개의 주효과 모두 적어도 한 집단 간 유의한 차이가 발생하는 것을 알 수 있다.</p>
<p>교호작용의 경우, <strong>emergenc:panel</strong>의 형태로 표시되며, 유의확률이 유의수준 0.05보다 크므로 유의하지 않다.<br />
따라서 두 개의 주효과의 교호작용 효과는 유의하지 않음을 알 수 있다.</p>
<hr />
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(time <span class="sc">~</span> panel.ordered <span class="sc">*</span> emergenc, <span class="at">data=</span>display)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
<p><code>interaction2wt</code>을 통해 교호작용 그림을 그리게되면 위와같은 결과를 얻을 수 있다.<br />
먼저, 각 독립변수의 범주별 반응변수에 대한 boxplot을 확인할 수 있다. 이를 통해, 주효과의 집단에 따라 주효과의 변화를 살펴 볼 수 있다.<br />
또한, 왼쪽위와 오른쪽 아래 패널은 교호작용 그래프를 나타낸다.<br />
왼쪽 위의 그래프는 거의 평행하고 오른쪽 아래의 교호작용의 plot은 교차점이 있지만 선마다 거의 평행을 이룸을 볼 수 있다.<br />
이를 통해, 우리는 교호작용의 효과가 유의하지 않음을 확인할 수 있다.</p>
<hr />
<p>또 다른 교호작용 효과 확인 방법으로는 <code>interaction.plot</code>함수는 교호작용에 대한 plot만을 그릴 수 있다.</p>
<p><code>interaction.plot(x.factor,trace.factor,reponse)</code>를 이용하여 그린다.</p>
<ul>
<li>x.factor: x축에 올 독립변수<br />
</li>
<li>trace.factor: y축에 올 또 다른 독립변수</li>
<li>reponse: 반응변수</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(<span class="at">x.factor =</span> display<span class="sc">$</span>panel.ordered,<span class="at">trace.factor=</span>display<span class="sc">$</span>emergenc,<span class="at">response=</span>display<span class="sc">$</span>time,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab=</span><span class="st">&quot;emergenc&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;panel.ordered&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-5-1.png" width="960" /></p>
<p>interaction.plot의 결과, 앞에서 우리가 그려봤던 상호작용 plot 그림과 동일한 그림을 얻을 수 있다.</p>
<hr />
<p><code>mmc</code>함수에서 <code>foucs</code>옵션은 독립변수 중 어느 변수를 기준으로 다중비교 분석을 진행할지 결정하는 옵션이다.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>displayf.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(displayf.aov,<span class="at">focus=</span><span class="st">&quot;panel&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>displayf.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = time ~ emergenc * panel, data = display) 
## Estimated Quantile = 2.668563 
## 95% family-wise confidence level
## $mca
##     estimate   stderr     lower     upper  height
## 3-1    5.375 1.203294  2.163934  8.586066 22.9375
## 3-2    7.375 1.203294  4.163934 10.586066 21.9375
## 1-2    2.000 1.203294 -1.211066  5.211066 19.2500
## $none
##   estimate    stderr    lower    upper height
## 3   25.625 0.8508574 23.35443 27.89557 25.625
## 1   20.250 0.8508574 17.97943 22.52057 20.250
## 2   18.250 0.8508574 15.97943 20.52057 18.250</code></pre>
<p>panel 집단에 대한 다중비교 분석결과, 3-1,3-2 집단은 신뢰구간이 0을 포함하지 않으므로 집단 간 차이가 있음을 알수 있다.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(displayf.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<p><code>mmcplot</code>을 통해 유의한 차이가 있는 집단이 붉은색으로 지정된 것을 시각적으로 확인할 수 있다.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(displayf.mmc,<span class="at">type=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
<p><code>type=none</code>으로 지절하는 경우, 각 집단의 종속변수에 대한 신뢰구간에 대한 그림을 그릴 수 있다.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>displayr.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(time<span class="sc">~</span><span class="fu">Error</span>(emergenc<span class="sc">/</span>panel)<span class="sc">+</span>panel,<span class="at">data=</span>display)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(displayr.aov)</span></code></pre></div>
<pre><code>## 
## Error: emergenc
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals  3   1052   350.8               
## 
## Error: emergenc:panel
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## panel      2 232.75  116.38   24.15 0.00135 **
## Residuals  6  28.92    4.82                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error: Within
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals 12   69.5   5.792</code></pre>
<p>위의 anova의 Formula는 우리가 알고있는 형태와 많이 다른 것을 확읺라 수 있다.<br />
<strong>Error(emergenc/panel)+panel</strong>의 의미는 emergenc 변수는 random 인자로, panel 인자는 fixed 인자로 설정한다는 것이다.<br />
또한, Error가 분수의 꼴로 돼있으므로 panel변수가 emergenc 내에서 nested한다는 의미도 가지고 있다.</p>
</div>
</div>
<div id="example-the-blood-plasma-data" class="section level2">
<h2>12.9 Example-The Blood Plasma Data</h2>
<div id="analysis" class="section level3">
<h3>12.9.3 Analysis</h3>
<p><br></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(plasma)</span></code></pre></div>
<p><strong>plasma</strong> 데이터는 위와 같이 구성 돼있다.</p>
<ul>
<li>plasma: 플라즈마의 시트레이트 농도(마이크로몰/리터 단위) <strong>(반응변수)</strong><br />
</li>
<li>time: 5개의 범주를 갖는 시간. <strong>(설명변수)</strong><br />
</li>
<li>id: 10개의 범주로 구성된 요인. 과목당 하나씩 있다. <strong>(설명변수)</strong></li>
</ul>
<hr />
<p>데이터를 살펴보기 위해 x축을 time으로하고 y축을 plasma로 한 다음 id의 범주별 그래프를 그린 결과는 아래와 같다.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(plasma <span class="sc">~</span> time <span class="sc">|</span> id, <span class="at">data=</span>plasma, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span>.<span class="dv">5</span>))</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
<p>아래의 Formula는 id를 random effect, time은 fixed effect로 지정한 후, 분산분석을 진행한다는 의미이다.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plasma.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(plasma <span class="sc">~</span> <span class="fu">Error</span>(id)<span class="sc">+</span>time,<span class="at">data=</span>plasma)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plasma.aov)</span></code></pre></div>
<pre><code>## 
## Error: id
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals  9  10593    1177               
## 
## Error: Within
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## time       4   2804   701.0   4.754 0.00349 **
## Residuals 36   5308   147.5                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(plasma <span class="sc">~</span> time<span class="sc">*</span> id, <span class="at">data=</span>plasma)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-13-1.png" width="960" /></p>
<p>plasma데이터의 교호작용 그림의 결과이다. 교호작용 패널의 그래프를 보면 선간의 교차점이 꽤 많은 것을 알 수 있다.<br />
이를 통해, 두 독립변수 간 교호작용 효과가 존재할수도 있다는 추정을 해볼 수 있다.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plasma<span class="sc">$</span>time <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">factor</span>(plasma<span class="sc">$</span>time,<span class="at">levels=</span><span class="fu">unique</span>(plasma<span class="sc">$</span>time),<span class="at">ordered=</span><span class="cn">FALSE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>plasma.aov2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(plasma <span class="sc">~</span> id <span class="sc">+</span> time, <span class="at">data=</span>plasma)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>plasma.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(plasma.aov2,<span class="at">focus=</span><span class="st">&quot;time&quot;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>plasma.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = plasma ~ id + time, data = plasma) 
## Estimated Quantile = 2.870798 
## 95% family-wise confidence level
## $mca
##          estimate   stderr       lower    upper height
## 11am-2pm      7.6 5.430613  -7.9901946 23.19019 124.10
## 11am-8pm      8.2 5.430613  -7.3901946 23.79019 123.80
## 11am-8am      9.4 5.430613  -6.1901946 24.99019 123.20
## 2pm-8pm       0.6 5.430613 -14.9901946 16.19019 120.00
## 2pm-8am       1.8 5.430613 -13.7901946 17.39019 119.40
## 8pm-8am       1.2 5.430613 -14.3901946 16.79019 119.10
## 11am-5pm     23.1 5.430613   7.5098054 38.69019 116.35
## 2pm-5pm      15.5 5.430613  -0.0901946 31.09019 112.55
## 8pm-5pm      14.9 5.430613  -0.6901946 30.49019 112.25
## 8am-5pm      13.7 5.430613  -1.8901946 29.29019 111.65
## $none
##      estimate   stderr     lower    upper height
## 11am    127.9 3.840023 116.87607 138.9239  127.9
## 2pm     120.3 3.840023 109.27607 131.3239  120.3
## 8pm     119.7 3.840023 108.67607 130.7239  119.7
## 8am     118.5 3.840023 107.47607 129.5239  118.5
## 5pm     104.8 3.840023  93.77607 115.8239  104.8</code></pre>
<p><strong>다중비교</strong>를 진행한 결과, 11am과 5pm 집단만이 신뢰구간 0을 포함하지 않는다.<br />
따라서, 11am-5pm 집단간 차이만이 유의한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(plasma.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-15-1.png" width="960" /></p>
<p>다중비교의 결과를 plot을 통해 나타낸 결과, 11am-5pm 집단 간 차이가 유의하여 붉은색으로 지정된 것을 확인할 수 있다.</p>
</div>
</div>
<div id="introduction-to-nesting" class="section level2">
<h2>12.13 Introduction to Nesting</h2>
<div id="example-workstation-data" class="section level3">
<h3>12.13.1 Example-Workstation Data</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;workstation&quot;</span>)</span></code></pre></div>
<p><strong>station</strong> 데이터는 위와 같이 구성 돼있다.</p>
<ul>
<li>metohd: 1시간 동안 생산된 장치의 갯수 <strong>(반응변수)</strong><br />
</li>
<li>station: 2개의 범주로 구성된 지하철역. <strong>(설명변수)</strong><br />
</li>
<li>devices: 3개의 범주로 구성된 조립 방법. <strong>(설명변수)</strong></li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(devices<span class="sc">~</span>station<span class="sc">|</span>method,<span class="at">data=</span>workstation)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-17-1.png" width="960" /></p>
<p>boxplot을 살펴본결과, station에 따라 평균이 달라지는 것을 알 수 있고 metohd의 범주에 따라서도 boxplot의 평균이 달라지는 것을 확인할 수 있다.</p>
</div>
<div id="analysis-goals-1" class="section level3">
<h3>12.13.3 Analysis Goals</h3>
<p>아래의 anova formula는 station 변수가 method 변수에 대해서 nested 된 것을 가르키며, 그에 따른 분산분석을 진행하는 것이다.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>workstation.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(devices<span class="sc">~</span>method<span class="sc">/</span>station,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>workstation)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(workstation.aov)</span></code></pre></div>
<pre><code>##                Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## method          2 1545.3   772.6  51.452 2.09e-09 ***
## method:station  3  210.2    70.1   4.666   0.0105 *  
## Residuals      24  360.4    15.0                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, metohd의 주효과는 유의한 차이가 있는 것을 알 수 있고, station을 method에 대해서 netsted 했을 때의 두 변수간 교호작용은 유의한 것으로 확인되는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(workstation.aov,<span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 23.06667 
## 
##  method 
## method
##    1    2    3 
## 14.8 22.1 32.3 
## 
##  method:station 
##       station
## method 1    2   
##      1 11.8 17.8
##      2 19.2 25.0
##      3 30.4 34.2
## 
## Standard errors for differences of means
##         method method:station
##          1.733          2.451
## replic.     10              5</code></pre>
<p><code>model.tables</code>를 통해 station과 method에 대한 그룹의 평균과 더불어, 전체 평균에 대한 정보를 알 수 있다.<br />
또한, <code>se=TRUE</code>옵션을 추가하여 standard errors에 대한 정보까지 확인할 수 있다.</p>
</div>
</div>
<div id="example-the-rhizobium-data" class="section level2">
<h2>12.14 Example-The Rhizobium Data</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;rhiz.alfalfa&quot;</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(rhiz.alfalfa<span class="sc">$</span>comb)</span></code></pre></div>
<pre><code>## [1] alfalfa        alfalfa+clover
## Levels: alfalfa alfalfa+clover</code></pre>
<p><strong>rhiz.alfala</strong>는 clover에서 자라는 박테리아에 대한 정보로 구성된 데이터이다.<br />
<strong>rhiz.alfalfa</strong> 데이터의 2-way 독립변수는 아래 와 같이 구성 돼있다.</p>
<ul>
<li>strain: 실험에 사용되는 박테리아의 종류. 6개의 범주로 구성됐다. <strong>(반응변수)</strong><br />
</li>
<li>comb: 2개의 범주로 구성된 순수 박테리아와 혼합된 박테리아. <strong>(설명변수)</strong></li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(weight<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(nitro<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(Npg<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-21-1.png" width="960" /></p>
<p>comb변수를 group으로 rhiz.alfalfa의 종속변수들에 대한 boxplot을 그린 결과이다.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;rhiz.clover&quot;</span>)</span></code></pre></div>
<p><strong>rhiz.clover</strong>는 clover에서 자라는 박테리아에 대한 정보로 구성된 데이터이다.<br />
독립변수와 종속변수는 <strong>rhiz.alfala</strong>데이터와 같다.<br />
단, strain에 대한 독립변수의 level은 다르게 구성됐다.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(weight<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(nitro<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(Npg<span class="sc">~</span>strain<span class="sc">|</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p5,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p6,<span class="at">split=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">more=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-23-1.png" width="960" /></p>
<p>comb변수를 group으로 rhiz.clover의 종속변수들에 대한 boxplot을 그린 결과이다.</p>
<div id="alfalfa-analysis" class="section level3">
<h3>12.14.6 Alfalfa Analysis</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## unset position(rhiz.alfalfa$comb) for glht</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>rhiz.alfalfa.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.alfalfa)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.alfalfa.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## strain       5  46.22   9.244   4.565 0.00174 **
## comb         1   0.57   0.573   0.283 0.59714   
## strain:comb  5   8.44   1.687   0.833 0.53275   
## Residuals   48  97.21   2.025                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석 결과, <strong>strain</strong>변수는 적어도 한 집단 간 차이가 유의하다는 결론이 나왔고 comb변수와 교호작용 효과는 유의하지 않은 것을 알 수 있다.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>alf.means <span class="ot">&lt;-</span> <span class="fu">model.tables</span>(rhiz.alfalfa.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>,<span class="at">cterms =</span> <span class="st">&quot;strain&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>alf.means</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 30.73547 
## 
##  strain 
## strain
##  3DOa1  3DOa7 3DOa10 3DOa12 3DOa15 a.comp 
##  30.00  29.89  30.00  30.82  31.43  32.27 
## 
## Standard errors for differences of means
##         strain
##         0.6364
## replic.     10</code></pre>
<p><code>model.tables</code>를 통해 집단 간 평균과 standard error에 대한 결과를 얻을 수 있다.<br />
<code>cterms</code> 옵션을 이용하여 <strong>strain</strong>변수에 대한 정보만을 확인한다.<br />
a.comp 범주가 평균이 가장 높은 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>old.fin <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>fin</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">fin=</span><span class="fu">c</span>(old.fin[<span class="dv">1</span>], <span class="fl">2.5</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.01</span>,<span class="dv">1</span>,.<span class="dv">99</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">x=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">29.5</span>, <span class="fl">32.7</span>),<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(.<span class="dv">85</span>,<span class="fl">1.10</span>), <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rug</span>(alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain, <span class="at">ticksize=</span><span class="sc">-</span>.<span class="dv">1</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Npg&quot;</span>, <span class="dv">3</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">29.7</span>,<span class="fl">31.5</span>), <span class="at">y=</span><span class="fu">c</span>(.<span class="dv">95</span>,.<span class="dv">95</span>))</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">30.5</span>,<span class="fl">32.5</span>), <span class="at">y=</span><span class="fu">c</span>(.<span class="dv">90</span>,.<span class="dv">90</span>))</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>strain.labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">dimnames</span>(alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain)[[<span class="dv">1</span>]],</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">format</span>(alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain, <span class="at">digits=</span><span class="dv">6</span>),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sep=</span><span class="st">&quot;: &quot;</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">6</span>)], <span class="at">labels=</span>strain.labels[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,  <span class="dv">6</span>)], <span class="at">line=</span><span class="dv">1</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">45</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="fu">c</span>(    <span class="dv">5</span>  )], <span class="at">labels=</span>strain.labels[<span class="fu">c</span>(    <span class="dv">5</span>  )], <span class="at">line=</span><span class="dv">2</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">45</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="dv">3</span>         ], <span class="at">labels=</span>strain.labels[<span class="dv">3</span>         ], <span class="at">line=</span><span class="dv">2</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">45</span>)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>alf.means<span class="sc">$</span>tables<span class="sc">$</span>strain[<span class="dv">1</span>         ], <span class="at">labels=</span>strain.labels[<span class="dv">1</span>         ], <span class="at">line=</span><span class="dv">3</span>, <span class="at">tick=</span><span class="cn">FALSE</span>, <span class="at">adj=</span>.<span class="dv">4</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-26-1.png" width="960" /></p>
<p><code>model.tables</code>의 결과를 <code>plot,lines,axis</code>함수를 통하여 시각적으로 나타낼 수도 있다.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">fin=</span>old.fin)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>rhiz.alfalfa.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.alfalfa.aov,<span class="at">focus=</span><span class="st">&quot;strain&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>rhiz.alfalfa.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Npg ~ strain * comb, data = rhiz.alfalfa) 
## Estimated Quantile = 2.967764 
## 95% family-wise confidence level
## $mca
##                 estimate    stderr      lower    upper   height
## a.comp-3DOa15 0.83028658 0.6364341 -1.0584998 2.719073 31.84986
## a.comp-3DOa12 1.44791050 0.6364341 -0.4408759 3.336697 31.54105
## a.comp-3DOa1  2.26191405 0.6364341  0.3731277 4.150700 31.13405
## a.comp-3DOa10 2.26529871 0.6364341  0.3765123 4.154085 31.13235
## 3DOa15-3DOa12 0.61762392 0.6364341 -1.2711625 2.506410 31.12590
## a.comp-3DOa7  2.37176042 0.6364341  0.4829740 4.260547 31.07912
## 3DOa15-3DOa1  1.43162747 0.6364341 -0.4571589 3.320414 30.71890
## 3DOa15-3DOa10 1.43501213 0.6364341 -0.4537742 3.323799 30.71721
## 3DOa15-3DOa7  1.54147383 0.6364341 -0.3473125 3.430260 30.66398
## 3DOa12-3DOa1  0.81400355 0.6364341 -1.0747828 2.702790 30.41009
## 3DOa12-3DOa10 0.81738821 0.6364341 -1.0713982 2.706175 30.40840
## 3DOa12-3DOa7  0.92384991 0.6364341 -0.9649365 2.812636 30.35517
## 3DOa1-3DOa10  0.00338466 0.6364341 -1.8854017 1.892171 30.00140
## 3DOa1-3DOa7   0.10984636 0.6364341 -1.7789400 1.998633 29.94817
## 3DOa10-3DOa7  0.10646170 0.6364341 -1.7823247 1.995248 29.94647
## $none
##        estimate    stderr    lower    upper   height
## a.comp 32.26500 0.4500269 30.92943 33.60058 32.26500
## 3DOa15 31.43472 0.4500269 30.09914 32.77029 31.43472
## 3DOa12 30.81709 0.4500269 29.48152 32.15267 30.81709
## 3DOa1  30.00309 0.4500269 28.66751 31.33866 30.00309
## 3DOa10 29.99970 0.4500269 28.66413 31.33528 29.99970
## 3DOa7  29.89324 0.4500269 28.55767 31.22882 29.89324</code></pre>
<p>다중비교를 진행한 결과, <strong>a.comp-3DOa1</strong>, <strong>a.comp-3DOa10</strong>, <strong>a.comp-3DOa7</strong>, 집단의 평균차이 신뢰구간이 0을 포함하지 않으므로 집단 간 차이가 유의한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(rhiz.alfalfa.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-29-1.png" width="960" /></p>
<p><code>mmcplot</code>을 이용하여 시각적으로 조금 더 쉽게 살펴볼 수 있다.</p>
<hr />
<p>다중비교 후, 원하는 집단 간 차이를 살펴보기 위해 cbind를 이용하여 contrast matrix를 만들어 준 후, 다시 한 번 다중비교 분석을 진행하였다.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>alf.comp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;1,7,10-c&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;1,10-7&quot;</span>  <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;1-10&quot;</span>    <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;15-12&quot;</span>   <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;1,7,10,c-12,15&quot;</span><span class="ot">=</span><span class="fu">c</span>( <span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(alf.comp)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(rhiz.alfalfa.mmc<span class="sc">$</span>none<span class="sc">$</span>lmat)[[<span class="dv">2</span>]]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>alf.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.alfalfa.aov, <span class="at">focus=</span><span class="st">&quot;strain&quot;</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">focus.lmat=</span>alf.comp)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>alf.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Npg ~ strain * comb, data = rhiz.alfalfa) 
## Estimated Quantile = 2.967008 
## 95% family-wise confidence level
## $mca
##                 estimate    stderr      lower    upper   height
## a.comp-3DOa15 0.83028658 0.6364341 -1.0580185 2.718592 31.84986
## a.comp-3DOa12 1.44791050 0.6364341 -0.4403946 3.336216 31.54105
## a.comp-3DOa1  2.26191405 0.6364341  0.3736089 4.150219 31.13405
## a.comp-3DOa10 2.26529871 0.6364341  0.3769936 4.153604 31.13235
## 3DOa15-3DOa12 0.61762392 0.6364341 -1.2706812 2.505929 31.12590
## a.comp-3DOa7  2.37176042 0.6364341  0.4834553 4.260066 31.07912
## 3DOa15-3DOa1  1.43162747 0.6364341 -0.4566777 3.319933 30.71890
## 3DOa15-3DOa10 1.43501213 0.6364341 -0.4532930 3.323317 30.71721
## 3DOa15-3DOa7  1.54147383 0.6364341 -0.3468313 3.429779 30.66398
## 3DOa12-3DOa1  0.81400355 0.6364341 -1.0743016 2.702309 30.41009
## 3DOa12-3DOa10 0.81738821 0.6364341 -1.0709169 2.705693 30.40840
## 3DOa12-3DOa7  0.92384991 0.6364341 -0.9644552 2.812155 30.35517
## 3DOa1-3DOa10  0.00338466 0.6364341 -1.8849205 1.891690 30.00140
## 3DOa1-3DOa7   0.10984636 0.6364341 -1.7784588 1.998151 29.94817
## 3DOa10-3DOa7  0.10646170 0.6364341 -1.7818434 1.994767 29.94647
## $none
##        estimate    stderr    lower    upper   height
## a.comp 32.26500 0.4500269 30.92977 33.60024 32.26500
## 3DOa15 31.43472 0.4500269 30.09948 32.76995 31.43472
## 3DOa12 30.81709 0.4500269 29.48186 32.15233 30.81709
## 3DOa1  30.00309 0.4500269 28.66786 31.33832 30.00309
## 3DOa10 29.99970 0.4500269 28.66447 31.33494 29.99970
## 3DOa7  29.89324 0.4500269 28.55801 31.22848 29.89324
## $lmat
##                  estimate    stderr      lower    upper   height
## 15-12          0.61762392 0.6364341 -1.2706812 2.505929 31.12590
## c-1,7,10       2.29965773 0.5196463  0.7578630 3.841452 31.11517
## 12,15-1,7,10,c 0.58564475 0.3897347 -0.5707013 1.741991 30.83308
## 1-10           0.00338466 0.6364341 -1.8849205 1.891690 30.00140
## 1,10-7         0.10815403 0.5511681 -1.5271662 1.743474 29.94732</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>alf.both_style <span class="ot">&lt;-</span> <span class="fu">mmcplot</span>(alf.mmc, <span class="at">h=</span><span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">55</span>), <span class="at">type=</span><span class="st">&quot;lmat&quot;</span>, <span class="at">style=</span><span class="st">&quot;both&quot;</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub=</span><span class="fu">list</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">         The MMC panel shows informative overprinting.  Please see Tiebreaker panel and caption.&quot;</span>, <span class="at">cex=</span>.<span class="dv">75</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>alf.both_style</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-30-1.png" width="960" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>alf.both2_style <span class="ot">&lt;-</span> alf.both_style</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>alf.both2_style<span class="sc">$</span>par.settings<span class="sc">$</span>layout.heights<span class="sc">$</span>panel <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">25</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>alf.both2_style     </span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-30-2.png" width="960" /></p>
<p>분석결과, <strong>c(a.comp) - (3DOa1, 3DOa7, 3DOa10)</strong>의 집단 간 차이만 유의한 것을 확인할 수 있다.</p>
</div>
<div id="clover-analysis" class="section level3">
<h3>12.14.7 Clover Analysis</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## strain       5  642.3  128.45   9.916 1.47e-06 ***
## comb         1    6.9    6.88   0.531  0.46955    
## strain:comb  5  228.2   45.65   3.524  0.00857 ** 
## Residuals   48  621.8   12.95                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>rhiz.clover</strong>데이터에 대한 분산분석 결과, strain이 유의한 것을 확인할 수 있고 <strong>rhiz.alfala</strong> 데이터와 달리 교호작용이 유의한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(rhiz.clover.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##          
## 26.00674 
## 
##  strain 
## strain
##  3DOk1  3DOk5  3DOk4  3DOk7 3DOk13 k.comp 
##  28.72  31.86  22.66  23.95  23.39  25.45 
## 
##  comb 
## comb
##         clover clover+alfalfa 
##         26.345         25.668 
## 
##  strain:comb 
##         comb
## strain   clover clover+alfalfa
##   3DOk1  29.04  28.41         
##   3DOk5  36.29  27.44         
##   3DOk4  21.35  23.98         
##   3DOk7  22.93  24.96         
##   3DOk13 22.49  24.30         
##   k.comp 25.97  24.92         
## 
## Standard errors for differences of means
##         strain   comb strain:comb
##         1.6096 0.9293      2.2763
## replic.     10     30           5</code></pre>
<p>교호작용 효과가 유의하므로 <code>cterms</code>옵션을 사용하지 않고 주효과와 교호작용에 대한 model table을 확인한다.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.clover.aov,<span class="at">focus=</span><span class="st">&quot;strain&quot;</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>rhiz.clover.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = Npg ~ strain * comb, data = rhiz.clover) 
## Estimated Quantile = 2.968095 
## 95% family-wise confidence level
## $mca
##                estimate   stderr        lower     upper   height
## 3DOk5-3DOk1   3.1387117 1.609592 -1.638710690  7.916134 30.29328
## 3DOk5-k.comp  6.4147051 1.609592  1.637282706 11.192128 28.65528
## 3DOk5-3DOk7   7.9142754 1.609592  3.136852957 12.691698 27.90549
## 3DOk5-3DOk13  8.4695956 1.609592  3.692173167 13.247018 27.62783
## 3DOk5-3DOk4   9.1980737 1.609592  4.420651241 13.975496 27.26360
## 3DOk1-k.comp  3.2759934 1.609592 -1.501429028  8.053416 27.08592
## 3DOk1-3DOk7   4.7755636 1.609592 -0.001858777  9.552986 26.33614
## 3DOk1-3DOk13  5.3308839 1.609592  0.553461434 10.108306 26.05848
## 3DOk1-3DOk4   6.0593619 1.609592  1.281939507 10.836784 25.69424
## k.comp-3DOk7  1.4995703 1.609592 -3.277852173  6.276993 24.69814
## k.comp-3DOk13 2.0548905 1.609592 -2.722531962  6.832313 24.42048
## k.comp-3DOk4  2.7833685 1.609592 -1.994053889  7.560791 24.05624
## 3DOk7-3DOk13  0.5553202 1.609592 -4.222102213  5.332743 23.67070
## 3DOk7-3DOk4   1.2837983 1.609592 -3.493624140  6.061221 23.30646
## 3DOk13-3DOk4  0.7284781 1.609592 -4.048944351  5.505900 23.02880
## $none
##        estimate   stderr    lower    upper   height
## 3DOk5  31.86263 1.138154 28.48448 35.24078 31.86263
## 3DOk1  28.72392 1.138154 25.34577 32.10207 28.72392
## k.comp 25.44793 1.138154 22.06978 28.82608 25.44793
## 3DOk7  23.94836 1.138154 20.57021 27.32651 23.94836
## 3DOk13 23.39304 1.138154 20.01489 26.77118 23.39304
## 3DOk4  22.66456 1.138154 19.28641 26.04271 22.66456</code></pre>
<p>집단 간 차이를 확인하기 위해 다중비교를 진행한 결과, 차이가 유의한 집단은 다음과 같다.<br />
<strong>3DOk5-k.comp</strong>, <strong>3DOk5-3DOk7</strong>, <strong>3DOk5-3DOk13</strong>, <strong>3DOk5-3DOk4</strong>, <strong>3DOk1-3DOk13</strong>, <strong>3DOk1-3DOk4</strong></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(rhiz.clover.mmc,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-34-1.png" width="960" /></p>
<p><code>mmcplot</code>을 통해서도 집단 간 유의한 차이가 있는 그룹을 확인할 수 있다.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.clover,<span class="at">par.settings=</span><span class="fu">list</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.symbol=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">box.dot=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">6</span>) </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                 ))</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-35-1.png" width="960" /></p>
<p>교호작용 plot에서 <code>par.settings</code>옵션을 통해 box와 plot의 symbol을 지정해줄 수 있다.</p>
<p>boxplot을 통해 각 범주 데이터의 이상치를 확인할 수 있다.<br />
또한, 교호작용이 유의하므로 교호작용 패널의 선들이 교차점을 가지고 대체로 평행하지 않은 형태를 보이는 것을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(Npg<span class="sc">~</span>strain<span class="sc">*</span>comb,<span class="at">data=</span>rhiz.clover,<span class="at">simple=</span><span class="cn">TRUE</span>,<span class="at">par.settings=</span><span class="fu">list</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.symbol=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">box.dot=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">18</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">6</span>)))</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-36-1.png" width="960" /></p>
<p><code>simple=TRUE</code>라는 옵션을 지정하게 되면 범주에 따라서 pch옵션을 자동으로 다르게 해준다. 따라서, 범주간 데이터를 구별하는데 더 유용하다.</p>
<hr />
<p>아래의 anova formula는 <strong>strain</strong>변수가 <strong>comb</strong>변수에 nested 된 formula 이다.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.nest.aov <span class="ot">&lt;-</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(Npg<span class="sc">~</span>comb<span class="sc">/</span>strain,<span class="at">data=</span>rhiz.clover)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.nest.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## comb         1    6.9    6.88   0.531   0.47    
## comb:strain 10  870.5   87.05   6.720  2e-06 ***
## Residuals   48  621.8   12.95                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>nested를 진행한 분산분석의 결과, 주효과 comb는 유의하지 않고, 교호작용의 효과만 유의한 것을 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>old.width <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">width=</span><span class="dv">35</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">coef</span>(rhiz.clover.nest.aov))</span></code></pre></div>
<pre><code>##  [1] &quot;(Intercept)&quot;                    
##  [2] &quot;combclover+alfalfa&quot;             
##  [3] &quot;combclover:strain3DOk5&quot;         
##  [4] &quot;combclover+alfalfa:strain3DOk5&quot; 
##  [5] &quot;combclover:strain3DOk4&quot;         
##  [6] &quot;combclover+alfalfa:strain3DOk4&quot; 
##  [7] &quot;combclover:strain3DOk7&quot;         
##  [8] &quot;combclover+alfalfa:strain3DOk7&quot; 
##  [9] &quot;combclover:strain3DOk13&quot;        
## [10] &quot;combclover+alfalfa:strain3DOk13&quot;
## [11] &quot;combclover:straink.comp&quot;        
## [12] &quot;combclover+alfalfa:straink.comp&quot;</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(old.width)</span></code></pre></div>
<p>nested된 anova 결과의 계수를 살펴보면 위와 같다.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.nest.aov,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">split=</span><span class="fu">list</span>(<span class="st">&quot;comb:strain&quot;</span><span class="ot">=</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(<span class="at">clover=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;clover+alf&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>))))</span></code></pre></div>
<pre><code>##                           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## comb                       1    6.9    6.88   0.531    0.470    
## comb:strain               10  870.5   87.05   6.720 2.00e-06 ***
##   comb:strain: clover      5  788.4  157.68  12.172 1.22e-07 ***
##   comb:strain: clover+alf  5   82.1   16.42   1.268    0.293    
## Residuals                 48  621.8   12.95                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>split을 통해 범주를 나눈 후, 그 범주에 따른 교호작용 또한 살펴볼 수 있다.</p>
<hr />
<p>rhiz.clover의 독립변수 간 교호작용이 유의했으므로 inetr 변수에 두 변수의 교호작용을 넣어 준후 분석을 진행해본다.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover<span class="sc">$</span>inter <span class="ot">&lt;-</span> <span class="fu">with</span>(rhiz.clover, <span class="fu">interaction</span>(comb, strain))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(rhiz.clover<span class="sc">$</span>inter)</span></code></pre></div>
<pre><code>##  [1] &quot;clover.3DOk1&quot;          &quot;clover+alfalfa.3DOk1&quot;  &quot;clover.3DOk5&quot;         
##  [4] &quot;clover+alfalfa.3DOk5&quot;  &quot;clover.3DOk4&quot;          &quot;clover+alfalfa.3DOk4&quot; 
##  [7] &quot;clover.3DOk7&quot;          &quot;clover+alfalfa.3DOk7&quot;  &quot;clover.3DOk13&quot;        
## [10] &quot;clover+alfalfa.3DOk13&quot; &quot;clover.k.comp&quot;         &quot;clover+alfalfa.k.comp&quot;</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rhiz.clover.inter.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg <span class="sc">~</span> inter, <span class="at">data=</span>rhiz.clover)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz.clover.inter.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## inter       11  877.4   79.76   6.157 3.46e-06 ***
## Residuals   48  621.8   12.95                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>cs12.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(rhiz.clover.inter.aov, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">inter=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(cs12.mmc,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">&quot;clover and clover+alfalfa comparisons&quot;</span>,<span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-41-1.png" width="960" /></p>
<p>교호작용에 대한 다중 비교 plot을 그리면 위와 같다.<br />
유의한 집단간 차이가 보이지만, 너무 많은 집단간 차이가 출력되어 한 눈에 알아 볼 수 없다.</p>
<p>교호작용 분석을 진행할 때에는 적절한 제약조건이 필요하다는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at the contrasts, their generated dummy variables  </span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="do">## and their regression coefficients</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Abbreviate their names for presentation,</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">abbreviate</span>(<span class="fu">names</span>(<span class="fu">coef</span>(rhiz.clover.nest.aov)))</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre><code>##                     (Intercept)              combclover+alfalfa 
##                          &quot;(In)&quot;                          &quot;cmb+&quot; 
##          combclover:strain3DOk5  combclover+alfalfa:strain3DOk5 
##                        &quot;c:3DO5&quot;                       &quot;c+:3DO5&quot; 
##          combclover:strain3DOk4  combclover+alfalfa:strain3DOk4 
##                        &quot;c:3DO4&quot;                       &quot;c+:3DO4&quot; 
##          combclover:strain3DOk7  combclover+alfalfa:strain3DOk7 
##                        &quot;c:3DO7&quot;                       &quot;c+:3DO7&quot; 
##         combclover:strain3DOk13 combclover+alfalfa:strain3DOk13 
##                        &quot;c:3DO1&quot;                       &quot;c+:3DO1&quot; 
##         combclover:straink.comp combclover+alfalfa:straink.comp 
##                          &quot;cm:.&quot;                          &quot;c+:.&quot;</code></pre>
<p>contrasts를 통해 R 프로그램 내에서 더미변수가 어떻게 지정됐는지 확인할 수 있다.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(rhiz.clover<span class="sc">$</span>comb)</span></code></pre></div>
<pre><code>##                clover+alfalfa
## clover                      0
## clover+alfalfa              1</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(rhiz.clover<span class="sc">$</span>strain)</span></code></pre></div>
<pre><code>##        3DOk5 3DOk4 3DOk7 3DOk13 k.comp
## 3DOk1      0     0     0      0      0
## 3DOk5      1     0     0      0      0
## 3DOk4      0     1     0      0      0
## 3DOk7      0     0     1      0      0
## 3DOk13     0     0     0      1      0
## k.comp     0     0     0      0      1</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>cnx <span class="ot">&lt;-</span> <span class="fu">aov</span>(Npg<span class="sc">~</span> comb<span class="sc">/</span>strain, <span class="at">data=</span>rhiz.clover,<span class="at">x=</span><span class="cn">TRUE</span>)<span class="sc">$</span>x</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(cnx)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> tmp</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="do">## cnx</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>cnx[<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">60</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>)]</span></code></pre></div>
<pre><code>##    (In) cmb+ c:3DO5 c:3DO4 c:3DO7 c:3DO1 cm:.
## 1     1    0      0      0      0      0    0
## 6     1    0      1      0      0      0    0
## 11    1    0      0      1      0      0    0
## 16    1    0      0      0      1      0    0
## 21    1    0      0      0      0      1    0
## 26    1    0      0      0      0      0    1
## 31    1    1      0      0      0      0    0
## 36    1    1      0      0      0      0    0
## 41    1    1      0      0      0      0    0
## 46    1    1      0      0      0      0    0
## 51    1    1      0      0      0      0    0
## 56    1    1      0      0      0      0    0</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>cnx[<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">60</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>)]</span></code></pre></div>
<pre><code>##    c+:3DO5 c+:3DO4 c+:3DO7 c+:3DO1 c+:.
## 1        0       0       0       0    0
## 6        0       0       0       0    0
## 11       0       0       0       0    0
## 16       0       0       0       0    0
## 21       0       0       0       0    0
## 26       0       0       0       0    0
## 31       0       0       0       0    0
## 36       1       0       0       0    0
## 41       0       1       0       0    0
## 46       0       0       1       0    0
## 51       0       0       0       1    0
## 56       0       0       0       0    1</code></pre>
<p>앞서 분산분석의 결과로 얻어진 회귀계수를 더미변수로에 함께 배치되도록 지정해주었다.<br />
cnx를 통해 살펴본 결과, 우리가 지정한 회귀계수가 더미변수 안에 적절하게 들어간 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>cnxb <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">coef</span>(<span class="fu">summary.lm</span>(rhiz.clover.aov)),<span class="dv">3</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(cnxb)[[<span class="dv">1</span>]]<span class="ot">&lt;-</span>tmp</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>cnxb[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>),]</span></code></pre></div>
<pre><code>##         Estimate Std. Error t value Pr(&gt;|t|)
## (In)      29.042      1.610  18.043    0.000
## cmb+       7.243      2.276   3.182    0.003
## c:3DO5    -7.688      2.276  -3.378    0.001
## c:3DO4    -6.556      2.276  -2.880    0.006
## c+:3DO4   -3.070      2.276  -1.349    0.184
## c:3DO7    -0.637      2.276  -0.280    0.781
## cm:.       2.451      3.219   0.761    0.450
## c+:3DO5   -6.110      2.276  -2.684    0.010
## c+:3DO4   -3.070      2.276  -1.349    0.184
## c+:3DO7   -8.210      3.219  -2.550    0.014
## c+:3DO1    2.668      3.219   0.829    0.411
## c+:.      -0.413      3.219  -0.128    0.899</code></pre>
<p>clover 데이터의 실험에서 더미변수와 회귀계수를 함께 배치한 뒤 분석한 선형회귀분석 결과는 위와 같이 나온다.</p>
</div>
</div>
<div id="example-animal-feed-data" class="section level2">
<h2>12.16 Example-Animal Feed Data</h2>
<div id="analysis-1" class="section level3">
<h3>12.16.2 Analysis</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(feed)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>feed.int.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(retained<span class="sc">~</span>temp<span class="sc">*</span>supp,<span class="at">data=</span>feed)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(feed.int.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: retained
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## temp       2 1479.2  739.60 26.0423 1.321e-05 ***
## supp       4 3862.1  965.53 33.9977 2.334e-07 ***
## temp:supp  8  243.5   30.43  1.0716    0.4313    
## Residuals 15  426.0   28.40                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>feed 데이터의 분산 분석 결과, <strong>temp, supp</strong> 독립변수는 유의확률이 유의수준 0.05보다 작으므로 적어도 집단 간 차이가 한 집단 이상에서 유의한 차이가 있다는 것을 알 수 있다.<br />
교호작용의 유의확률은 유의수준 0.05보다 크므로 유의하지 않은 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>feed.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(retained <span class="sc">~</span> temp <span class="sc">+</span> supp,<span class="at">data=</span>feed)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(feed.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: retained
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## temp       2 1479.2  739.60  25.410 1.499e-06 ***
## supp       4 3862.1  965.53  33.172 3.037e-09 ***
## Residuals 23  669.5   29.11                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(feed.aov,<span class="at">split=</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">temp=</span><span class="fu">list</span>(<span class="at">linear=</span><span class="dv">1</span>,<span class="at">quadratic=</span><span class="dv">2</span>),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">supp=</span><span class="fu">list</span>(<span class="at">linear=</span><span class="dv">1</span>,<span class="at">quadratic=</span><span class="dv">2</span>,<span class="at">rest=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)))</span></code></pre></div>
<pre><code>##                   Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## temp               2   1479   739.6  25.409 1.50e-06 ***
##   temp: linear     1    370   369.8  12.705  0.00165 ** 
##   temp: quadratic  1   1109  1109.4  38.114 2.68e-06 ***
## supp               4   3862   965.5  33.172 3.04e-09 ***
##   supp: linear     1   2912  2912.1 100.046 7.61e-10 ***
##   supp: quadratic  1    947   946.7  32.525 8.30e-06 ***
##   supp: rest       2      3     1.7   0.058  0.94418    
## Residuals         23    669    29.1                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>feed 데이터의 contrasts를 고차 방정식을 적용하여 anova 분석을 다시 한 번 진행해보았다.<br />
1차, 2차는 모두 유의하게 나온 것을 알 수 있었지만 rest(나머지) 방정식에서는 더 이상 유의하지 않은 것을 알 수 있다.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(feed.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##      
## 68.8 
## 
##  temp 
## temp
##   40   80  120 
## 60.2 77.4 68.8 
## 
##  supp 
## supp
##     2     4     6     8    10 
## 48.33 64.67 76.00 79.00 76.00 
## 
## Standard errors for differences of means
##          temp  supp
##         2.413 3.115
## replic.    10     6</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction2wt</span>(retained <span class="sc">~</span> supp <span class="sc">*</span> temp, <span class="at">data=</span>feed)</span></code></pre></div>
<p><img src="Chap12_files/figure-html/unnamed-chunk-49-1.png" width="960" /></p>
<p>교호작용의 패널은 거의 평행한 모양에 가깝기 때문에 앞서 살펴본 것 처럼, 교호작용이 유의하지 않은 것을 다시 한 번 확인할 수 있다.</p>
</div>
</div>
</div>
<div id="appendix-r-markdown-theme" class="section level1">
<h1>Appendix: R Markdown Theme</h1>
<div id="change-of-theme" class="section level2">
<h2>Change of Theme</h2>
<p>R markdown은 다양한 theme를 가지고 있다.<br />
theme는 다음과 같이 설정할 수 있다.</p>
<p>Ouput:<br />
html_document:<br />
theme: <strong>theme</strong>이름</p>
<p>사용할 수 있는 Theme의 종류는 아래의 링크에서 볼 수 있다.<br />
<a href="https://rfriend.tistory.com/311" class="uri">https://rfriend.tistory.com/311</a></p>
</div>
<div id="change-of-background" class="section level2">
<h2>Change of Background</h2>
<p>theme가 아닌 Markdown의 background를 변경을 원할수도 있다.<br />
Markdown의 경우 HTML을 기반으로 하기때문에 이러한 스타일의 변경은 css를 수정해주어야한다.</p>
<p>html에서 내용을 가지고 있는 부분은 <strong>body</strong>이다.<br />
이러한 <strong>body</strong>의 배경색을 변경해주면 markdown의 배경색을 변경할 수 있다.<br />
변경방법의 코드는 아래와 같다.</p>
<p><code>&lt;body style="background-color:grey;"&gt;</code></p>
<p>기본 색깔이 아닌 Color Hex를 지정하여 배경색을 지정해줄 수도 있다.<br />
<code>&lt;body style="background-color:#FFFFE6;"&gt;</code></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<p><a href="https://rfriend.tistory.com/136">이원분산분석의 정의</a><br />
<a href="http://contents2.kocw.or.kr/KOCW/document/2016/chungang/parkjunseong2/9.pdf">이원분산분석의 특징</a><br />
<a href="https://stackoverflow.com/questions/37497948/aov-error-term-in-r-whats-the-difference-bw-errorid-and-errorid-timevar/42664178">Nested of Two-Anova</a><br />
<a href="https://rfriend.tistory.com/311">R markdown theme</a> <a href="https://stackoverflow.com/questions/65541245/how-do-i-change-the-entire-background-color-in-an-rmarkdown-html-document">R background color</a></p>
<hr />
</div>
<div id="summary-of-chapter12" class="section level1">
<h1>Summary of Chapter12</h1>
<ul>
<li><p>우리는 Chapter6에서 설명변수의 집단에 따른 평균적인 차이가 존재하는지에 대해 분석하는 <strong>One-Way-ANOVA</strong>방법에 대해서 살펴보았다. 회귀에서도 단순선형회귀, 다중선형회귀가 있는 것 처럼, 분산분석 또한 설명변수가 2개 이상인 경우에 사용하는 분석방법이 있다.</p></li>
<li><p>(집단을 3개 이상 가지는)설명변수가 2개 이상인 경우에는 일원분산 분석이 아닌 <strong>이원분산분석(Two-way ANOVA)</strong>를 이용하여 집단간 평균의 차이가 존재하는지에 대해서 검정을 진행해야 한다.</p></li>
<li><p>이원분산분석을 통해 집단간 평균의 차이를 살펴보고자 할 때, 사용하는 2개 이상의 설명변수들을 <strong>주효과</strong>라고 하며, 이러한 주효과들이 서로 영향을 받으면서 나타는 효과를 <strong>교호작용</strong>이라고 한다. 일원분산분석과 달리 이원분산분석은 교호작용을 반드시 분석을 진행할 때 고려해 주어야한다.</p></li>
<li><p>이원분산분석 역시 일원분산분석과 같이 <strong>정규성</strong>, <strong>독립성</strong>, <strong>등분산성</strong> 3가지의 기본 가정을 가지고 분석을 진행한다.</p></li>
<li><p>R에서는 <code>aov</code>함수를 이용하여 분산분석을 진행할 수 있다고 했는데, 이원분산분석 또한 <code>aov</code>함수를 이용하여 진행할 수 있다. <code>(반응변수 ~ 설명변수 * 설명변수,data)</code>의 형태로 Formula를 지정하게 되면 <strong>이원분산분석</strong>과 더불어 주효과 간 교호작용의 유의성 까지 확인할 수 있다.</p></li>
<li><p><code>aov</code>에 사용되는 formula를 <code>interactionw2t</code>함수에 지정하게 되면 각 주효과에 따른 반응변수의 <em>boxplot</em>과 교호작용 plot까지 확인할 수 있기 때문에 데이터 탐색에 꽤나 유용하게 사용할 수 있다.</p></li>
</ul>
<hr />
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
